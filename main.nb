(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    264231,       6028]
NotebookOptionsPosition[    260698,       5969]
NotebookOutlinePosition[    261040,       5984]
CellTagsIndexPosition[    260997,       5981]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"\:041f\:043e\:043b\:0438\:044d\:0434\:0440", " ", "-", " ", 
    RowBox[{"\:043d\:0430\:0431\:043e\:0440", " ", 
     RowBox[{"{", 
      RowBox[{"V", ",", "G"}], "}"}], " ", "\:0434\:0432\:0443\:0445", " ", 
     "\:0434\:0432\:0443\:043c\:0435\:0440\:043d\:044b\:0445", " ", 
     "\:043c\:0430\:0441\:0438\:0432\:043e\:0432"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "\:0433\:0434\:0435", " ", 
     "\:044d\:043b\:0435\:043c\:0435\:043d\:0442\:044b", " ", "V"}], " ", "-",
     " ", 
    RowBox[{
    "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b", " ", 
     "\:0432\:0435\:0440\:0448\:0438\:043d"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\:0430", " ", "G"}], " ", "-", " ", 
     RowBox[{
     "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
      "\:043d\:043e\:043c\:0435\:0440\:043e\:0432", " ", 
      "\:0442\:043e\:0447\:0435\:043a", " ", "\[IndentingNewLine]", "  ", 
      "\:043e\:0431\:0440\:0430\:0437\:0443\:044e\:0449\:0438\:0445", " ", 
      "\:043a\:0430\:0436\:0434\:0443\:044e", " ", "\:0438\:0437", " ", 
      RowBox[{
      "\:0433\:0440\:0430\:043d\:0435\:0439", ".", " ", 
       "\:041f\:043e\:0440\:044f\:0434\:043e\:043a"}], " ", 
      "\:043e\:0431\:0445\:043e\:0434\:0430", " ", 
      "\:043a\:043e\:0440\:0440\:0435\:043a\:0442\:0438\:0440\:0443\:0435\
\:0442\:0441\:044f", " ", 
      "\:0441\:043b\:0435\:0434\:0443\:044e\:0449\:0435\:0439", " ", 
      RowBox[{"\:0444\:0443\:043d\:043a\:0446\:0438\:0435\:0439", ":"}]}]}], 
    ";", " ", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
    RowBox[{"ConvPolyhedronFixOrientation", " ", "-", " ", 
     RowBox[{
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044f", " ", 
      "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\:0432\:0430\
\:043d\:0438\:044f", " ", "G", " ", "\:0442\:0430\:043a"}]}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "\:0447\:0442\:043e\:0431\:044b", " ", 
     "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:043d\:0430\:044f", 
     " ", "\:043f\:043e", " ", "\:043f\:0435\:0440\:0432\:044b\:043c", " ", 
     "\:0442\:0440\:0435\:043c", " ", "\:0442\:043e\:0447\:043a\:0430\:043c", 
     " ", "\:044d\:0442\:043e\:0439", " ", "\:0433\:0440\:0430\:043d\:0438", 
     " ", "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c", 
     "\[IndentingNewLine]", "\t", "\:0438\:043c\:0435\:043b\:0430", " ", 
     "\:0432\:043d\:0435\:0448\:043d\:044e\:044e", " ", 
     RowBox[{
     "\:043d\:043e\:0440\:043c\:0430\:043b\:044c", ".", " ", 
      "\:0422\:0430\:043a\:0436\:0435"}], " ", 
     "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0430\:0435\:0442", " ", 
     "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
     "\:0435\:0434\:0438\:043d\:0438\:0447\:043d\:044b\:0445", " ", 
     "\:043d\:043e\:0440\:043c\:0430\:043b\:0435\:0439"}], ";", 
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
    RowBox[{"ConvPolyhedron", " ", "-", " ", 
     RowBox[{
     "\:043a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440", 
      " ", "\:043e\:0431\:044a\:0435\:043a\:0442\:0430", " ", 
      RowBox[{
      "\"\<\:0432\:044b\:043f\:0443\:043a\:043b\:044b\:0439 \
\:043f\:043e\:043b\:0438\:044d\:0434\:0440\>\"", "."}]}]}], ";", 
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
    RowBox[{"PolyhedronShow", " ", "-", " ", 
     RowBox[{
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044f", " ", "\:0434\:043b\:044f", 
      " ", "\:0443\:0434\:043e\:0431\:0441\:0442\:0432\:0430", " ", 
      "\:043e\:0442\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\:044f", 
      " ", "\:043e\:0431\:044a\:0435\:043a\:0442\:0430", " ", 
      "ConvPolyhedron", " ", 
      "\:043f\:043e\:0441\:0440\:0435\:0434\:0441\:0442\:0432\:043e\:043c", 
      " ", "\:0432\:0441\:0442\:0440\:043e\:0435\:043d\:043d\:043e\:0439", 
      " ", "\:0444\:0443\:043d\:043a\:0446\:0438\:0438", " ", 
      RowBox[{"Graphics3D", "."}]}]}], ";", "\[IndentingNewLine]", "\t", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"RayCasting3DConvPolyhedron", " ", "-", " ", 
     RowBox[{
     "\:043f\:043e\:0438\:0441\:043a", " ", "\:0442\:043e\:0447\:0435\:043a", 
      " ", "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\:044f\
", " ", "\:043b\:0443\:0447\:0430", " ", "\:0438", " ", 
      "\:0432\:044b\:043f\:0443\:043a\:043b\:043e\:0433\:043e", " ", 
      RowBox[{"\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", "."}]}]}], 
    ";", " ", "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
    RowBox[{"ProjectileSphereCollide3DConvPolyhedron", " ", "-", " ", 
     RowBox[{
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044f", " ", 
      "\:043f\:0440\:0438\:043d\:0438\:043c\:0430\:044e\:0449\:0430\:044f", 
      " ", "\:043f\:0440\:0435\:0434\:044b\:0434\:0443\:0449\:0435\:0435", 
      " ", "\:0438", " ", "\:0442\:0435\:043a\:0443\:0449\:0435\:0435", " ", 
      "\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435", " ", 
      "\:0434\:0432\:0438\:0436\:0443\:0449\:0435\:0439\:0441\:044f", " ", 
      "\:0441\:0444\:0435\:0440\:044b", " ", "\[IndentingNewLine]", "   ", 
      "\:0432\:043c\:0435\:0441\:0442\:0435", " ", "\:0441", " ", 
      RowBox[{
      "\:0432\:044b\:043f", ".", " ", 
       "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:043e\:043c"}], " ", 
      "\:0438", " ", 
      "\:0432\:043e\:0437\:0432\:0440\:0430\:0449\:0430\:044e\:0449\:0430\
\:044f", " ", "\:0442\:0435\:043a\:0443\:0449\:0435\:0435", " ", 
      "\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435"}]}]}], ",", 
   " ", 
   RowBox[{
   "\:0435\:0441\:043b\:0438", " ", 
    "\:0441\:0442\:043e\:043b\:043a\:043d\:043e\:0432\:0435\:043d\:0438\:044f\
", " ", "\:0441", " ", "\:044d\:0442\:0438\:043c", " ", 
    "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:043e\:043c", " ", 
    "\:043c\:0435\:0436\:0434\:0443", " ", 
    "\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:044f\:043c\:0438", " ",
     "\:043d\:0435", " ", "\:0431\:044b\:043b\:043e"}], ",", " ", 
   "\[IndentingNewLine]", "     ", 
   RowBox[{
    RowBox[{
    "\:0438\:043d\:0430\:0447\:0435", " ", 
     "\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435", " ", 
     "\:0441\:0444\:0435\:0440\:044b", " ", "\:0432", " ", 
     "\:043c\:043e\:043c\:0435\:043d\:0442", " ", 
     "\:0441\:0442\:043e\:043b\:043a\:043d\:043e\:0432\:0435\:043d\:0438\:044f\
", " ", "\:0441", " ", 
     RowBox[{
     "\:0432\:044b\:043f", ".", " ", 
      "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:043e\:043c", "."}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
    RowBox[{
    "ProjectileSphereCollisionQ3DBoundingSphere", " ", "-", " ", 
     "\:0442\:0435\:0441\:0442"}]}], ",", " ", 
   "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:044f\:044e\:0449\:0438\:0439",
    ",", " ", 
   RowBox[{
    RowBox[{
    "\:0431\:044b\:043b\:043e", " ", "\:043b\:0438", " ", 
     "\:0441\:0442\:043e\:043b\:043a\:043d\:043e\:0432\:0435\:043d\:0438\:0435\
", " ", "\:0434\:0432\:0438\:0436\:0443\:0449\:0435\:0439\:0441\:044f", " ", 
     "\:0441\:0444\:0435\:0440\:044b", " ", "\:0441", " ", 
     "\:043e\:0431\:044a\:0435\:043c\:043b\:044e\:0449\:0435\:0439", " ", 
     "\:0441\:0444\:0435\:0440\:043e\:0439", " ", "\[IndentingNewLine]", "\t", 
     RowBox[{
     "\:0432\:044b\:043f", ".", " ", 
      "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430"}], " ", 
     "\:043c\:0435\:0436\:0434\:0443", " ", 
     "\:043a\:0440\:0430\:0439\:043d\:0438\:043c\:0438", " ", 
     "\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:044f\:043c\:0438", 
     " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "\:044d\:0442\:043e\:0442", " ", "\:0442\:0435\:0441\:0442", " ", 
         "\:0441\:043b\:0435\:0434\:0443\:0435\:0442", " ", 
         "\:0438\:0441\:043f\:043e\:043b\:044c\:0437\:043e\:0432\:0430\:0442\
\:044c", " ", "\:043f\:0440\:0435\:0436\:0434\:0435"}], ",", " ", 
        RowBox[{
        "\:0447\:0435\:043c", " ", 
         "\:0444\:0443\:043d\:043a\:0446\:0438\:044e", " ", 
         "\:0432\:044b\:0448\:0435", " ", "\:0432", " ", 
         "\:0446\:0435\:043b\:044f\:0445", " ", 
         "\:043e\:043f\:0442\:0438\:043c\:0438\:0437\:0430\:0446\:0438\:0438"}\
]}], ")"}], "."}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"--", " ", 
     RowBox[{"GJK", " ", "--"}]}], ";", "\[IndentingNewLine]", "\t\t", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
    "NextVertexAndMinSubsimplex", " ", "-", " ", 
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044f", "-", 
     RowBox[{
     "\:0430\:043d\:0430\:043b\:043e\:0433", " ", 
      "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:0430", " ", 
      "\:0414\:0436\:043e\:043d\:0441\:043e\:043d\:0430", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Johnson", "'"}], "s", " ", "distance", " ", 
        RowBox[{"alg", "."}]}], ")"}], " ", "\:0434\:043b\:044f", " ", 
      "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f", 
      " ", "\:0442\:043e\:0447\:043a\:0438", " ", 
      "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441\:0430"}]}]}], ",", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
   "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0435\:0439", " ", "\:043a", 
    " ", "\:043d\:0430\:0447\:0430\:043b\:0443", " ", 
    "\:043e\:0442\:0441\:0447\:0435\:0442\:0430"}], ",", " ", 
   RowBox[{
   "\:0430", " ", "\:0442\:0430\:043a\:0436\:0435", " ", 
    "\:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0433\:043e\
", " ", "\:043f\:043e\:0434\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441\
\:0430"}], ",", " ", 
   RowBox[{
    RowBox[{
    "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0449\:0435\:0433\:043e", " ",
      "\:044d\:0442\:0443", " ", 
     RowBox[{"\:0442\:043e\:0447\:043a\:0443", ".", " ", "\:042f"}], " ", 
     "\:043d\:0435", " ", "\:0441\:043c\:043e\:0433", " ", 
     "\:0440\:0430\:0437\:043e\:0431\:0440\:0430\:0442\:044c\:0441\:044f", 
     " ", "\:0432", " ", 
     "\:043f\:0440\:0435\:0434\:043b\:043e\:0436\:0435\:043d\:043d\:043e\:043c\
", " ", "\[IndentingNewLine]", "   ", 
     "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:0435", " ", "\:0438", 
     " ", "\:043f\:043e\:044d\:0442\:043e\:043c\:0443", " ", 
     "\:043f\:0440\:0438\:0432\:0435\:043b", " ", "\:0441\:0432\:043e\:044e", 
     " ", 
     RowBox[{
     "\:0440\:0435\:0430\:043b\:0438\:0437\:0430\:0446\:0438\:044e", ".", 
      "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", " ", 
      "SupportVector"}]}], " ", "-", " ", 
    RowBox[{
    "\:0432\:0441\:043f\:043e\:043c\:043e\:0433\:0430\:0442\:0435\:043b\:044c\
\:043d\:0430\:044f", " ", "\:0444\:0443\:043d\:043a\:0446\:0438\:044f"}]}], 
   ",", " ", 
   RowBox[{
    RowBox[{
    "\:043f\:043e\:0437\:0432\:043e\:043b\:044f\:044e\:0449\:0430\:044f", " ",
      "\:0432\:0435\:043a\:0442\:043e\:0440\:0443", " ", "v", " ", 
     "\:043f\:043e\:0441\:0442\:0430\:0432\:0438\:0442\:044c", " ", "\:0432", 
     " ", "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\:0432\:0438\
\:0435", " ", "\:0432\:0435\:043a\:0442\:043e\:0440", " ", "\:0438\:0437", 
     " ", "\:0441\:0443\:043c\:043c\:044b", " ", 
     "\:041c\:0438\:043d\:043a\:043e\:0432\:0441\:043a\:043e\:0433\:043e", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"A", " ", "-", " ", "B"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"A", " ", "+", " ", 
          RowBox[{"(", 
           RowBox[{"-", "B"}], ")"}]}], "  ", "|", " ", "A"}]}], ",", 
       RowBox[{"B", " ", "-", " ", 
        RowBox[{
         RowBox[{
         "\:043a\:043e\:043e\:0440\:0434", ".", " ", 
          "\:0432\:0435\:0440\:0448\:0438\:043d"}], " ", 
         "\:0440\:0430\:0441\:0441\:043c"}], "-", 
        RowBox[{
        "\:044b\:0445", " ", 
         "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:043e\:0432"}]}]}], 
      "}"}], " ", "\:0438\:043c\:0435\:044e\:0449\:0438\:0439", " ", 
     "\:043d\:0430\:0438\:0431\:043e\:043b\:044c\:0448\:0435\:0435", " ", 
     "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:0435", " ", 
     "\:0441\:043a\:0430\:043b\:044f\:0440\:043d\:043e\:0433\:043e", " ", 
     "\:043f\:0440\:043e\:0438\:0437\:0432\:0435\:0434\:0435\:043d\:0438\:044f\
", " ", "\:0441", " ", 
     RowBox[{"v", "."}]}], ";", " ", "\[IndentingNewLine]", "\t", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
    "StaticCollisionQ3DConvPolyhedronConvPolyhedron", " ", "-", " ", 
     "\:0442\:0435\:0441\:0442"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:044e\:0442\:0441\:044f\
", " ", "\:043b\:0438", " ", 
     "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\:0432\:0430\:0435\
\:043c\:044b\:0435", " ", "\:0434\:0432\:0430", " ", 
     RowBox[{
     "\:0432\:044b\:043f", ".", " ", 
      "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430"}], " ", "\:0432", 
     " ", "\:0434\:0430\:043d\:043d\:044b\:0439", " ", "\[IndentingNewLine]", 
     "\t", "\:043c\:043e\:043c\:0435\:043d\:0442", " ", 
     "\:0432\:0440\:0435\:043c\:0435\:043d\:0438"}], ";", 
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
    RowBox[{"StaticNDistance3DConvPolyhedronConvPolyhedron", " ", "-", " ", 
     RowBox[{
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044f", " ", "\:0434\:043b\:044f", 
      " ", "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f\
", " ", "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f", " ", 
      "\:043c\:0435\:0436\:0434\:0443", " ", 
      "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0438\:043c\:0438", " ", 
      "\:0442\:043e\:0447\:043a\:0430\:043c\:0438", " ", 
      "\:0434\:0432\:0443\:0445", " ", 
      "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:043e\:0432", 
      "\[IndentingNewLine]", "\t ", "\:0441", " ", 
      "\:0437\:0430\:0434\:0430\:043d\:043d\:043e\:0439", " ", 
      "\:0442\:043e\:0447\:043d\:043e\:0441\:0442\:044c\:044e", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "rel"], "."}]}]}], ";"}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8315455348996944`*^9, 3.8315458368190575`*^9}, 
   3.831545947620409*^9, {3.8315459901470203`*^9, 3.8315459996763544`*^9}, {
   3.8315492074447308`*^9, 3.8315492230213966`*^9}, {3.8315492570749283`*^9, 
   3.831549378646289*^9}, {3.8315494594760237`*^9, 3.831549461694794*^9}, {
   3.8315495002115884`*^9, 3.8315497713714285`*^9}, 3.8315498403794518`*^9, {
   3.8315498799342785`*^9, 3.831550025695979*^9}, {3.8315500826712503`*^9, 
   3.8315502925233126`*^9}, {3.831550333683533*^9, 3.831550341014802*^9}, {
   3.831550397440362*^9, 3.8315504411167*^9}, {3.831550492223942*^9, 
   3.831550668446353*^9}, {3.8315507149904947`*^9, 3.8315510669747105`*^9}, {
   3.831551097884098*^9, 3.8315511516365414`*^9}, {3.83155118434298*^9, 
   3.831551309732761*^9}, {3.8315516603306932`*^9, 
   3.831551701272045*^9}},ExpressionUUID->"a8d8d513-9518-4602-8a27-\
e2d3405f4d70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"31", ",", "10", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "15", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", 
       RowBox[{"-", "5"}], ",", 
       RowBox[{"-", "6"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14.2", ",", "4", ",", 
       RowBox[{"-", "11.4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "15", ",", 
       RowBox[{"-", "15"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G1", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "6", ",", "5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "6", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6", ",", "3", ",", "2"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8307443727696514`*^9, 3.830744419154791*^9}, {
   3.8307444779788136`*^9, 3.830744483586599*^9}, {3.830744738838234*^9, 
   3.830744748273429*^9}, {3.830744887695751*^9, 3.830744890769718*^9}, {
   3.8307450901488667`*^9, 3.830745093060929*^9}, {3.8307452907032814`*^9, 
   3.8307453255544653`*^9}, {3.830745550641343*^9, 3.830745576815703*^9}, {
   3.8307456609176826`*^9, 3.830745663960223*^9}, {3.8307457032740517`*^9, 
   3.8307457074457655`*^9}, {3.8307461227584066`*^9, 3.830746136707782*^9}, 
   3.830748263359968*^9, {3.830916011304826*^9, 3.830916012162856*^9}, {
   3.8313999295090976`*^9, 3.831399977849408*^9}, {3.831400011070118*^9, 
   3.8314000668073587`*^9}, {3.831400241844301*^9, 3.8314002477298346`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"75d02300-3964-4cde-82f6-de245fc00b9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"V2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4.5"}], ",", "6.4", ",", "9.94"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "8.7"}], ",", 
       RowBox[{"-", "7.7"}], ",", "9.87"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7.08", ",", 
       RowBox[{"-", "13.494"}], ",", "8.917"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9.9", ",", 
       RowBox[{"-", "7.12"}], ",", "8.9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.8", ",", "6.69", ",", "9.455"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "5.75", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13.5", ",", 
       RowBox[{"-", "6.75"}], ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14.04", ",", "0.898", ",", "1.24"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8.394", ",", 
       RowBox[{"-", "15.1842"}], ",", "5.3821"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.70672"}], ",", 
       RowBox[{"-", "13.668704"}], ",", 
       RowBox[{"-", "1.273248"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "13.5"}], ",", 
       RowBox[{"-", "3.0"}], ",", 
       RowBox[{"-", "1.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "7.5"}], ",", 
       RowBox[{"-", "10.75"}], ",", 
       RowBox[{"-", "1.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.25"}], ",", "13.0", ",", 
       RowBox[{"-", "1.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.84", ",", "10.892", ",", 
       RowBox[{"-", "4.0185"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9.75", ",", 
       RowBox[{"-", "9.75"}], ",", 
       RowBox[{"-", "4.25"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "4.25"}], ",", "2.5", ",", 
       RowBox[{"-", "11.75"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10.023", ",", 
       RowBox[{"-", "0.8724"}], ",", 
       RowBox[{"-", "7.087"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "7", ",", "8", ",", "6", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "9", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "9", ",", "10", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "11", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10", ",", "12", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "12", ",", "11", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "13", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "11", ",", "13", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6", ",", "14", ",", "13", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "8", ",", "14", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "15", ",", "7", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "15", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "16", ",", "11", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "7", ",", "15", ",", "17", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "13", ",", "16", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "14", ",", "17", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "14", ",", "16", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "17", ",", "15", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "11", ",", "12", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "10", ",", "12", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "10", ",", "15", ",", "16"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8309140915984974`*^9, 3.830914091769009*^9}, {
  3.830916019466039*^9, 3.8309160288026457`*^9}, {3.8309160723617554`*^9, 
  3.8309162017457128`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"36dd3cfd-a6ba-4c79-8366-4bc78ef98e08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvPolyhedronFixOrientation", "[", 
   RowBox[{"vertcoord_List", ",", "faces_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"V", " ", "=", "vertcoord"}], ",", 
      RowBox[{"G", "=", "faces"}], ",", "P0", ",", "v", ",", "v1", ",", "v2", 
      ",", "v3", ",", 
      RowBox[{"nlist", "=", 
       RowBox[{"{", "}"}]}], ",", "n", ",", "temp"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:0432\:043d\:0443\:0442\:0440\:0435\:043d\:043d\:044f\:044f", " ", 
      "\:0442\:043e\:0447\:043a\:0430", " ", 
      "\:0432\:044b\:043f\:0443\:043a\:043b\:043e\:0433\:043e", " ", 
      "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", "P0", " ", 
      RowBox[{"\:043e\:043f\:0440", ".", " ", "\:043a\:0430\:043a"}], " ", 
      "\:0441\:0440\:0435\:0434\:043d\:0435\:0435", " ", "\:043f\:043e", 
      "\[IndentingNewLine]", "\t\t", 
      "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:0430\:043c", 
      " ", "\:0432\:0441\:0435\:0445", " ", 
      "\:0432\:0435\:0440\:0448\:0438\:043d"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"P0", "=", 
      RowBox[{"Mean", "@", "V"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:0434\:043b\:044f", " ", "\:043a\:0430\:0436\:0434\:043e\:0439", 
         " ", "\:0433\:0440\:0430\:043d\:0438", " ", 
         "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
         "\:0442\:0440\:0438", " ", 
         "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", "v1"}], ",", " ", 
        "v2", ",", " ", "v3", ",", " ", 
        RowBox[{
        "\:043d\:0435", " ", "\:043b\:0435\:0436\:0430\:0449\:0438\:0435", 
         " ", "\:043d\:0430", " ", "\:043e\:0434\:043d\:043e\:0439", " ", 
         "\:043f\:0440\:044f\:043c\:043e\:0439"}]}], "*)"}], 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"faces", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2"}], "}"}], " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"v", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"v3", " ", "=", " ", 
         RowBox[{"First", "@", 
          RowBox[{"Select", "[", 
           RowBox[{"v", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MatrixRank", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v2", "-", "v1"}], ",", 
                 RowBox[{"#", "-", "v2"}]}], "}"}], "]"}], ">", "1"}], "&"}], 
            ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:043c", " ", 
          "\:043d\:043e\:0440\:043c\:0430\:043b\:044c", " ", "\:043a", " ", 
          "\:0433\:0440\:0430\:043d\:0438", " ", 
          RowBox[{"(", 
           RowBox[{
           "\:043d\:0435", " ", 
            "\:043e\:0431\:044f\:0437\:0430\:0442\:0435\:043b\:044c\:043d\
\:043e", " ", "\:0432\:043d\:0435\:0448\:043d\:044e\:044e"}], ")"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"v2", "-", "v1"}], ",", 
           RowBox[{"v3", "-", "v2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"N", "[", 
          RowBox[{"n", "/", 
           RowBox[{"Norm", "[", "n", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"\:0435\:0441\:043b\:0438", " ", 
           RowBox[{
           "\:0432\:043d\:0443\:0442\:0440", ".", " ", 
            "\:0442\:043e\:0447\:043a\:0430"}], " ", "P0", " ", 
           RowBox[{
           "\:043e\:0440\:0438\:0435\:043d\:0442", ".", " ", 
            "\:043d\:0435\:043f\:0440\:0430\:0432\:0438\:043b\:044c\:043d\
\:043e"}]}], ",", " ", 
          RowBox[{
          "\:043c\:0435\:043d\:044f\:0435\:043c", " ", 
           "\:043e\:0431\:0445\:043e\:0434", " ", 
           "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
           RowBox[{
           "\:0441\:043e\:043e\:0442\:0432", ".", " ", 
            "\:0433\:0440\:0430\:043d\:0438"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"n", ".", "P0"}], "-", 
            RowBox[{"n", ".", "v1"}]}], ">", "0"}], ",", " ", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"-", "n"}]}], ";", " ", 
           RowBox[{
            RowBox[{"G", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"Reverse", "[", 
             RowBox[{"faces", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"nlist", ",", "n"}], "]"}], ";"}], "\[IndentingNewLine]", 
       "\t\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "faces"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{"V", ",", "G", ",", "nlist"}], "}"}]}]}], " ", 
   "\[IndentingNewLine]", "\t", "]"}], "\t"}]], "Input",
 CellChangeTimes->{{3.8307404365221663`*^9, 3.8307405318775854`*^9}, {
   3.83074075700869*^9, 3.8307408038175173`*^9}, {3.8307408665508976`*^9, 
   3.830740962794404*^9}, {3.830740994736998*^9, 3.8307411709805975`*^9}, {
   3.8307412177539625`*^9, 3.830741281219687*^9}, {3.8307413411244926`*^9, 
   3.8307413737143593`*^9}, {3.8307414050535784`*^9, 3.830741482311118*^9}, {
   3.8307416069030423`*^9, 3.8307416104455366`*^9}, {3.830741786358749*^9, 
   3.8307419040358543`*^9}, {3.8307421961519394`*^9, 
   3.8307424240015864`*^9}, {3.8307424541819315`*^9, 
   3.8307425335612626`*^9}, {3.830742573456732*^9, 3.830742579578404*^9}, {
   3.8307427207698765`*^9, 3.8307427320427384`*^9}, {3.830742786243823*^9, 
   3.830742791411109*^9}, {3.8307428443625355`*^9, 3.830742847743497*^9}, {
   3.8307458072352314`*^9, 3.830745862435624*^9}, {3.8307459220723977`*^9, 
   3.8307459579969215`*^9}, {3.8307460638927326`*^9, 3.830746090454981*^9}, {
   3.8307461732289143`*^9, 3.8307463154559016`*^9}, {3.830746459021406*^9, 
   3.8307465240358224`*^9}, {3.830746626443242*^9, 3.830746668468584*^9}, {
   3.8307466993399076`*^9, 3.8307467752110424`*^9}, 3.8307468617366285`*^9, {
   3.830747225516075*^9, 3.8307472353706055`*^9}, {3.8307472916556077`*^9, 
   3.8307473108540297`*^9}, {3.8307473690532074`*^9, 3.830747426946129*^9}, {
   3.830747470607503*^9, 3.830747533709938*^9}, {3.8307480034762783`*^9, 
   3.8307480049956255`*^9}, {3.8307482519201202`*^9, 3.8307482520687*^9}, {
   3.8308511237190313`*^9, 3.8308511294914937`*^9}, {3.8308513721847963`*^9, 
   3.8308513843398685`*^9}, {3.8308514201889124`*^9, 
   3.8308514222941403`*^9}, {3.830916989005083*^9, 3.8309170252642436`*^9}, {
   3.8309170815088654`*^9, 3.8309171094125004`*^9}, {3.8309171703405724`*^9, 
   3.830917175213546*^9}, {3.830917219101204*^9, 3.8309172514868584`*^9}, {
   3.8309172919645967`*^9, 3.8309173429313545`*^9}, {3.830917841366247*^9, 
   3.83091786489435*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"69bd0812-c264-4887-b17e-ce086a935efb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvPolyhedron", "[", 
   RowBox[{"vertcoord_List", ",", "faces_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"P", ",", "V", ",", "VT", ",", "G", ",", "n"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V", ",", "G", ",", "n"}], "}"}], " ", "=", " ", 
      RowBox[{"ConvPolyhedronFixOrientation", "[", 
       RowBox[{"vertcoord", ",", "faces"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"VT", "=", 
      RowBox[{"Transpose", "@", "V"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<coord\>\"", "]"}], " ", "=", " ", "V"}], ";", 
     " ", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"\"\<coord\>\"", ",", "i_"}], "]"}], ":=", 
      RowBox[{"V", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<tcoord\>\"", "]"}], "=", "VT"}], ";", " ", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"\"\<tcoord\>\"", ",", "i_"}], "]"}], ":=", " ", 
      RowBox[{"VT", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<faces\>\"", "]"}], " ", "=", " ", "G"}], ";", 
     " ", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"\"\<faces\>\"", ",", "i_"}], "]"}], ":=", 
      RowBox[{"G", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<norm\>\"", "]"}], "=", "n"}], ";", " ", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"\"\<norm\>\"", ",", "i_"}], "]"}], ":=", 
      RowBox[{"n", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<nverts\>\"", "]"}], "=", 
      RowBox[{"Length", "@", "V"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<nfaces\>\"", "]"}], "=", 
      RowBox[{"Length", "@", "G"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<pmean\>\"", "]"}], "=", " ", 
      RowBox[{"Mean", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<bbsphereradius\>\"", "]"}], "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"Mean", "[", "V", "]"}], ",", 
            RowBox[{"Length", "@", "V"}]}], "]"}], "-", "V"}], ")"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}], "=", 
      RowBox[{"P", "[", "\"\<pmean\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     "\t\t", 
     RowBox[{
      RowBox[{"P", "[", "\"\<name\>\"", "]"}], " ", "=", " ", 
      "\"\<ConvexPolyhedron\>\""}], ";", "\[IndentingNewLine]", "\t\t", 
     "P"}]}], "\[IndentingNewLine]", "\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.830735459225726*^9, 3.8307354592267237`*^9}, 
   3.8307356629380946`*^9, {3.8307357102814984`*^9, 3.830735873806577*^9}, {
   3.830740112650659*^9, 3.830740149992237*^9}, 3.8307401954746337`*^9, {
   3.8307477270301723`*^9, 3.830747762873947*^9}, {3.830747808225552*^9, 
   3.8307478363151045`*^9}, {3.8307478849779525`*^9, 3.830747934935611*^9}, {
   3.830748016989377*^9, 3.8307480350500526`*^9}, {3.830748412342395*^9, 
   3.8307484222944384`*^9}, {3.8307484594517403`*^9, 3.830748644130577*^9}, {
   3.8307494395958967`*^9, 3.8307494420234385`*^9}, {3.8307573866919136`*^9, 
   3.8307573881131277`*^9}, {3.830826352415402*^9, 3.830826422082095*^9}, {
   3.830849717398472*^9, 3.830849754212346*^9}, {3.830849790238249*^9, 
   3.8308498235877557`*^9}, {3.8308499357712836`*^9, 3.830849998884872*^9}, {
   3.8309065372704926`*^9, 3.8309065437731*^9}, {3.831059603404814*^9, 
   3.8310596194514947`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"a16074f1-012f-4092-a903-1a425420ef25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"ConvPolyhedron", "[", 
    RowBox[{"V1", ",", "G1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P2", "=", 
   RowBox[{"ConvPolyhedron", "[", 
    RowBox[{"V2", ",", "G2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P3", "=", 
   RowBox[{"ConvPolyhedron", "[", 
    RowBox[{"V2", ",", "G2"}], "]"}]}], ";", " ", 
  RowBox[{
  "(*", " ", "\:043a\:043e\:043f\:0438\:044f", " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.830757390781993*^9, 3.8307574118795843`*^9}, {
  3.8309163710657544`*^9, 3.83091638254032*^9}, {3.8315399351672645`*^9, 
  3.831539946802162*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"c871f9de-e385-4955-b8d1-6122eb0b9cd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyhedronShow", "[", 
   RowBox[{
    RowBox[{"{", "P_", "}"}], ",", 
    RowBox[{"othergraphics_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"texttipdelta", " ", "=", 
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", " ", "Black", 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Tooltip", "/@", 
         RowBox[{"Point", "/@", 
          RowBox[{"P", "[", "\"\<coord\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "@", 
            RowBox[{
             RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"P", "[", 
               RowBox[{"\"\<faces\>\"", ",", "i"}], "]"}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"P", "[", "\"\<nfaces\>\"", "]"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "texttipdelta"}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"P", "[", "\"\<nverts\>\"", "]"}]}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"Sequence", "@@", "othergraphics"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", "\t\t  ", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8307576458655205`*^9, 3.8307577361094923`*^9}, {
  3.8307578106073117`*^9, 3.8307578380907784`*^9}, {3.8309064482083635`*^9, 
  3.8309064821180105`*^9}, {3.8313986877055254`*^9, 3.8313986893995533`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0cd58331-e3d8-46cc-be32-4444a152d789"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyhedronShow", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"P1_", ",", "P2_"}], "}"}], ",", 
    RowBox[{"othergraphics_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"texttipdelta", " ", "=", 
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", " ", "Black", 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Tooltip", "/@", 
         RowBox[{"Point", "/@", 
          RowBox[{"P1", "[", "\"\<coord\>\"", "]"}]}]}], ",", 
        RowBox[{"Tooltip", "/@", 
         RowBox[{"Point", "/@", 
          RowBox[{"P2", "[", "\"\<coord\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "@", 
            RowBox[{
             RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"P1", "[", 
               RowBox[{"\"\<faces\>\"", ",", "i"}], "]"}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"P1", "[", "\"\<nfaces\>\"", "]"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "texttipdelta"}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"P1", "[", "\"\<nverts\>\"", "]"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", "\t\t", "Gray", ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "@", 
            RowBox[{
             RowBox[{"P2", "[", "\"\<coord\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"P2", "[", 
               RowBox[{"\"\<faces\>\"", ",", "i"}], "]"}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"P2", "[", "\"\<nfaces\>\"", "]"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"P2", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "texttipdelta"}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"P2", "[", "\"\<nverts\>\"", "]"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "\t\t", ",", 
        RowBox[{"Sequence", "@@", "othergraphics"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", "\t\t  ", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8313981635498056`*^9, 3.8313982799859395`*^9}, {
   3.8313988686882224`*^9, 3.831398869142009*^9}, 3.8313989123269405`*^9, 
   3.8313992574275756`*^9, 3.831399378389868*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"23cc6d24-dce9-4346-ada4-7cc621971267"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyhedronShow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"P1", ",", "P2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Red", ",", 
     RowBox[{"Point", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8313987928524723`*^9, 3.8313988115568542`*^9}, {
  3.831398921997536*^9, 3.8313989760447245`*^9}, {3.8313993960437775`*^9, 
  3.831399446215528*^9}, {3.8314002616838303`*^9, 3.831400268098591*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7d202f44-0107-4999-83d5-3ce612bcf0c3"],

Cell[BoxData[
 Graphics3DBox[
  {GrayLevel[0], PointSize[0.025], {
    TagBox[
     TooltipBox[Point3DBox[{31, 10, -2}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"31", ",", "10", ",", 
            RowBox[{"-", "2"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{31, 10, -2}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{29, 15, 2}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"29", ",", "15", ",", "2"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{29, 15, 2}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{6, 5, 3}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"6", ",", "5", ",", "3"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{6, 5, 3}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{13, -5, -6}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"13", ",", 
            RowBox[{"-", "5"}], ",", 
            RowBox[{"-", "6"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{13, -5, -6}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{14.2, 4, -11.4}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"14.2`", ",", "4", ",", 
            RowBox[{"-", "11.4`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{14.2, 4, -11.4}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{14, 15, -15}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"14", ",", "15", ",", 
            RowBox[{"-", "15"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{14, 15, -15}], "Tooltip"]& ]}, {
    TagBox[
     TooltipBox[Point3DBox[{-4.5, 6.4, 9.94}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "4.5`"}], ",", "6.4`", ",", "9.94`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-4.5, 6.4, 9.94}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{-8.7, -7.7, 9.87}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "8.7`"}], ",", 
            RowBox[{"-", "7.7`"}], ",", "9.87`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-8.7, -7.7, 9.87}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{7.08, -13.494, 8.917}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"7.08`", ",", 
            RowBox[{"-", "13.494`"}], ",", "8.917`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{7.08, -13.494, 8.917}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{9.9, -7.12, 8.9}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"9.9`", ",", 
            RowBox[{"-", "7.12`"}], ",", "8.9`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{9.9, -7.12, 8.9}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{4.8, 6.69, 9.455}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"4.8`", ",", "6.69`", ",", "9.455`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{4.8, 6.69, 9.455}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{12, 5.75, 4}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"12", ",", "5.75`", ",", "4"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{12, 5.75, 4}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{13.5, -6.75, 3}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"13.5`", ",", 
            RowBox[{"-", "6.75`"}], ",", "3"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{13.5, -6.75, 3}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{14.04, 0.898, 1.24}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"14.04`", ",", "0.898`", ",", "1.24`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{14.04, 0.898, 1.24}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{8.394, -15.1842, 5.3821}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"8.394`", ",", 
            RowBox[{"-", "15.1842`"}], ",", "5.3821`"}], "}"}], "]"}]],
     Annotation[#, 
      Point[{8.394, -15.1842, 5.3821}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{-2.70672, -13.668704, -1.273248}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "2.70672`"}], ",", 
            RowBox[{"-", "13.668704`"}], ",", 
            RowBox[{"-", "1.273248`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-2.70672, -13.668704, -1.273248}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{-13.5, -3., -1.25}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "13.5`"}], ",", 
            RowBox[{"-", "3.`"}], ",", 
            RowBox[{"-", "1.25`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-13.5, -3., -1.25}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{-7.5, -10.75, -1.25}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "7.5`"}], ",", 
            RowBox[{"-", "10.75`"}], ",", 
            RowBox[{"-", "1.25`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-7.5, -10.75, -1.25}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{-3.25, 13., -1.25}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "3.25`"}], ",", "13.`", ",", 
            RowBox[{"-", "1.25`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-3.25, 13., -1.25}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{4.84, 10.892, -4.0185}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"4.84`", ",", "10.892`", ",", 
            RowBox[{"-", "4.0185`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{4.84, 10.892, -4.0185}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{9.75, -9.75, -4.25}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"9.75`", ",", 
            RowBox[{"-", "9.75`"}], ",", 
            RowBox[{"-", "4.25`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{9.75, -9.75, -4.25}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{-4.25, 2.5, -11.75}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "4.25`"}], ",", "2.5`", ",", 
            RowBox[{"-", "11.75`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{-4.25, 2.5, -11.75}], "Tooltip"]& ], 
    TagBox[
     TooltipBox[Point3DBox[{10.023, -0.8724, -7.087}],
      RowBox[{"Point", "[", 
        RowBox[{"{", 
          RowBox[{"10.023`", ",", 
            RowBox[{"-", "0.8724`"}], ",", 
            RowBox[{"-", "7.087`"}]}], "}"}], "]"}]],
     Annotation[#, 
      Point[{10.023, -0.8724, -7.087}], "Tooltip"]& ]}, 
   Line3DBox[{{31, 10, -2}, {29, 15, 2}, {6, 5, 3}, {13, -5, -6}, {31, 
    10, -2}}], 
   Line3DBox[{{14.2, 4, -11.4}, {13, -5, -6}, {6, 5, 3}, {14, 15, -15}, {
     14.2, 4, -11.4}}], 
   Line3DBox[{{31, 10, -2}, {13, -5, -6}, {14.2, 4, -11.4}, {31, 10, -2}}], 
   Line3DBox[{{31, 10, -2}, {14.2, 4, -11.4}, {14, 15, -15}, {31, 10, -2}}], 
   Line3DBox[{{31, 10, -2}, {14, 15, -15}, {29, 15, 2}, {31, 10, -2}}], 
   Line3DBox[{{29, 15, 2}, {14, 15, -15}, {6, 5, 3}, {29, 15, 2}}], 
   Text3DBox["1", {31.75, 10.75, -1.25}], 
   Text3DBox["2", {29.75, 15.75, 2.75}], Text3DBox["3", {6.75, 5.75, 3.75}], 
   Text3DBox["4", {13.75, -4.25, -5.25}], 
   Text3DBox["5", {14.95, 4.75, -10.65}], 
   Text3DBox["6", {14.75, 15.75, -14.25}], 
   {GrayLevel[0.5], 
    Line3DBox[{{-4.5, 6.4, 9.94}, {-8.7, -7.7, 9.87}, {7.08, -13.494, 
     8.917}, {9.9, -7.12, 8.9}, {4.8, 6.69, 9.455}, {-4.5, 6.4, 9.94}}], 
    Line3DBox[{{12, 5.75, 4}, {4.8, 6.69, 9.455}, {9.9, -7.12, 8.9}, {
      12, 5.75, 4}}], 
    Line3DBox[{{9.9, -7.12, 8.9}, {13.5, -6.75, 3}, {14.04, 0.898, 1.24}, {
      12, 5.75, 4}, {9.9, -7.12, 8.9}}], 
    Line3DBox[{{9.9, -7.12, 8.9}, {7.08, -13.494, 8.917}, {8.394, -15.1842, 
      5.3821}, {13.5, -6.75, 3}}], 
    Line3DBox[{{7.08, -13.494, 8.917}, {-8.7, -7.7, 
     9.87}, {-2.70672, -13.668704, -1.273248}, {8.394, -15.1842, 5.3821}, {
     7.08, -13.494, 8.917}}], 
    Line3DBox[{{-4.5, 6.4, 9.94}, {-13.5, -3., -1.25}, {-8.7, -7.7, 
     9.87}, {-4.5, 6.4, 9.94}}], 
    Line3DBox[{{-8.7, -7.7, 
     9.87}, {-7.5, -10.75, -1.25}, {-2.70672, -13.668704, -1.273248}, {-8.7, \
-7.7, 9.87}}], 
    Line3DBox[{{-8.7, -7.7, 
     9.87}, {-13.5, -3., -1.25}, {-7.5, -10.75, -1.25}, {-8.7, -7.7, 9.87}}], 
    Line3DBox[{{-4.5, 6.4, 9.94}, {4.8, 6.69, 9.455}, {-3.25, 
     13., -1.25}, {-4.5, 6.4, 9.94}}], 
    Line3DBox[{{-4.5, 6.4, 9.94}, {-3.25, 
     13., -1.25}, {-13.5, -3., -1.25}, {-4.5, 6.4, 9.94}}], 
    Line3DBox[{{4.8, 6.69, 9.455}, {12, 5.75, 4}, {4.84, 
      10.892, -4.0185}, {-3.25, 13., -1.25}, {4.8, 6.69, 9.455}}], 
    Line3DBox[{{12, 5.75, 4}, {14.04, 0.898, 1.24}, {4.84, 10.892, -4.0185}, {
      12, 5.75, 4}}], 
    Line3DBox[{{8.394, -15.1842, 5.3821}, {9.75, -9.75, -4.25}, {
      13.5, -6.75, 3}, {8.394, -15.1842, 5.3821}}], 
    Line3DBox[{{8.394, -15.1842, 5.3821}, {-2.70672, -13.668704, -1.273248}, {
     9.75, -9.75, -4.25}, {8.394, -15.1842, 5.3821}}], 
    Line3DBox[{{-3.25, 13., -1.25}, {-4.25, 
     2.5, -11.75}, {-13.5, -3., -1.25}, {-3.25, 13., -1.25}}], 
    Line3DBox[{{14.04, 0.898, 1.24}, {13.5, -6.75, 3}, {9.75, -9.75, -4.25}, {
      10.023, -0.8724, -7.087}, {14.04, 0.898, 1.24}}], 
    Line3DBox[{{4.84, 10.892, -4.0185}, {-4.25, 2.5, -11.75}, {-3.25, 
     13., -1.25}, {4.84, 10.892, -4.0185}}], 
    Line3DBox[{{14.04, 0.898, 1.24}, {10.023, -0.8724, -7.087}, {4.84, 
     10.892, -4.0185}, {14.04, 0.898, 1.24}}], 
    Line3DBox[{{10.023, -0.8724, -7.087}, {-4.25, 2.5, -11.75}, {4.84, 
     10.892, -4.0185}, {10.023, -0.8724, -7.087}}], 
    Line3DBox[{{-4.25, 2.5, -11.75}, {10.023, -0.8724, -7.087}, {
     9.75, -9.75, -4.25}, {-4.25, 2.5, -11.75}}], 
    Line3DBox[{{-4.25, 
     2.5, -11.75}, {-7.5, -10.75, -1.25}, {-13.5, -3., -1.25}, {-4.25, 
     2.5, -11.75}}], 
    Line3DBox[{{-4.25, 
     2.5, -11.75}, {-2.70672, -13.668704, -1.273248}, {-7.5, -10.75, -1.25}, \
{-4.25, 2.5, -11.75}}], 
    Line3DBox[{{-4.25, 2.5, -11.75}, {
     9.75, -9.75, -4.25}, {-2.70672, -13.668704, -1.273248}, {-4.25, 
     2.5, -11.75}}], Text3DBox["1", {-3.75, 7.15, 10.69}], 
    Text3DBox["2", {-7.949999999999999, -6.95, 10.62}], 
    Text3DBox["3", {7.83, -12.744, 9.667}], 
    Text3DBox["4", {10.65, -6.37, 9.65}], 
    Text3DBox["5", {5.55, 7.44, 10.205}], Text3DBox["6", {12.75, 6.5, 4.75}], 
    Text3DBox["7", {14.25, -6., 3.75}], 
    Text3DBox["8", {14.79, 1.6480000000000001`, 1.99}], 
    Text3DBox["9", {9.144, -14.4342, 6.1321}], 
    Text3DBox["10", {-1.9567199999999998`, -12.918704, -0.5232479999999999}], 
    Text3DBox["11", {-12.75, -2.25, -0.5}], 
    Text3DBox["12", {-6.75, -10., -0.5}], 
    Text3DBox["13", {-2.5, 13.75, -0.5}], 
    Text3DBox["14", {5.59, 11.642, -3.2685000000000004`}], 
    Text3DBox["15", {10.5, -9., -3.5}], Text3DBox["16", {-3.5, 3.25, -11.}], 
    Text3DBox["17", {10.773, -0.12239999999999995`, -6.337}]}, 
   {RGBColor[1, 0, 0], Point3DBox[{0, 0, 0}]}},
  Axes->True,
  AxesLabel->{
    FormBox["x", TraditionalForm], 
    FormBox["y", TraditionalForm], 
    FormBox["z", TraditionalForm]},
  ImageSize->Medium,
  ViewPoint->{0.47135413779888874`, 2.992684918584045, -1.5072034550316933`},
  ViewVertical->{-0.0013291550522605184`, 0.8436350260816969, 
   0.5369154273393358}]], "Output",
 CellChangeTimes->{{3.83139892926138*^9, 3.831398976413703*^9}, 
   3.831399271839656*^9, {3.8313993926719007`*^9, 3.8313994731001406`*^9}, 
   3.831399874203603*^9, 3.8313999935111933`*^9, 3.8314000844317613`*^9, {
   3.8314001629150934`*^9, 3.8314002168594656`*^9}, {3.8314002536051083`*^9, 
   3.8314002687765045`*^9}, 3.831400350813135*^9, 3.8314004525236855`*^9, 
   3.831537872368374*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"40a52975-61a2-47da-859c-1c80ecff5009"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RayCasting3DConvPolyhedron", "[", 
   RowBox[{"p0_List", ",", "dir_List", ",", "P_"}], "]"}], ":=", 
  "\[IndentingNewLine]", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "V", ",", "Vx", ",", "Vy", ",", "X", ",", "Y", ",", "Z", ",", "X1", ",", 
      "X2", ",", "Y1", ",", "Y2", ",", "Z1", ",", "Z2", ",", "Z0", ",", 
      "Zmin", ",", "Zmax", ",", "res", ",", "XZ", ",", "temp", ",", 
      "\[IndentingNewLine]", "\t", "\[Alpha]x", ",", "\[Alpha]y", ",", "Mx", 
      ",", "My", ",", "IMx", ",", "IMy", ",", "dirx", ",", "diry", ",", 
      "mask"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:043f\:0430\:0440\:0430\:043b\:043b\:0435\:043b\:044c\:043d\:044b\:0439\
", " ", "\:043f\:0435\:0440\:0435\:043d\:043e\:0441", " ", 
      "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442", " ", "\:043a",
       " ", 
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0"}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "-", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"p0", ",", 
         RowBox[{"P", "[", "\"\<nverts\>\"", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:043f\:043e\:0432\:043e\:0440\:043e\:0442", " ", 
        "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442", " ", 
        "\:0442\:0430\:043a"}], ",", " ", 
       RowBox[{
       "\:0447\:0442\:043e\:0431\:044b", " ", "\:043b\:0443\:0447", " ", 
        "\:0448\:0435\:043b", " ", "\:043f\:043e", " ", "\:043e\:0441\:0438", 
        " ", "z"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dir", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], ",", 
       RowBox[{"\[Alpha]x", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "+", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"dir", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/", 
            RowBox[{"dir", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", " ", 
       RowBox[{"\[Alpha]x", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Mx", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Cos", "[", "\[Alpha]x", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Alpha]x", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Sin", "[", "\[Alpha]x", "]"}], ",", 
          RowBox[{"Cos", "[", "\[Alpha]x", "]"}]}], "}"}]}], "}"}]}], ";", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"Vx", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"V", ".", "Mx"}], "]"}]}], ";", " ", 
     RowBox[{"dirx", "=", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{"dir", ".", "Mx"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dirx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], ",", 
       RowBox[{"\[Alpha]y", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "-", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"dirx", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/", 
            RowBox[{"dirx", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", " ", 
       RowBox[{"\[Alpha]y", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"My", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Alpha]y", "]"}], ",", "0", ",", 
          RowBox[{"Sin", "[", "\[Alpha]y", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Alpha]y", "]"}]}], ",", "0", ",", 
          RowBox[{"Cos", "[", "\[Alpha]y", "]"}]}], "}"}]}], "}"}]}], ";", 
     "\t", "\[IndentingNewLine]", "\t", 
     RowBox[{"Vy", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{"Vx", ".", "My"}], "]"}]}], ";", " ", 
     RowBox[{"diry", "=", " ", 
      RowBox[{"Chop", "[", 
       RowBox[{"dirx", ".", "My"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:0440\:0430\:0437\:0431\:0438\:0432\:0430\:0435\:043c", " ", 
        "\:0442\:043e\:0447\:043a\:0438", " ", 
        "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
        "\:043d\:0430", " ", "\:0434\:0432\:0435", " ", 
        "\:0433\:0440\:0443\:043f\:043f\:044b", " ", "V1", " ", "\:0438", " ",
         "V2"}], ",", " ", 
       RowBox[{
        RowBox[{
        "\:043b\:0435\:0436\:0430\:0449\:0438\:0435", " ", "\:043f\:043e", 
         " ", "\:0440\:0430\:0437\:043d\:044b\:0435", " ", 
         "\:0441\:0442\:043e\:0440\:043e\:043d\:044b", " ", "\:043e\:0442", 
         " ", "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438", "  ", 
         "y"}], "=", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", "Vy", "]"}]}], ";", " ", 
     RowBox[{"mask", "=", 
      RowBox[{"Boole", "[", 
       RowBox[{"NonNegative", "[", "Y", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X1", ",", "Y1", ",", "Z1"}], "}"}], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Pick", "[", 
         RowBox[{"#", ",", "mask", ",", "0"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}]}], ";", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X2", ",", "Y2", ",", "Z2"}], "}"}], "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Pick", "[", 
         RowBox[{"#", ",", "mask", ",", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"And", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "X1"}], "\[NotEqual]", "0"}], " ", ",", 
         RowBox[{
          RowBox[{"Length", "@", "X2"}], "\[NotEqual]", "0"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X", ",", "Z"}], "}"}], "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Transpose", "@", 
                RowBox[{"{", 
                 RowBox[{"X1", ",", "Z1"}], "}"}]}], ",", 
               RowBox[{"Length", "@", "X2"}]}], "]"}], "\[IndentingNewLine]", 
             "\t", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#1", "-", "X1"}], ",", 
                    RowBox[{"#2", "-", "Z1"}]}], "}"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"X2", ",", "Z2"}], "}"}]}], "]"}]}], "*", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Y1", "/", 
                   RowBox[{"(", 
                    RowBox[{"Y1", "-", "#"}], ")"}]}], "&"}], ",", "Y2"}], 
                "]"}]}], ")"}]}], ",", "1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"mask", "=", 
         RowBox[{"Boole", "[", 
          RowBox[{"NonNegative", "[", "X", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X1", ",", "Z1"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{"#", ",", "mask", ",", "0"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"X", ",", "Z"}], "}"}]}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X2", ",", "Z2"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Pick", "[", 
            RowBox[{"#", ",", "mask", ",", "1"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"X", ",", "Z"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "X1"}], "\[NotEqual]", "0"}], " ", ",", 
            RowBox[{
             RowBox[{"Length", "@", "X2"}], "\[NotEqual]", "0"}]}], "]"}], 
          ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Z0", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Z1", "+", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"X1", "/", 
                    RowBox[{"(", 
                    RowBox[{"X1", "-", "#"}], ")"}]}], "&"}], ",", "X2"}], 
                  "]"}], "*", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "Z1"}], ")"}], "&"}], ",", "Z2"}], 
                  "]"}]}], "]"}]}], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Zmin", ",", "Zmax"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Min", "[", "Z0", "]"}], ",", 
              RowBox[{"Max", "[", "Z0", "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "\:043e\:0431\:0440\:0430\:0442\:043d\:043e\:0435", " ", 
             "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\:0432\
\:0430\:043d\:0438\:0435", " ", 
             "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"IMx", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"Cos", "[", 
                 RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"-", "\[Alpha]x"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"Sin", "[", 
                 RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                RowBox[{"Cos", "[", 
                 RowBox[{"-", "\[Alpha]x"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"IMy", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"-", "\[Alpha]y"}], "]"}], ",", "0", ",", 
                RowBox[{"Sin", "[", 
                 RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"-", "\[Alpha]y"}], "]"}]}], ",", "0", ",", 
                RowBox[{"Cos", "[", 
                 RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "\:0444\:043e\:0440\:043c\:0438\:0440\:043e\:0432\:0430\:043d\
\:0438\:0435", " ", "\:043e\:0442\:0432\:0435\:0442\:0430"}], " ", "-", " ", 
              "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430"}], ",", " ", 
             RowBox[{
             "\:043f\:0440\:0438\:043d\:0430\:0434\:043b\:0435\:0436\:0430\
\:0442", " ", "\:043b\:0438", " ", 
              "\:043d\:0430\:0439\:0434\:0435\:043d\:043d\:044b\:0435", " ", 
              "\:0442\:043e\:0447\:043a\:0438", " ", 
              "\:043b\:0443\:0447\:0443"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"res", " ", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"temp", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "Zmin"}], "}"}], ".", "IMy", ".", 
             "IMx"}]}], ";", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"temp", ".", "dir"}], "\[GreaterEqual]", " ", "0"}], 
             ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"res", ",", 
               RowBox[{"p0", "+", "temp"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"temp", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "Zmax"}], "}"}], ".", "IMy", ".", 
             "IMx"}]}], ";", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"temp", ".", "dir"}], "\[GreaterEqual]", " ", "0"}], 
             ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"res", ",", 
               RowBox[{"p0", "+", "temp"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Return", "[", "res", "]"}]}], "\[IndentingNewLine]", 
          "\t\t", ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "\t", 
       ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.830825322045734*^9, 3.830825367459014*^9}, {
   3.830825625031373*^9, 3.8308257366086206`*^9}, {3.8308257917073183`*^9, 
   3.830825796151414*^9}, {3.830825826287846*^9, 3.830825867896261*^9}, {
   3.8308260087197304`*^9, 3.8308260139228663`*^9}, {3.8308260952165155`*^9, 
   3.830826106861496*^9}, {3.830826185743615*^9, 3.8308262074955635`*^9}, {
   3.830826275298295*^9, 3.830826291034212*^9}, {3.8308265308971653`*^9, 
   3.830826544588587*^9}, {3.8308268715487614`*^9, 3.830826914861964*^9}, {
   3.830826985773337*^9, 3.8308270464720755`*^9}, {3.8308270769120865`*^9, 
   3.8308270776761*^9}, {3.8308271151608553`*^9, 3.8308271693430033`*^9}, {
   3.8308272324157457`*^9, 3.8308273935356812`*^9}, {3.830827450423584*^9, 
   3.8308274552936387`*^9}, {3.830827489201933*^9, 3.830827496144371*^9}, {
   3.8308276179716673`*^9, 3.830827670650037*^9}, {3.8308282563863993`*^9, 
   3.8308282771608295`*^9}, {3.8308286638789525`*^9, 3.830828700536994*^9}, {
   3.830829175026597*^9, 3.830829191217639*^9}, {3.8308299196562977`*^9, 
   3.8308299282419205`*^9}, 3.830830032167096*^9, {3.8308302308000283`*^9, 
   3.8308302469318686`*^9}, {3.830830317113267*^9, 3.8308303176807146`*^9}, {
   3.8308304217465024`*^9, 3.830830444173549*^9}, {3.8308307387466097`*^9, 
   3.8308308709912453`*^9}, 3.830830903031582*^9, 3.830831204371723*^9, 
   3.8308315733113785`*^9, 3.830831641200897*^9, {3.8308319421881576`*^9, 
   3.8308321246588182`*^9}, {3.8308327011486025`*^9, 
   3.8308327780007734`*^9}, {3.8308328475276003`*^9, 3.830832940490836*^9}, 
   3.8308331349194202`*^9, {3.8308340519312963`*^9, 3.830834347967755*^9}, {
   3.8308344346302147`*^9, 3.83083444583613*^9}, {3.830834551312724*^9, 
   3.830834563400405*^9}, 3.830834608859846*^9, {3.8308346443858795`*^9, 
   3.830834795367213*^9}, {3.830834872558833*^9, 3.830834973909089*^9}, {
   3.830835018262764*^9, 3.830835091334585*^9}, {3.830835156362817*^9, 
   3.8308352116840467`*^9}, {3.830835478658396*^9, 3.830835495982484*^9}, {
   3.830835764100638*^9, 3.830835811380257*^9}, {3.8308363134963617`*^9, 
   3.830836319095394*^9}, {3.8308364594201627`*^9, 3.830836460111318*^9}, {
   3.830836816582285*^9, 3.8308368176464605`*^9}, {3.8308369840894337`*^9, 
   3.830836985025899*^9}, {3.8308370773291426`*^9, 3.8308371387001743`*^9}, {
   3.830837179575288*^9, 3.830837212567116*^9}, {3.8308381012833753`*^9, 
   3.830838124798504*^9}, {3.830838320836604*^9, 3.8308383821491594`*^9}, 
   3.830840519052841*^9, {3.8308406227952933`*^9, 3.830840631471794*^9}, 
   3.830841377370116*^9, {3.830841677187535*^9, 3.830841703524665*^9}, {
   3.8308417408269043`*^9, 3.830841760249012*^9}, {3.8308418061093907`*^9, 
   3.830841910131398*^9}, {3.8308424688107452`*^9, 3.8308424961326923`*^9}, 
   3.830842560016154*^9, {3.8308427201720963`*^9, 3.830842723121214*^9}, {
   3.8308428069243*^9, 3.8308428117836018`*^9}, {3.830842853742449*^9, 
   3.830842900181283*^9}, 3.830843073248539*^9, {3.8308432975958023`*^9, 
   3.8308433391427207`*^9}, {3.830843449631322*^9, 3.830843490538948*^9}, {
   3.830843720389147*^9, 3.8308437230191126`*^9}, {3.8308438342915854`*^9, 
   3.830843872850629*^9}, {3.8308439152965307`*^9, 3.830843936149316*^9}, {
   3.830844649009739*^9, 3.8308447023761683`*^9}, {3.8308447399776354`*^9, 
   3.830844741264168*^9}, {3.83084480481365*^9, 3.830844805883793*^9}, {
   3.8308451247064734`*^9, 3.830845270958604*^9}, {3.830846001277591*^9, 
   3.8308460121824355`*^9}, {3.8308460478221474`*^9, 3.83084610546846*^9}, {
   3.8308461494917574`*^9, 3.8308462845561438`*^9}, {3.8308464173252997`*^9, 
   3.8308464331529665`*^9}, {3.830846563357894*^9, 3.83084659197659*^9}, {
   3.830846716656354*^9, 3.8308467710759554`*^9}, {3.830846820807066*^9, 
   3.830846855199182*^9}, {3.830847777707445*^9, 3.830847781337736*^9}, {
   3.8308491387527065`*^9, 3.830849190507*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"52375f14-3b0f-4e81-8615-f3c01d704d95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"p0", "=", 
    RowBox[{"P2", "[", "\"\<pmean\>\"", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p0", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "26"}], ",", "5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"PolyhedronShow", "[", 
      RowBox[{
       RowBox[{"{", "P2", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"Point", "@", "p0"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"p0", ",", 
            RowBox[{"p0", "+", 
             RowBox[{"2", "*", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}]}], "}"}], "]"}], 
         ",", "Red", ",", 
         RowBox[{"Point", "@", 
          RowBox[{"RayCasting3DConvPolyhedron", "[", 
           RowBox[{"p0", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "P2"}], "]"}]}]}],
         "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "3"}], ",", "3", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", "1.7"}], "}"}], ",", 
       RowBox[{"-", "3"}], ",", "3", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "0.3"}]}], "}"}], ",", 
       RowBox[{"-", "3"}], ",", "3", ",", "0.1"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8308440664939346`*^9, 3.8308440709500847`*^9}, {
   3.830844185019104*^9, 3.8308442190671787`*^9}, {3.8308442520679455`*^9, 
   3.830844316326745*^9}, {3.8308443706196136`*^9, 3.8308444014511833`*^9}, {
   3.8308444384143305`*^9, 3.830844438878089*^9}, 3.830844502462087*^9, {
   3.830844768274062*^9, 3.830844824163086*^9}, {3.8308448742991047`*^9, 
   3.8308448893439856`*^9}, {3.830845022404972*^9, 3.8308450276030893`*^9}, {
   3.830845303821766*^9, 3.8308453084843187`*^9}, {3.8308469932876034`*^9, 
   3.830847071963333*^9}, 3.830847801623486*^9, {3.830851582140416*^9, 
   3.830851586859785*^9}, {3.8308520550468636`*^9, 3.830852055668661*^9}, {
   3.8309080251316714`*^9, 3.8309081117610865`*^9}, 3.830909666031359*^9, {
   3.8309167697062984`*^9, 3.830916772010186*^9}, {3.830916843035269*^9, 
   3.830916869154546*^9}, {3.8309176184135613`*^9, 3.8309177538118343`*^9}, {
   3.831064978205858*^9, 3.831065033132012*^9}, {3.8314003612642546`*^9, 
   3.831400362475528*^9}, {3.8315447326159277`*^9, 3.8315447725591726`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"abed19f7-b990-435e-b00e-062aea065a89"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = -0.09999999999999964, \
$CellContext`y$$ = 1.7, $CellContext`z$$ = -0.5999999999999996, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], 0}, -3, 3, 0.1}, {{
       Hold[$CellContext`y$$], 1.7}, -3, 3, 0.1}, {{
       Hold[$CellContext`z$$], -0.3}, -3, 3, 0.1}}, Typeset`size$$ = {
    360., {187., 191.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x$100141$$ = 
    0, $CellContext`y$100142$$ = 0, $CellContext`z$100143$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`x$$ = 0, $CellContext`y$$ = 
        1.7, $CellContext`z$$ = -0.3}, "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$100141$$, 0], 
        Hold[$CellContext`y$$, $CellContext`y$100142$$, 0], 
        Hold[$CellContext`z$$, $CellContext`z$100143$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`PolyhedronShow[{$CellContext`P2}, {Blue, 
         Point[$CellContext`p0], 
         Line[{$CellContext`p0, $CellContext`p0 + 
           2 {$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}}], Red, 
         Point[
          $CellContext`RayCasting3DConvPolyhedron[$CellContext`p0, \
{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, $CellContext`P2]]}], 
      "Specifications" :> {{{$CellContext`x$$, 0}, -3, 3, 
         0.1}, {{$CellContext`y$$, 1.7}, -3, 3, 
         0.1}, {{$CellContext`z$$, -0.3}, -3, 3, 0.1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {260., 266.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8310649967423286`*^9, 3.831065034843459*^9}, 
   3.8312784361673193`*^9, 3.8313884609062986`*^9, 3.8313983022503967`*^9, 
   3.8314003629432373`*^9, 3.831400452623418*^9, 3.831537872447627*^9, {
   3.8315447232529573`*^9, 3.8315447733719893`*^9}},
 CellLabel->"Out[88]=",ExpressionUUID->"7fd5b217-859a-4a85-ad06-7e7c6c55dc28"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectileSphereCollisionQ3DBoundingSphere", "[", 
   RowBox[{"p0prev_List", ",", "p0cur_List", ",", 
    RowBox[{"r_", "?", "Positive"}], ",", "P_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dir", "=", 
       RowBox[{"p0cur", "-", "p0prev"}]}], ",", "l", ",", "temp1", ",", 
      "temp2", ",", "temp3", ",", "T", ",", "b1", ",", "b2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"l", "=", 
       RowBox[{"Norm", "[", "dir", "]"}]}], ";", " ", 
      RowBox[{"temp1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "r", "+", 
          RowBox[{"P", "[", "\"\<bbsphereradius\>\"", "]"}]}], ")"}], "^", 
        "2"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p0prev", "-", "#"}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"p0prev", "-", "#"}], ")"}]}], "\[LessEqual]", " ", 
             "temp1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p0cur", "-", "#"}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"p0cur", "-", "#"}], ")"}]}], "\[LessEqual]", " ", 
             "temp1"}]}], "]"}], "&"}], "@", 
         RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"temp2", "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p0prev", "-", 
                RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}]}], ")"}], 
              ".", "dir"}], ")"}], "2"], "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dir", ".", "dir"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p0prev", "-", 
                 RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}]}], ")"}], 
               ".", 
               RowBox[{"(", 
                RowBox[{"p0prev", "-", 
                 RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}]}], ")"}]}],
               "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"r", "+", 
                 RowBox[{"P", "[", "\"\<bbsphereradius\>\"", "]"}]}], ")"}], 
               "2"]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"temp2", "\[GreaterEqual]", " ", "0"}], ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"T", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox["1", 
                 RowBox[{"dir", ".", "dir"}]], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}], "-", 
                    "p0prev"}], ")"}], ".", "dir"}], "-", " ", 
                  RowBox[{"N", "@", 
                   SqrtBox["temp2"]}]}], ")"}]}], ",", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"dir", ".", "dir"}]], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"P", "[", "\"\<bbspherecenter\>\"", "]"}], "-", 
                    "p0prev"}], ")"}], ".", "dir"}], "+", " ", 
                  RowBox[{"N", "@", 
                   SqrtBox["temp2"]}]}], ")"}]}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"temp3", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p0prev", "+", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", "dir"}]}], ",", 
               RowBox[{"p0prev", "+", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", "dir"}]}]}], "}"}]}], 
            ";", "\t\t\t", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"b1", "=", 
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"NonNegative", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"temp3", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ".", "dir"}], "-", 
                 RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
               RowBox[{"NonNegative", "[", 
                RowBox[{
                 RowBox[{"dir", ".", "dir"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"temp3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "p0prev"}], ")"}], 
                  ".", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"temp3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "p0prev"}], 
                   ")"}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\t\t\t", 
            RowBox[{"b2", "=", 
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"NonNegative", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"temp3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ".", "dir"}], "-", 
                 RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
               RowBox[{"NonNegative", "[", 
                RowBox[{
                 RowBox[{"dir", ".", "dir"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"temp3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "p0prev"}], ")"}], 
                  ".", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"temp3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "p0prev"}], 
                   ")"}]}]}], "]"}]}], "]"}]}], ";", "\t\t\t\t", 
            "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Or", "[", 
               RowBox[{"b1", ",", "b2"}], "]"}], ",", "\[IndentingNewLine]", 
              "\t\t\t\t", 
              RowBox[{"Return", "[", "True", "]"}], "\[IndentingNewLine]", 
              "\t\t\t\t", ",", "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{"Return", "[", "False", "]"}]}], "\[IndentingNewLine]", 
             "\t\t\t", "]"}], ";"}], "\[IndentingNewLine]", "\t\t\t", ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Return", "[", "False", "]"}]}], "\[IndentingNewLine]", 
          "\t\t", "]"}], ";"}], "\[IndentingNewLine]", "\t\t", ",", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Return", "[", "False", "]"}]}], "\[IndentingNewLine]", "\t", 
       "]"}], ";"}], "\t", "\[IndentingNewLine]", ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8310583976198444`*^9, 3.8310584026501045`*^9}, {
   3.8310585167506905`*^9, 3.8310585810023513`*^9}, {3.831059080746519*^9, 
   3.8310591111645403`*^9}, {3.831059265443883*^9, 3.8310592684439707`*^9}, {
   3.8310593758215237`*^9, 3.8310593909405146`*^9}, {3.831059437956348*^9, 
   3.8310594872745*^9}, {3.8310595785046053`*^9, 3.8310595866134443`*^9}, {
   3.831060778449411*^9, 3.831060780325425*^9}, {3.8310625315842724`*^9, 
   3.8310626241043158`*^9}, {3.8310626705371914`*^9, 
   3.8310631565764055`*^9}, {3.8310631875007334`*^9, 3.831063305342578*^9}, {
   3.831063360165028*^9, 3.831063771218835*^9}, {3.831063862113283*^9, 
   3.831063890878554*^9}, 3.8315498662983885`*^9, 
   3.8315503219677362`*^9},ExpressionUUID->"66919027-88ca-48a5-affa-\
1a75c2686e37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectileSphereCollide3DConvPolyhedron", "[", 
   RowBox[{"p0prev_List", ",", "p0cur_List", ",", 
    RowBox[{"r_", "?", "Positive"}], ",", "P_", ",", 
    RowBox[{"chopaccuracy_:", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"P", "[", "\"\<faces\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", "d", 
      ",", "mask", ",", "res", ",", "dir", ",", "M", ",", "b1", ",", "b2", 
      ",", "ind1", ",", "ind2", ",", "p1", ",", "p2", ",", "p3", ",", "pnew", 
      ",", "p0prev1", ",", "x0", ",", "x1", ",", "y0", ",", "y1", ",", 
      "\[IndentingNewLine]", "Mx", ",", "IMx", ",", "My", ",", "IMy", ",", 
      "\[Alpha]x", ",", "\[Alpha]y", ",", "dir1", ",", "v0", ",", "vv", ",", 
      "vvshifted", ",", "mask1", ",", "mask2", ",", "mask3", ",", "mask4", 
      ",", "mask5", ",", "checkit1", ",", "checkit2", ",", "T", ",", 
      "shift"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:043c", " ", 
      "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:044b\:0435", " ", 
      "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:043d\:0438\:044f", 
      " ", "\:043e\:0442", " ", "\:0446\:0435\:043d\:0442\:0440\:0430", " ", 
      "\:0441\:0444\:0435\:0440\:044b", " ", "\:0434\:043e", " ", 
      "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"d", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "p0cur"}], "&"}], ",", 
         RowBox[{"P", "[", "\"\<norm\>\"", "]"}]}], "]"}], "-", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Dot", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"P", "[", "\"\<norm\>\"", "]"}], ",", "v"}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"dir", "=", 
      RowBox[{"p0cur", "-", "p0prev"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:043f\:043e\:0438\:0441\:043a", " ", 
        "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}], ",",
        " ", 
       RowBox[{
        RowBox[{
        "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", 
         "\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:044e\:0442", " ", 
         "\:043e\:0442\:0440\:0435\:0437\:043e\:043a", " ", "p0prev"}], "-", 
        "p0cur"}], ",", " ", 
       RowBox[{
       "\:0430", " ", "\:0442\:0430\:043a\:0436\:0435", " ", 
        "\:0441\:0430\:043c\:0438\:0445", " ", 
        "\:0442\:043e\:0447\:0435\:043a", " ", "\[IndentingNewLine]", "\t", 
        "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\:044f"}]\
}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"M", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dir", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "-", "p0prev"}], ")"}], ".", "#2"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"dir", ".", "#2"}], ")"}]}]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"P", "[", "\"\<norm\>\"", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"b1", "=", 
      RowBox[{"Positive", "[", 
       RowBox[{"M", ".", "dir"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"b2", "=", 
      RowBox[{"Positive", "[", 
       RowBox[{
        RowBox[{"dir", ".", "dir"}], "-", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Dot", ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:043d\:043e\:043c\:0435\:0440\:0430", " ", 
        "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}], ",",
        " ", 
       RowBox[{
        RowBox[{
        "\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:044e\:0449\:0438\
\:0445", " ", "p0prev"}], "-", 
        RowBox[{
        "p0cur", " ", "\:0438\:043b\:0438", " ", "\:0434\:043b\:044f", " ", 
         "\:043a\:043e\:0442\:043e\:0440\:044b\:0445", " ", 
         RowBox[{
         "\:043e\:0440\:0438\:0435\:043d\:0442", ".", " ", 
          "\:0440\:0430\:0441\:0441\:0442", ".", " ", "\:0434\:043e"}], " ", 
         "p0cur", " ", 
         "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\:043d\
\:043e"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"ind1", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"And", ",", 
              RowBox[{"{", 
               RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], ",", "True"}], 
           "]"}], ",", 
          RowBox[{"Position", "[", 
           RowBox[{"d", ",", 
            RowBox[{"_", "?", "Positive"}]}], "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0442\:043e\:0447\:043a\:0438", " ", 
       "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", " ", 
       "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", 
       "\:0441\:0444\:0435\:0440\:044b", " ", "\:0438", " ", 
       "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\:0442\:0438\:043f", " ", "1"}], ":", " ", 
         RowBox[{
         "\:0441\:0444\:0435\:0440\:0430", "-", 
          "\:0433\:0440\:0430\:043d\:044c"}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"p1", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"p0prev", "+", 
          RowBox[{"dir", "*", 
           FractionBox[
            RowBox[{"r", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#1", "-", "p0prev"}], ")"}], ".", "#2"}]}], 
            RowBox[{"dir", ".", "#2"}]]}]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "ind1", "]"}], "]"}], ",", 
          RowBox[{"P", "[", 
           RowBox[{"\"\<norm\>\"", ",", "ind1"}], "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:043e\:0442\:0431\:0440\:043e\:0441\:0438\:043c", " ", 
        "\:0442\:043e\:0447\:043a\:0438"}], ",", " ", 
       RowBox[{
        RowBox[{
        "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", "\:043d\:0435", 
         " ", "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0442\:0441\:044f", 
         " ", "\:0432", " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0435", 
         " ", "p0prev"}], "-", "p0cur"}], ",", " ", 
       RowBox[{
       "\:0435\:0441\:043b\:0438", " ", "\:0442\:0430\:043a\:0438\:0435", " ",
         "\:0435\:0441\:0442\:044c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "p1"}], ">", "0"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{
        RowBox[{"mask1", "=", 
         RowBox[{"Boole", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"And", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NonNegative", "[", 
               RowBox[{
                RowBox[{"p1", ".", "dir"}], "-", 
                RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
              RowBox[{"NonNegative", "[", 
               RowBox[{
                RowBox[{"dir", ".", "dir"}], "-", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}]}], "&"}], ",", "p1"}],
                  "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"p1", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"p1", ",", "mask1", ",", "1"}], "]"}]}], ";", 
        RowBox[{"ind2", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"ind1", ",", "mask1", ",", "1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"checkit1", "=", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#2", "-", 
            RowBox[{"r", "*", 
             RowBox[{"P", "[", 
              RowBox[{"\"\<norm\>\"", ",", "#1"}], "]"}]}]}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"ind2", ",", "p1"}], "}"}]}], "]"}], ",", "chopaccuracy"}],
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:0432\:044b\:0431\:043e\:0440", " ", "\:0442\:0435\:0445", " ", 
        "\:0442\:043e\:0447\:0435\:043a", " ", "p1"}], ",", " ", 
       RowBox[{
       "\:043f\:0435\:0440\:043f\:0435\:043d\:0434\:0438\:043a\:0443\:043b\
\:044f\:0440", " ", "\:043e\:043f\:0443\:0449\:0435\:043d\:043d\:044b\:0439", 
        " ", "\:043d\:0430", " ", 
        RowBox[{
        "\:0441\:043e\:043e\:0442\:0432", ".", " ", 
         "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c"}], " ", 
        "\:043e\:0431\:0440\:0430\:0437\:0443\:0435\:0442", " ", 
        "\:0442\:043e\:0447\:043a\:0443", " ", 
        "\:043b\:0435\:0436\:0430\:0449\:0443\:044e", " ", "\:043d\:0430", 
        " ", "\:0433\:0440\:0430\:043d\:0438", " ", 
        "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"mask2", "=", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Boole", "@", 
         RowBox[{"Positive", "[", 
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"P", "[", "\"\<norm\>\"", "]"}], ".", "#"}], "-", 
                RowBox[{"MapThread", "[", 
                 RowBox[{"Dot", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"P", "[", "\"\<norm\>\"", "]"}], ",", "v"}], 
                   "}"}]}], "]"}]}], ")"}], "&"}], "/@", "checkit1"}], ",", 
            "chopaccuracy"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"p1", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"p1", ",", "mask2", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:043f\:043e\:0438\:0441\:043a", " ", "\:0442\:043e\:0447\:0435\:043a",
        " ", "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", 
       " ", "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", "\:0441", " ", 
       "\:0432\:0435\:0440\:0448\:0438\:043d\:0430\:043c\:0438"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"checkit2", "=", " ", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"P", "[", 
         RowBox[{"\"\<faces\>\"", ",", "ind2"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"T", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"dir", ".", "dir"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "p0prev"}], ")"}], ".", "dir"}], "-", " ", 
             RowBox[{"N", "@", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", "dir"}], ")"}], 
                 "2"], "-", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"dir", ".", "dir"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}]}], "-", 
                   SuperscriptBox["r", "2"]}], ")"}]}]}]]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"dir", ".", "dir"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "p0prev"}], ")"}], ".", "dir"}], "+", " ", 
             RowBox[{"N", "@", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", "dir"}], ")"}], 
                 "2"], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"dir", ".", "dir"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}]}], "-", 
                   SuperscriptBox["r", "2"]}], ")"}]}]}]]}]}], ")"}]}]}], 
         "}"}], "&"}], "/@", 
       RowBox[{"P", "[", 
        RowBox[{"\"\<coord\>\"", ",", "checkit2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"mask3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Boole", "@", 
         RowBox[{"Internal`RealValuedNumericQ", "[", 
          RowBox[{"First", "@", "#"}], "]"}]}], "&"}], "/@", "T"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"T", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"T", ",", "mask3", ",", "1"}], "]"}]}], ";", " ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"Min", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0442\:043e\:0447\:043a\:0438", " ", 
       "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", " ", 
       "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", 
       "\:0441\:0444\:0435\:0440\:044b", " ", "\:0438", " ", 
       "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\:0442\:0438\:043f", " ", "2"}], ":", " ", 
         RowBox[{
         "\:0441\:0444\:0435\:0440\:0430", "-", 
          "\:0432\:0435\:0440\:0448\:0438\:043d\:0430"}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"p2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"p0prev", "+", 
         RowBox[{"#", "*", "dir"}]}], "&"}], "/@", "T"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:043e\:0442\:0431\:0440\:043e\:0441\:0438\:043c", " ", 
        "\:0442\:043e\:0447\:043a\:0438"}], ",", " ", 
       RowBox[{
        RowBox[{
        "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", "\:043d\:0435", 
         " ", "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0442\:0441\:044f", 
         " ", "\:0432", " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0435", 
         " ", "p0prev"}], "-", "p0cur"}], ",", " ", 
       RowBox[{
       "\:0435\:0441\:043b\:0438", " ", "\:0442\:0430\:043a\:0438\:0435", " ",
         "\:0435\:0441\:0442\:044c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "p2"}], ">", "0"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{
        RowBox[{"mask4", "=", 
         RowBox[{"Boole", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"And", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NonNegative", "[", 
               RowBox[{
                RowBox[{"p2", ".", "dir"}], "-", 
                RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
              RowBox[{"NonNegative", "[", 
               RowBox[{
                RowBox[{"dir", ".", "dir"}], "-", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}]}], "&"}], ",", "p2"}],
                  "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"p2", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"p2", ",", "mask4", ",", "1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:043f\:043e\:0438\:0441\:043a", " ", "\:0442\:043e\:0447\:0435\:043a",
        " ", "p3", " ", 
       "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", " ", 
       "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", "\:0441", " ", 
       RowBox[{
       "\:0440\:0435\:0431\:0440\:0430\:043c\:0438", ".", " ", 
        "\:0424\:043e\:0440\:043c\:0438\:0440\:043e\:0432\:0430\:043d\:0438\
\:0435"}], " ", "\:0440\:0435\:0431\:0435\:0440", " ", "\:0438", " ", 
       "\:043f\:0435\:0440\:0435\:043d\:043e\:0441", " ", "\:043a", " ", 
       "\:043d\:0430\:0447\:0430\:043b\:0443", " ", 
       "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"vv", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{"List", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Most", "@", 
             RowBox[{"P", "[", 
              RowBox[{"\"\<coord\>\"", ",", "#"}], "]"}]}], ",", 
            RowBox[{"Rest", "@", 
             RowBox[{"P", "[", 
              RowBox[{"\"\<coord\>\"", ",", "#"}], "]"}]}]}], "}"}]}], "]"}], 
        "&"}], "/@", 
       RowBox[{"P", "[", 
        RowBox[{"\"\<faces\>\"", ",", "ind1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"shift", ",", "vvshifted"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"First", ",", "#"}], "]"}], "&"}], "/@", "vv"}], ",", 
          "1"}], "]"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", "#"}], "]"}], "&"}], "/@", "vv"}], ",", 
          "1"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"vvshifted", "=", 
      RowBox[{"vvshifted", "-", "shift"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"p3", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:043a\:0430\:0436\:0434\:043e\:0435", " ", 
         "\:0440\:0435\:0431\:0440\:043e", " ", 
         "\:043f\:043e\:0432\:043e\:0440\:0430\:0447\:0438\:0432\:0430\:0435\
\:043c", " ", "\:0442\:0430\:043a"}], ",", " ", 
        RowBox[{
        "\:0447\:0442\:043e\:0431\:044b", " ", "\:043e\:043d\:043e", " ", 
         "\:043b\:0435\:0436\:0430\:043b\:043e", " ", "\:043d\:0430", " ", 
         "\:043e\:0441\:0438", " ", "z"}], ",", " ", 
        RowBox[{
         RowBox[{
         "\:043d\:0430", " ", "\:0442\:0435", " ", "\:0436\:0435", " ", 
          "\:0443\:0433\:043b\:044b", " ", 
          "\:043f\:043e\:0432\:043e\:0440\:0430\:0447\:0438\:0432\:0430\:0435\
\:043c", " ", "\:0438", "\[IndentingNewLine]", "\t\t", 
          "\:0442\:043e\:0447\:043a\:0443", " ", "p0prev", " ", "\:0438", " ", 
          RowBox[{
          "\:043d\:0430\:043f\:0440\:0430\:0432\:043b", ".", " ", 
           "\:0432\:0435\:043a\:0442\:043e\:0440"}], " ", "p0cur"}], "-", 
         "p0prev"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"p0prev1", "=", 
         RowBox[{"p0prev", "-", 
          RowBox[{"shift", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vvshifted", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", " ", "0"}],
           ",", 
          RowBox[{"\[Alpha]x", "=", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Pi", "/", "2"}], "+", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"vvshifted", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "/", 
               RowBox[{"vvshifted", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
          ",", " ", 
          RowBox[{"\[Alpha]x", "=", "0"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Mx", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Cos", "[", "\[Alpha]x", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Alpha]x", "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Sin", "[", "\[Alpha]x", "]"}], ",", 
             RowBox[{"Cos", "[", "\[Alpha]x", "]"}]}], "}"}]}], "}"}]}], ";", 
        "\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"v0", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"vvshifted", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", "Mx"}], ",", 
           "chopaccuracy"}], "]"}]}], ";", " ", 
        RowBox[{"dir1", "=", " ", 
         RowBox[{"Chop", "[", 
          RowBox[{"dir", ".", "Mx"}], "]"}]}], ";", " ", 
        RowBox[{"p0prev1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"p0prev1", ".", "Mx"}], ",", "chopaccuracy"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"v0", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], ",", 
          RowBox[{"\[Alpha]y", "=", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Pi", "/", "2"}], "-", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"v0", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "/", 
               RowBox[{"v0", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", " ", 
          RowBox[{"\[Alpha]y", "=", "0"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"My", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]y", "]"}], ",", "0", ",", 
             RowBox[{"Sin", "[", "\[Alpha]y", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Alpha]y", "]"}]}], ",", "0", ",", 
             RowBox[{"Cos", "[", "\[Alpha]y", "]"}]}], "}"}]}], "}"}]}], ";", 
        "\t", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"v0", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"v0", ".", "My"}], ",", "chopaccuracy"}], "]"}]}], ";", 
        RowBox[{"dir1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"dir1", ".", "My"}], "]"}]}], ";", " ", 
        RowBox[{"p0prev1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"p0prev1", ".", "My"}], ",", "chopaccuracy"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\:0432\:0430\
\:0435\:043c", " ", "\:0440\:0435\:0431\:0440\:043e", " ", 
           "\:043a\:0430\:043a", " ", 
           "\:0431\:0435\:0441\:043a\:043e\:043d\:0435\:0447\:043d\:044b\:0439\
", " ", "\:0446\:0438\:043b\:0438\:043d\:0434\:0440", " ", 
           "\:0440\:0430\:0434\:0438\:0443\:0441\:0430", " ", "r"}], ",", " ", 
          RowBox[{
           RowBox[{
           "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
            "\:0442\:043e\:0447\:043a\:0443", " ", "pnew", " ", 
            "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:044f", "\[IndentingNewLine]", "\t\t", 
            "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\:0432\
\:0430\:043d\:043d\:043e\:0433\:043e", " ", 
            "\:043f\:043e\:0432\:043e\:0440\:043e\:0442\:0430\:043c\:0438", 
            " ", "\:0438", " ", 
            "\:043f\:0435\:0440\:0435\:043d\:043e\:0441\:0430\:043c\:0438", 
            " ", "\:043b\:0443\:0447\:0430", " ", "\:0438\:0437", " ", 
            "p0prev"}], " ", "+", " ", 
           RowBox[{"t", "*", "dir", " ", "\:0438", " ", 
            RowBox[{
            "\:0446\:0438\:043b\:0438\:043d\:0434\:0440\:0430", ".", " ", 
             "\:0415\:0441\:043b\:0438"}], " ", "\:043e\:043d\:0438", " ", 
            "\:043d\:0435", "\[IndentingNewLine]", "\t\t", 
            "\:043a\:0430\:044e\:0442\:0441\:044f"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "\:0442\:043e", " ", 
            "\:043f\:0430\:0440\:0430\:043c\:0435\:0442\:0440", " ", "t"}], 
           " ", "-", " ", 
           RowBox[{
           "\:043a\:043e\:043c\:043f\:043b\:0435\:043a\:0441\:043d\:044b\:0439\
", " ", "\:0438", " ", "\:043d\:0435", " ", 
            RowBox[{
            "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\:0432\
\:0430\:0435\:0442\:0441\:044f", ".", " ", "\:0415\:0441\:043b\:0438"}], " ", 
            "\:0442\:043e\:0447\:043a\:0430", " ", 
            "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:044f", " ", "\:043e\:0434\:043d\:0430"}], " ", "-", " ", 
           RowBox[{
           "\:0442\:043e", "\[IndentingNewLine]", "\t\t", 
            "\:043e\:0431\:0430", " ", "\:043a\:043e\:0440\:043d\:044f", " ", 
            "t1"}]}], ",", 
          RowBox[{
          "t2", " ", 
           "\:0441\:043e\:0432\:043f\:0430\:0434\:0430\:044e\:0442"}], ",", 
          " ", 
          RowBox[{
          "\:0435\:0441\:043b\:0438", " ", "\:0442\:043e\:0447\:043a\:0438", 
           " ", "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:044f", " ", "\:0434\:0432\:0435"}], ",", " ", 
          RowBox[{
          "\:0442\:043e", " ", 
           "\:0432\:044b\:0431\:0438\:0440\:0430\:0435\:043c", " ", 
           "\:043d\:0430\:0438\:043c\:0435\:043d\:044c\:0448\:0438\:0439", 
           " ", "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\
\:043d\:044b\:0439", "\[IndentingNewLine]", "\t\t ", 
           RowBox[{
           "\:043a\:043e\:0440\:0435\:043d\:044c", ".", " ", 
            "\:0422\:0430\:043a\:0436\:0435"}], " ", 
           "\:0443\:0431\:0438\:0440\:0430\:0435\:043c", " ", "\:0438\:0437", 
           " ", "\:0440\:0430\:0441\:0441\:043c\:043e\:0442\:0440\:0435\:043d\
\:0438\:044f", " ", "\:0442\:0435", " ", "\:0442\:043e\:0447\:043a\:0438", 
           " ", "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:044f"}], ",", " ", 
          RowBox[{
          "\:0447\:0442\:043e", " ", "\:043b\:0435\:0436\:0430\:0442", " ", 
           "\:043d\:0430", " ", 
           "\:043f\:0440\:043e\:0434\:043e\:043b\:0436\:0435\:043d\:0438\:0438\
", " ", "\:0446\:0438\:043b\:0438\:043d\:0434\:0440\:0430"}]}], "   ", "*)"}],
         "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x0", ",", "y0"}], "}"}], "=", 
         RowBox[{"Most", "@", "p0prev1"}]}], ";", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], "=", 
         RowBox[{"Most", "@", "dir1"}]}], ";", " ", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"T", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                RowBox[{"x0", " ", "x1"}], "+", 
                RowBox[{"y0", " ", "y1"}], "+", 
                RowBox[{"N", "@", 
                 SqrtBox[
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x1", " ", "y0"}], "-", 
                    RowBox[{"x0", " ", "y1"}]}], ")"}], "2"]}], "+", 
                   RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x1", "2"], "+", 
                    SuperscriptBox["y1", "2"]}], ")"}]}]}]]}]}], 
               RowBox[{
                SuperscriptBox["x1", "2"], "+", 
                SuperscriptBox["y1", "2"]}]]}], ",", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "x0"}], " ", "x1"}], "-", 
               RowBox[{"y0", " ", "y1"}], "+", 
               RowBox[{"N", "@", 
                SqrtBox[
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x1", " ", "y0"}], "-", 
                    RowBox[{"x0", " ", "y1"}]}], ")"}], "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["r", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x1", "2"], "+", 
                    SuperscriptBox["y1", "2"]}], ")"}]}]}]]}]}], 
              RowBox[{
               SuperscriptBox["x1", "2"], "+", 
               SuperscriptBox["y1", "2"]}]]}], "}"}], ",", "chopaccuracy"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Internal`RealValuedNumericQ", "[", "#", "]"}], "&"}], "/@",
              "T"}], ")"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", "T", "]"}], "\[GreaterEqual]", " ", "0"}], 
             ",", "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{
              RowBox[{"pnew", " ", "=", " ", 
               RowBox[{"p0prev1", "+", 
                RowBox[{
                 RowBox[{"Min", "[", "T", "]"}], "*", "dir1"}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Between", "[", 
                 RowBox[{
                  RowBox[{"Last", "@", "pnew"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Last", "@", "v0"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"IMx", "=", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}], "}"}]}], "}"}]}], 
                 ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                 RowBox[{"IMy", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}], ",", "0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], ",", "0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}]}], "}"}]}], 
                 ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"p3", ",", 
                   RowBox[{
                    RowBox[{"pnew", ".", "IMy", ".", "IMx"}], "+", 
                    RowBox[{"shift", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], 
               "\[IndentingNewLine]", "\t\t\t\t\t", "]"}], ";"}], 
             "\[IndentingNewLine]", "\t\t\t\t", ",", "\[IndentingNewLine]", 
             "\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Max", "[", "T", "]"}], "\[GreaterEqual]", " ", 
                 "0"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"pnew", " ", "=", " ", 
                  RowBox[{"p0prev1", "+", 
                   RowBox[{
                    RowBox[{"Max", "[", "T", "]"}], "*", "dir1"}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"Between", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "pnew"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Last", "@", "v0"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"IMx", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}], "}"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{"IMy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}], ",", "0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], ",", "0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"p3", ",", 
                    RowBox[{
                    RowBox[{"pnew", ".", "IMy", ".", "IMx"}], "+", 
                    RowBox[{"shift", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", "\t\t\t\t\t", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "\t\t\t\t", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}]}], "\t\t\t", 
         "\[IndentingNewLine]", "\t\t", "]"}], ";"}], "\[IndentingNewLine]", 
       "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "vvshifted"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:043e\:0442\:0431\:0440\:043e\:0441\:0438\:043c", " ", 
        "\:0442\:043e\:0447\:043a\:0438"}], ",", " ", 
       RowBox[{
        RowBox[{
        "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", "\:043d\:0435", 
         " ", "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0442\:0441\:044f", 
         " ", "\:0432", " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0435", 
         " ", "p0prev"}], "-", "p0cur"}], ",", " ", 
       RowBox[{
       "\:0435\:0441\:043b\:0438", " ", "\:0442\:0430\:043a\:0438\:0435", " ",
         "\:0435\:0441\:0442\:044c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "p3"}], ">", "0"}], ",", "\[IndentingNewLine]",
        "\t\t", 
       RowBox[{
        RowBox[{"mask5", "=", 
         RowBox[{"Boole", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"And", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NonNegative", "[", 
               RowBox[{
                RowBox[{"p3", ".", "dir"}], "-", 
                RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
              RowBox[{"NonNegative", "[", 
               RowBox[{
                RowBox[{"dir", ".", "dir"}], "-", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}]}], "&"}], ",", "p3"}],
                  "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"p3", "=", 
         RowBox[{"Pick", "[", 
          RowBox[{"p3", ",", "mask5", ",", "1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "res"}], "\[Equal]", "0"}], ",", 
       RowBox[{"res", "=", "p0cur"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Nearest", "[", 
          RowBox[{"res", ",", "p0prev"}], "]"}]}]}]}], "]"}], ";", "\t\t", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.830847343252367*^9, 3.8308473570754795`*^9}, {
   3.830848941119194*^9, 3.830848990267273*^9}, {3.8308490636028976`*^9, 
   3.830849111414857*^9}, {3.8308491993312945`*^9, 3.83084922954816*^9}, {
   3.830849385838436*^9, 3.830849398716922*^9}, {3.8308495088954897`*^9, 
   3.830849533715577*^9}, {3.8308501128434696`*^9, 3.830850290856732*^9}, {
   3.830850363602849*^9, 3.830850424683977*^9}, {3.830850470505926*^9, 
   3.8308504709234967`*^9}, 3.8308506347671695`*^9, {3.8308506736296473`*^9, 
   3.8308506765062084`*^9}, {3.830850855692814*^9, 3.830850860788499*^9}, {
   3.8308509347898426`*^9, 3.8308509375372868`*^9}, {3.830851023732812*^9, 
   3.8308510464047627`*^9}, {3.8308514496734476`*^9, 3.830851452731933*^9}, {
   3.830851553374113*^9, 3.830851559203557*^9}, {3.830852341426235*^9, 
   3.830852455075553*^9}, {3.8308524965434475`*^9, 3.830852521510618*^9}, {
   3.830852768257403*^9, 3.8308527926791935`*^9}, {3.8308528604280095`*^9, 
   3.8308529035138283`*^9}, {3.8308531741693177`*^9, 3.83085318315727*^9}, {
   3.8308532487928014`*^9, 3.8308532490232034`*^9}, {3.830853490024843*^9, 
   3.8308534910311623`*^9}, {3.8308536083774033`*^9, 3.830853652511422*^9}, {
   3.830853838767424*^9, 3.830853841064285*^9}, {3.8308539024770885`*^9, 
   3.8308541111461487`*^9}, {3.830854231178228*^9, 3.8308542339135804`*^9}, {
   3.8308542774492273`*^9, 3.830854290929207*^9}, {3.8309032855886335`*^9, 
   3.830903460259736*^9}, {3.830903579531875*^9, 3.8309035830574455`*^9}, {
   3.8309041029465113`*^9, 3.8309041515555534`*^9}, {3.830904217773509*^9, 
   3.8309042888544636`*^9}, {3.830906547265769*^9, 3.830906551825571*^9}, {
   3.830906972533328*^9, 3.8309069889524283`*^9}, {3.8309078196053042`*^9, 
   3.8309079527066317`*^9}, {3.830908250468725*^9, 3.83090825205814*^9}, {
   3.83090863772501*^9, 3.8309086514921703`*^9}, {3.8309087185658693`*^9, 
   3.830908728658887*^9}, {3.8309088980106926`*^9, 3.830908971264903*^9}, {
   3.8309216673469815`*^9, 3.8309217122845917`*^9}, {3.8309222142600183`*^9, 
   3.8309222470030937`*^9}, {3.8309224296213284`*^9, 
   3.8309224476282682`*^9}, {3.830929199555746*^9, 3.8309292202364483`*^9}, {
   3.8309293107235117`*^9, 3.8309293248168373`*^9}, {3.830929429453082*^9, 
   3.8309294520686197`*^9}, {3.8309296084285774`*^9, 3.830929784908947*^9}, {
   3.8309299077107487`*^9, 3.8309299372288427`*^9}, {3.830929977815344*^9, 
   3.830930020220942*^9}, {3.8309301400994577`*^9, 3.830930256733009*^9}, {
   3.8309302923337975`*^9, 3.830930419471244*^9}, {3.8309304687574987`*^9, 
   3.8309305637226973`*^9}, {3.830930598432914*^9, 3.830930701866776*^9}, {
   3.830930741332281*^9, 3.830930763246666*^9}, {3.8309308123573647`*^9, 
   3.8309308218070707`*^9}, {3.830930855340478*^9, 3.8309308991423655`*^9}, {
   3.8309309298204193`*^9, 3.8309310545111027`*^9}, {3.830931085971325*^9, 
   3.83093117880235*^9}, {3.830931217503978*^9, 3.830931240258239*^9}, {
   3.830931281233655*^9, 3.830931322406029*^9}, {3.830931367927304*^9, 
   3.8309313837590065`*^9}, {3.830931419183298*^9, 3.8309314249827847`*^9}, {
   3.830931493579777*^9, 3.830931546570397*^9}, {3.8309318860602837`*^9, 
   3.8309318975954423`*^9}, 3.8309321820568867`*^9, {3.830932497208372*^9, 
   3.8309325297813067`*^9}, {3.8309408736034365`*^9, 3.8309409281003*^9}, {
   3.8309409703453803`*^9, 3.8309409817793393`*^9}, {3.830941615306063*^9, 
   3.830941627362638*^9}, {3.830941657578452*^9, 3.8309416586505527`*^9}, 
   3.831006227321066*^9, {3.831006278309742*^9, 3.831006293219884*^9}, {
   3.8310066669592733`*^9, 3.8310068977661386`*^9}, {3.831006928650744*^9, 
   3.831006934342557*^9}, {3.831006968680749*^9, 3.831006988286331*^9}, {
   3.8310077163128357`*^9, 3.8310078770392213`*^9}, {3.831007915692875*^9, 
   3.8310080336545177`*^9}, {3.83100822778564*^9, 3.8310083142890034`*^9}, {
   3.8310083557356167`*^9, 3.8310083597109423`*^9}, {3.831008390465331*^9, 
   3.8310084704886017`*^9}, {3.8310085014499636`*^9, 3.831008557783385*^9}, {
   3.831008784046412*^9, 3.8310088519239187`*^9}, {3.8310088974024415`*^9, 
   3.8310089581895895`*^9}, {3.8310090019623466`*^9, 
   3.8310091814808826`*^9}, {3.8310092396102057`*^9, 3.831009256719689*^9}, {
   3.831009648241975*^9, 3.8310096828784175`*^9}, {3.8310097526883917`*^9, 
   3.83100979975926*^9}, {3.831009891906352*^9, 3.8310099384901867`*^9}, {
   3.8310100405313115`*^9, 3.831010072368141*^9}, {3.83101026709746*^9, 
   3.831010284539856*^9}, {3.831010376123963*^9, 3.8310103927654986`*^9}, {
   3.831010529423864*^9, 3.8310105421817293`*^9}, {3.831010614121915*^9, 
   3.8310106614415727`*^9}, {3.8310107563614445`*^9, 
   3.8310107618078537`*^9}, {3.8310110437941504`*^9, 
   3.8310110927811728`*^9}, {3.8310112986746635`*^9, 
   3.8310113700040507`*^9}, {3.8310116175631633`*^9, 
   3.8310116717293167`*^9}, {3.8310117941239104`*^9, 
   3.8310118062508063`*^9}, {3.8310137828807063`*^9, 
   3.8310139214262676`*^9}, {3.831013990893008*^9, 3.8310140481329412`*^9}, {
   3.831014574132628*^9, 3.831014575465784*^9}, {3.831031582805649*^9, 
   3.8310316062403946`*^9}, {3.831031694753084*^9, 3.831031707576812*^9}, {
   3.8310317565023575`*^9, 3.8310317675080724`*^9}, {3.831031800762065*^9, 
   3.8310318876241145`*^9}, {3.8310319178129387`*^9, 
   3.8310319476209993`*^9}, {3.831032042765154*^9, 3.831032053455428*^9}, {
   3.8310321568104334`*^9, 3.8310322611087523`*^9}, {3.831032316012421*^9, 
   3.8310324203809605`*^9}, {3.8310326896071167`*^9, 
   3.8310327023565087`*^9}, {3.831032866778574*^9, 3.831032867582565*^9}, {
   3.8310401259540424`*^9, 3.8310403118770056`*^9}, {3.831040353301254*^9, 
   3.8310403662376947`*^9}, {3.831040421292471*^9, 3.8310405063892283`*^9}, {
   3.831040641696468*^9, 3.8310408086615005`*^9}, {3.8310408596342616`*^9, 
   3.831040887695238*^9}, {3.8310409241751175`*^9, 3.831040943649051*^9}, {
   3.831041037854182*^9, 3.8310411542054625`*^9}, {3.8310411867783747`*^9, 
   3.8310411960057044`*^9}, {3.8310412738196573`*^9, 3.831041281678857*^9}, {
   3.831041312359825*^9, 3.8310416061078777`*^9}, {3.831041717303687*^9, 
   3.8310418854546413`*^9}, {3.831041948839175*^9, 3.8310419945000954`*^9}, {
   3.831042041951227*^9, 3.8310420854452696`*^9}, 3.8310421185038843`*^9, {
   3.8310421707183332`*^9, 3.8310421729533277`*^9}, {3.83104226777816*^9, 
   3.831042271857254*^9}, {3.8310423057506347`*^9, 3.8310423123559732`*^9}, {
   3.831042363208014*^9, 3.831042373150432*^9}, {3.831042582807884*^9, 
   3.83104266624644*^9}, {3.8310426969126577`*^9, 3.831042715867028*^9}, {
   3.831042782682391*^9, 3.831042870713292*^9}, {3.8310429018461266`*^9, 
   3.83104292585391*^9}, {3.831042966920114*^9, 3.83104299975732*^9}, {
   3.8310430461424303`*^9, 3.8310430943974996`*^9}, {3.8310520766548433`*^9, 
   3.831052210882392*^9}, {3.83105225404499*^9, 3.8310522552427874`*^9}, {
   3.8310522939523396`*^9, 3.83105231317694*^9}, {3.8310528153056087`*^9, 
   3.8310528769567766`*^9}, {3.8310529726166058`*^9, 3.831052976722967*^9}, {
   3.831053127341714*^9, 3.8310531701704826`*^9}, {3.8310533064016733`*^9, 
   3.8310533812340097`*^9}, {3.8310534165073223`*^9, 3.831053421690955*^9}, {
   3.8310535047015123`*^9, 3.831053545213643*^9}, {3.8310536552713127`*^9, 
   3.831053734998783*^9}, {3.83105388222549*^9, 3.831053923637126*^9}, {
   3.831054313515563*^9, 3.831054317069386*^9}, {3.831054425034957*^9, 
   3.8310544389949465`*^9}, {3.831054524397029*^9, 3.831054609883337*^9}, {
   3.83105464829933*^9, 3.8310546726810493`*^9}, {3.8310549296702766`*^9, 
   3.8310550108306913`*^9}, {3.831055110277841*^9, 3.8310551254423256`*^9}, {
   3.8310552584023266`*^9, 3.831055310315529*^9}, {3.831055367483116*^9, 
   3.8310553676197767`*^9}, 3.831055654514291*^9, {3.8310565224850492`*^9, 
   3.831056529863116*^9}, {3.831057073289925*^9, 3.831057104495039*^9}, {
   3.8310571393007593`*^9, 3.831057139477288*^9}, {3.8310573971355495`*^9, 
   3.8310574199245143`*^9}, {3.831057721104856*^9, 3.8310577270942116`*^9}, {
   3.8310578806181507`*^9, 3.8310578852698455`*^9}, {3.831058130939884*^9, 
   3.8310581692255898`*^9}, {3.8310652747198095`*^9, 3.831065291164997*^9}, {
   3.831065354405897*^9, 3.8310653867081013`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"7ed9ee63-c043-4a50-91c2-0811406c3512"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pp0prev", "=", 
    RowBox[{"{", 
     RowBox[{"15", ",", "2", ",", 
      RowBox[{"-", "11"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PolyhedronShow", "[", 
    RowBox[{
     RowBox[{"{", "P2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Blue", ",", 
       RowBox[{"Point", "@", "pp0prev"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"pp0prev", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], "]"}], ",", 
       "Red", ",", 
       RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
       RowBox[{"Sphere", "[", 
        RowBox[{
         RowBox[{"ProjectileSphereCollide3DConvPolyhedron", "[", 
          RowBox[{"pp0prev", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "rr", ",", "P2", 
           ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "6"}]}]}], "]"}], ",", "rr"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", "Brown", ",", 
       RowBox[{"Point", "@", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "0.2"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "0.2"}]}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "0.2"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rr", ",", "1"}], "}"}], ",", "0.1", ",", "4", ",", "0.1"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzdV1v0Op+41jm3zNVBDt58YxC0QvPfEATF9s91wA
oqenPQXTVzJcV4DoF6WxK0F0zcXezSCaP/3BThDdcO/FARD9lEH+MIhu2pFz
AkRbeSw+CaK3hKy/A6JVjrwE02dM1B+CaNvze5+A6PczC1+CaMUvH1+B6Jz2
8y0aQHpFQn4biGbtn/MCROe/Of0aRH/5UCOqCaSjRTrA9IxNJb0g+mXcaTAd
PeHpLC0gzTRv/hIQHaFQdw5E2z3hOA+izf/63gPRS//PAtOrWQ5+1AHSPF7f
f4FoPsU2ZV0g7fDfUw1EK50t+34BFE7Ks8E0ANMgp04=
  "],
 CellLabel->"In[19]:=",ExpressionUUID->"8871d665-44fa-414e-a557-c6e57a18dc3f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`rr$$ = 
    1.3000000000000003`, $CellContext`x$$ = -2.5, $CellContext`y$$ = 
    15., $CellContext`z$$ = -1.6999999999999993`, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], 0.2}, -15, 15, 0.1}, {{
       Hold[$CellContext`y$$], -0.2}, -15, 15, 0.1}, {{
       Hold[$CellContext`z$$], 0.2}, -15, 15, 0.1}, {{
       Hold[$CellContext`rr$$], 1}, 0.1, 4, 0.1}}, Typeset`size$$ = {
    360., {140., 146.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x$3233$$ = 
    0, $CellContext`y$3234$$ = 0, $CellContext`z$3235$$ = 
    0, $CellContext`rr$3236$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`rr$$ = 1, $CellContext`x$$ = 
        0.2, $CellContext`y$$ = -0.2, $CellContext`z$$ = 0.2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$3233$$, 0], 
        Hold[$CellContext`y$$, $CellContext`y$3234$$, 0], 
        Hold[$CellContext`z$$, $CellContext`z$3235$$, 0], 
        Hold[$CellContext`rr$$, $CellContext`rr$3236$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`PolyhedronShow[{$CellContext`P2}, {Blue, 
         Point[$CellContext`pp0prev], 
         Line[{$CellContext`pp0prev, {$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}}], Red, 
         Opacity[0.4], 
         Sphere[
          $CellContext`ProjectileSphereCollide3DConvPolyhedron[$CellContext`\
pp0prev, {$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`rr$$, $CellContext`P2, 10^(-6)], $CellContext`rr$$], 
         Opacity[1], Brown, 
         Point[{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}]}], 
      "Specifications" :> {{{$CellContext`x$$, 0.2}, -15, 15, 
         0.1}, {{$CellContext`y$$, -0.2}, -15, 15, 
         0.1}, {{$CellContext`z$$, 0.2}, -15, 15, 
         0.1}, {{$CellContext`rr$$, 1}, 0.1, 4, 0.1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{411., {229., 235.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.83105601710834*^9, 3.831056224392579*^9, 3.8310565573408766`*^9, {
   3.8310565900596175`*^9, 3.8310565918599963`*^9}, 3.8310575287529964`*^9, 
   3.831057734651774*^9, 3.831057807983819*^9, 3.8310579027777443`*^9, 
   3.831058194226325*^9, 3.8310596738307543`*^9, 3.831059751390967*^9, {
   3.8310597990041113`*^9, 3.831059800105685*^9}, 3.8310600891215987`*^9, 
   3.8310602136984215`*^9, 3.8310644823016243`*^9, {3.831064526125454*^9, 
   3.8310645363142138`*^9}, 3.8310648398419185`*^9, 3.831064894572616*^9, 
   3.831065392640414*^9, 3.8312784363937397`*^9, 3.831388461195525*^9, 
   3.831400381391603*^9, 3.8314004528747444`*^9, 3.8315378726889505`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"87331de1-5c24-40aa-a372-8ebfea82f75c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp0prev", "=", 
   RowBox[{"{", 
    RowBox[{"18", ",", "2", ",", 
     RowBox[{"-", "11"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PolyhedronShow", "[", 
        RowBox[{
         RowBox[{"{", "P2", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"Point", "@", "pp0prev"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"pp0prev", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], "]"}], ",", 
           "Red", ",", 
           RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "rr"}], "]"}], 
           ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"P2", "[", "\"\<bbspherecenter\>\"", "]"}], ",", 
             RowBox[{"P2", "[", "\"\<bbsphereradius\>\"", "]"}]}], "]"}], ",", 
           RowBox[{"Opacity", "[", "1", "]"}], ",", "Brown", ",", 
           RowBox[{"Point", "@", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"ProjectileSphereCollisionQ3DBoundingSphere", "[", 
        RowBox[{"pp0prev", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "rr", ",", "P2"}], 
        "]"}]}], "}"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "0.2"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "0.2"}]}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "0.2"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rr", ",", "1"}], "}"}], ",", "0.1", ",", "4", ",", "0.1"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831064071683191*^9, 3.831064221281378*^9}, {
   3.8310642514457006`*^9, 3.831064286037216*^9}, {3.8310645526375737`*^9, 
   3.8310646209729643`*^9}, {3.8310649040935507`*^9, 3.8310649508066516`*^9}, 
   3.8313972500585318`*^9, {3.831400391392918*^9, 3.8314003925807524`*^9}, 
   3.8315498663053713`*^9, {3.831550300366975*^9, 
   3.8315503060170927`*^9}},ExpressionUUID->"2936e2d5-15e7-40b0-83c9-\
94aa03a1fd1f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`rr$$ = 2.1, $CellContext`x$$ = 
    15., $CellContext`y$$ = 10.400000000000002`, $CellContext`z$$ = -10.2, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x$$], 0.2}, -15, 15, 0.1}, {{
       Hold[$CellContext`y$$], -0.2}, -15, 15, 0.1}, {{
       Hold[$CellContext`z$$], 0.2}, -15, 15, 0.1}, {{
       Hold[$CellContext`rr$$], 1}, 0.1, 4, 0.1}}, Typeset`size$$ = {
    404., {193.5, 199.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x$3293$$ = 
    0, $CellContext`y$3294$$ = 0, $CellContext`z$3295$$ = 
    0, $CellContext`rr$3296$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`rr$$ = 1, $CellContext`x$$ = 
        0.2, $CellContext`y$$ = -0.2, $CellContext`z$$ = 0.2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$3293$$, 0], 
        Hold[$CellContext`y$$, $CellContext`y$3294$$, 0], 
        Hold[$CellContext`z$$, $CellContext`z$3295$$, 0], 
        Hold[$CellContext`rr$$, $CellContext`rr$3296$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Grid[{{
          $CellContext`PolyhedronShow[{$CellContext`P2}, {Blue, 
            Point[$CellContext`pp0prev], 
            
            Line[{$CellContext`pp0prev, {$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}}], Red, 
            Opacity[0.4], 
            
            Sphere[{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`rr$$], 
            Sphere[
             $CellContext`P2["bbspherecenter"], 
             $CellContext`P2["bbsphereradius"]], 
            Opacity[1], Brown, 
            Point[{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}]}], 
          $CellContext`ProjectileSphereCollisionQ3DBoundingSphere[$\
CellContext`pp0prev, {$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`rr$$, $CellContext`P2]}}], 
      "Specifications" :> {{{$CellContext`x$$, 0.2}, -15, 15, 
         0.1}, {{$CellContext`y$$, -0.2}, -15, 15, 
         0.1}, {{$CellContext`z$$, 0.2}, -15, 15, 
         0.1}, {{$CellContext`rr$$, 1}, 0.1, 4, 0.1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{455., {283., 289.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.831064188555781*^9, 3.8310642223634567`*^9, 3.831064287629987*^9, 
   3.831064622710325*^9, 3.8310648399626226`*^9, 3.8310649529798403`*^9, 
   3.8312784365772524`*^9, {3.831289190670097*^9, 3.8312891923984513`*^9}, 
   3.8313884613161726`*^9, 3.8313972507527037`*^9, 3.8314003930620136`*^9, 
   3.8314004530193586`*^9, 3.831537872823589*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"5fd7cb0f-4b3b-40a4-9689-4128628ad0df"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"NextVertexAndMinSubsimplex", "[", 
   RowBox[{"Y_", ",", 
    RowBox[{"chopaccuracy_:", 
     RowBox[{"10", "^", 
      RowBox[{"-", "6"}]}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "res", ",", "results", ",", "u", ",", "v", ",", "x0", ",", "a", ",", "b",
       ",", "c", ",", "p", ",", "A1", ",", "B1", ",", "C1", ",", "v1", ",", 
      "v2", ",", "v3", ",", "v4", ",", "AA", ",", "BB", ",", "CC", ",", "s", 
      ",", "n", ",", "nn", ",", "d", ",", "dddd", ",", "n1", ",", "n2", ",", 
      "n3", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "l"}], 
     "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "1"}], ":", " ", 
      RowBox[{
      "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
       "\:0435\:0441\:0442\:044c", " ", 
       "\:043f\:0443\:0441\:0442\:043e\:0435", " ", 
       "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:043e"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "Y"}], "\[Equal]", "0"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "2"}], ":", " ", 
       RowBox[{
       "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
        "\:0435\:0441\:0442\:044c", " ", "\:0442\:043e\:0447\:043a\:0430"}]}],
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "Y"}], "\[Equal]", "1"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "Y"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "3"}], ":", " ", 
       RowBox[{
       "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
        "\:0435\:0441\:0442\:044c", " ", 
        "\:043e\:0442\:0440\:0435\:0437\:043e\:043a"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "Y"}], "\[Equal]", "2"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"x0", " ", "=", " ", 
         RowBox[{
         "u", " ", "\:043c\:0438\:043d\:0443\:0441", " ", 
          "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044f", " ", 
          "\:0432\:0435\:043a\:0442\:043e\:0440\:0430", " ", "u", " ", 
          "\:043d\:0430", " ", "\:0432\:0435\:043a\:0442\:043e\:0440", " ", 
          "v"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"u", "=", 
         RowBox[{"Y", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"v", "=", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"Y", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"x0", "=", 
         RowBox[{"u", "-", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"u", ".", "v"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"v", ".", "v"}], ")"}]}], "*", "v"}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:0432\:0435\:043a\:0442\:043e\:0440", " ", "\:0441", " ", 
          "\:043c\:0435\:043d\:044c\:0448\:0438\:043c", " ", 
          "\:043c\:043e\:0434\:0443\:043b\:0435\:043c", " ", "\:0438\:0437", 
          " ", "Y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "\:043d\:0443", " ", "\:0438\:043b\:0438", " ", 
             "\:0442\:043e\:0447\:043a\:0430"}], ",", " ", 
            RowBox[{
            "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0430\:044f", " ", 
             "\:043a", " ", "\:0442\:043e\:0447\:043a\:0435", " ", 
             "\:043e\:0442\:0441\:0447\:0435\:0442\:0430"}]}], ")"}], " ", 
          "\[IndentingNewLine]", "\t\t", "\:0431\:0443\:0434\:0435\:0442", 
          " ", "\:043e\:0434\:043d\:043e\:0432\:0440\:0435\:043c\:0435\:043d\
\:043d\:043e", " ", "\:0438", " ", 
          "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0435\:0439", " ", 
          "\:0442\:043e\:0447\:043a\:043e\:0439", " ", "\:0438", " ", 
          RowBox[{
          "\:043c\:0438\:043d", ".", " ", 
           "\:043f\:043e\:0434\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441\
\:043e\:043c"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x0", "-", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"x0", "-", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "<", " ", "0"}], 
            ",", 
            RowBox[{
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{"x0", ",", "Y"}], "}"}]}], ";"}], ",", 
            RowBox[{
             RowBox[{"res", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
               RowBox[{"Min", "[", "Y", "]"}]}]}], ";"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x0", "-", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"x0", "-", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "<", " ", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"res", "=", 
            RowBox[{"{", 
             RowBox[{"x0", ",", "Y"}], "}"}]}], ";"}], ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Y", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ".", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "<", 
             RowBox[{
              RowBox[{"Y", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ".", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"res", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"{", "#", "}"}]}], "}"}], "&"}], "@", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
            RowBox[{"res", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"{", "#", "}"}]}], "}"}], "&"}], "@", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], "\[IndentingNewLine]",
       "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "4"}], ":", " ", 
       RowBox[{
       "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
        "\:0435\:0441\:0442\:044c", " ", 
        "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\:0438\:043a"}]\
}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "Y"}], "\[Equal]", "3"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "Y"}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "\:0441\:0442\:0440\:043e\:0438\:043c", " ", 
           "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c"}], ",", 
          " ", 
          RowBox[{
          "\:0432", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:0439", " ", 
           "\:043b\:0435\:0436\:0438\:0442", " ", 
           "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\:0438\:043a\
", " ", "abc", " ", "\:0438", " ", 
           "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
           "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044e", " ", 
           "\:043d\:0430", " ", "\:043d\:0435\:0435", " ", 
           "\[IndentingNewLine]", "\t\t", "\:0442\:043e\:0447\:043a\:0438", 
           " ", "\:043d\:0430\:0447\:0430\:043b\:0430", " ", 
           "\:043e\:0442\:0441\:0447\:0435\:0442\:0430"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"A1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "#1", ",", "#2"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], "&"}], "@", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ",", 
           "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"B1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "1", ",", "#2"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], "&"}], "@", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ",", 
           "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"C1", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "#2", ",", "1"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], "&"}], "@", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ",", 
           "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"{", 
          RowBox[{"A1", ",", "B1", ",", "C1"}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"n", "=", 
         RowBox[{"n", "/", 
          RowBox[{"Norm", "@", "n"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "\:0434\:043b\:044f", " ", 
           "\:043d\:0430\:0433\:043b\:044f\:0434\:043d\:043e\:0441\:0442\:0438\
"}], " ", "-", " ", 
          RowBox[{
          "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435", " ",
            "\:043f\:0435\:0440\:043f\:0435\:043d\:0434\:0438\:043a\:0443\
\:043b\:044f\:0440\:0430"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"d", "=", 
         RowBox[{
          RowBox[{"n", ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "-", 
          RowBox[{"n", ".", "a"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"p", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
          RowBox[{"d", "*", "n"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "\:0431\:0430\:0440\:0438\:0446\:0435\:043d\:0442\:0440\:0438\:0447\
\:0435\:0441\:043a\:0438\:0435", " ", 
           "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b", 
           " ", "\:0434\:043b\:044f", " ", 
           "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f\
"}], ",", " ", 
          RowBox[{
           RowBox[{
           "\:043d\:0430\:0445\:043e\:0434", ".", " ", "\:043b\:0438"}], " ", 
           "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044f", " ", "p", " ", 
           "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
           "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\:0438\:043a\
\:0430"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"s", "=", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "*", 
          RowBox[{"Norm", "@", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"b", "-", "a"}], ",", 
             RowBox[{"c", "-", "a"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Alpha]", "=", 
         RowBox[{
          RowBox[{"Norm", "@", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"b", "-", "p"}], ",", 
             RowBox[{"c", "-", "p"}]}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "s"}], ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Beta]", "=", 
         RowBox[{
          RowBox[{"Norm", "@", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"c", "-", "p"}], ",", 
             RowBox[{"a", "-", "p"}]}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "s"}], ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"\[Gamma]", "=", 
         RowBox[{
          RowBox[{"Norm", "@", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"a", "-", "p"}], ",", 
             RowBox[{"b", "-", "p"}]}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "s"}], ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Between", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
                "}"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{
               RowBox[{
               "1", "-", "\[Alpha]", "-", "\[Beta]", "-", "\[Gamma]"}], ",", 
               "chopaccuracy"}], "]"}], "\[Equal]", "0"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "\:0435\:0441\:043b\:0438", " ", 
             "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
             "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\:0438\
\:043a\:0430", " ", "\:0438", " ", "\:043d\:0435", " ", "\:043d\:0430", " ", 
             "\:0433\:0440\:0430\:043d\:0438\:0446\:0435"}], ",", " ", 
            RowBox[{"\:0442\:043e", " ", 
             RowBox[{
             "\:043c\:0438\:043d", ".", " ", 
              "\:043f\:043e\:0434\:0441\:0438\:043c\:043f\:043b\:0435\:043a\
\:0441"}], " ", "\:0435\:0441\:0442\:044c", " ", "\:0432\:0435\:0441\:044c", 
             " ", "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441"}]}], " ",
            "*)"}], "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"res", "=", 
            RowBox[{"Chop", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p", ",", "Y"}], "}"}], ",", "chopaccuracy"}], "]"}]}],
            ";", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", "\:043d\:0430", " ", 
              "\:0433\:0440\:0430\:043d\:0438\:0446\:0435"}], ",", " ", 
             "\:0442\:043e"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Alpha]", "\[Equal]", "0"}], "&&", 
              RowBox[{"\[Beta]", "\[Equal]", "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", 
                  RowBox[{"{", "c", "}"}]}], "}"}], ",", "chopaccuracy"}], 
               "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"\[Alpha]", "\[Equal]", "0"}], "&&", 
              RowBox[{"\[Gamma]", "\[Equal]", "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", 
                  RowBox[{"{", "b", "}"}]}], "}"}], ",", "chopaccuracy"}], 
               "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"\[Beta]", "\[Equal]", "0"}], "&&", 
              RowBox[{"\[Gamma]", "\[Equal]", "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", 
                  RowBox[{"{", "a", "}"}]}], "}"}], ",", "chopaccuracy"}], 
               "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
             RowBox[{"\[Alpha]", "\[Equal]", "0"}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", 
                  RowBox[{"{", 
                   RowBox[{"b", ",", 
                    RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], ",", 
                "chopaccuracy"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "\t\t\t\t\t", 
             RowBox[{"\[Beta]", "\[Equal]", "0"}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", 
                    RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], ",", 
                "chopaccuracy"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "\t\t\t\t\t", 
             RowBox[{"\[Gamma]", "\[Equal]", "0"}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", 
                    RowBox[{"{", "b", "}"}]}], "}"}]}], "}"}], ",", 
                "chopaccuracy"}], "]"}]}]}], "\[IndentingNewLine]", 
            "\t\t\t\t", "]"}], ";"}], "\[IndentingNewLine]", "\t\t\t", ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"res", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "-", "a"}], ")"}], "/", 
               RowBox[{"Norm", "[", 
                RowBox[{"b", "-", "a"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c", "-", "b"}], ")"}], "/", 
               RowBox[{"Norm", "[", 
                RowBox[{"c", "-", "b"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "-", "c"}], ")"}], "/", 
               RowBox[{"Norm", "[", 
                RowBox[{"a", "-", "c"}], "]"}]}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", 
              "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044f", " ", 
              "\:043b\:0435\:0436\:0438\:0442", " ", "\:0432", " ", 
              RowBox[{
              "\:043e\:043f\:0440", ".", " ", 
               "\:043e\:0431\:043b\:0430\:0441\:0442\:0438"}]}], ",", " ", 
             RowBox[{
             "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
              "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:0438", " ", 
              "\:043d\:0430", " ", 
              RowBox[{
              "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\:0432", 
               ".", " ", "\:0441\:0442\:043e\:0440\:043e\:043d\:044b"}], " ", 
              "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\:0438\
\:043a\:0430"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"n1", ".", "p"}], "-", 
                 RowBox[{"n1", ".", "a"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"n1", ".", "p"}]}], "+", 
                 RowBox[{"n1", ".", "b"}]}], ")"}]}], ">", "0"}], ",", " ", 
             "\[IndentingNewLine]", "\t\t\t\t ", 
             RowBox[{
              RowBox[{"x0", "=", 
               RowBox[{"a", "-", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}]}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"b", "-", "a"}], ")"}]}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}], ".", 
                   RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}]}], ",", "x0", ",", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"n2", ".", "p"}], "-", 
                 RowBox[{"n2", ".", "b"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"n2", ".", "p"}]}], "+", 
                 RowBox[{"n2", ".", "c"}]}], ")"}]}], ">", "0"}], ",", " ", 
             "\[IndentingNewLine]", "\t\t\t\t ", 
             RowBox[{
              RowBox[{"x0", "=", 
               RowBox[{"b", "-", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}]}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"c", "-", "b"}], ")"}]}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}], ".", 
                   RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}]}], ",", "x0", ",", 
                  RowBox[{"{", 
                   RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"n3", ".", "p"}], "-", 
                 RowBox[{"n3", ".", "a"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"n3", ".", "p"}]}], "+", 
                 RowBox[{"n3", ".", "c"}]}], ")"}]}], ">", "0"}], ",", " ", 
             "\[IndentingNewLine]", "\t\t\t\t ", 
             RowBox[{
              RowBox[{"x0", "=", 
               RowBox[{"c", "-", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}]}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{"a", "-", "c"}], ")"}]}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}], ".", 
                   RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}]}], ",", "x0", ",", 
                  RowBox[{"{", 
                   RowBox[{"c", ",", "a"}], "}"}]}], "}"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430", ",", " ", 
             RowBox[{
              RowBox[{
              "\:0435\:0441\:043b\:0438", " ", 
               "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", 
               "\:043d\:0430\:0445\:043e\:0434\:044f\:0442\:0441\:044f", " ", 
               "\:0432\:0441\:0435"}], "-", 
              RowBox[{
              "\:0442\:0430\:043a\:0438", " ", 
               "\:0431\:043b\:0438\:0436\:0435"}]}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "res"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", "\t\t\t\t", 
             RowBox[{
              RowBox[{"res", "=", 
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"Rest", "@", 
                  RowBox[{"First", "@", 
                   RowBox[{"Sort", "[", 
                    RowBox[{"res", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}]}], ",",
                  " ", "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\t\t\t\t", 
              RowBox[{"l", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "-", "p"}], ")"}], ".", 
                  RowBox[{"(", 
                   RowBox[{"#", "-", "p"}], ")"}]}], "&"}], "@", 
                RowBox[{"First", "@", "res"}]}]}], ";", "\[IndentingNewLine]",
               "\t\t\t\t", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a", "-", "p"}], ")"}], ".", 
                  RowBox[{"(", 
                   RowBox[{"a", "-", "p"}], ")"}]}], "<", "l"}], ",", 
                RowBox[{"res", "=", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", 
                   RowBox[{"{", "a", "}"}]}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"b", "-", "p"}], ")"}], ".", 
                  RowBox[{"(", 
                   RowBox[{"b", "-", "p"}], ")"}]}], "<", "l"}], ",", 
                RowBox[{"res", "=", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{"{", "b", "}"}]}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"c", "-", "p"}], ")"}], ".", 
                  RowBox[{"(", 
                   RowBox[{"c", "-", "p"}], ")"}]}], "<", "l"}], ",", 
                RowBox[{"res", "=", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", 
                   RowBox[{"{", "c", "}"}]}], "}"}]}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", "\t\t\t\t", ",", "\[IndentingNewLine]", 
             "\t\t\t\t", 
             RowBox[{
              RowBox[{"res", "=", 
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"Rest", "@", 
                  RowBox[{"First", "@", 
                   RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}]}], ",", "a", ",", 
                    RowBox[{"{", "a", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}]}], ",", "b", ",", 
                    RowBox[{"{", "b", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}]}], ",", "c", ",", 
                    RowBox[{"{", "c", "}"}]}], "}"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}]}], ",",
                  "chopaccuracy"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
            "\t\t\t", "]"}], ";"}]}], "\t", "\[IndentingNewLine]", "\t\t", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "\t", "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "5"}], ":", " ", 
       RowBox[{
       "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
        "\:0435\:0441\:0442\:044c", " ", 
        "\:0447\:0435\:0442\:044b\:0440\:0435\:0445\:0433\:0440\:0430\:043d\
\:043d\:0438\:043a"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "Y"}], "\[Equal]", "4"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430", ",", " ", 
         RowBox[{
         "\:0435\:0441\:043b\:0438", " ", "\:0442\:043e\:0447\:043a\:0430", 
          " ", "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
          RowBox[{
          "\:0447\:0435\:0442\:044b\:0440\:0435\:0445\:0433\:0440\:0430\:043d\
\:043d\:0438\:043a\:0430", ".", " ", "\:0415\:0441\:043b\:0438"}], " ", 
          "\:0434\:0430"}], ",", " ", 
         RowBox[{
         "\:0442\:043e", " ", "\:0437\:043d\:0430\:043a", " ", 
          "\[IndentingNewLine]", "\t\t", 
          "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:043e\:0433\:043e", " ", 
          "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f", " ",
           "\:0434\:043b\:044f", " ", "\:043a\:0430\:0436\:0434\:043e\:0439", 
          " ", "\:0438\:0437", " ", 
          "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439", " ",
           "\:0441\:043e\:0432\:043f\:0430\:0434\:0430\:0435\:0442", " ", 
          "\:0441\:043e", " ", "\:0437\:043d\:0430\:043a\:043e\:043c", 
          "\[IndentingNewLine]", "\t\t", 
          "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:043e\:0433\:043e", " ", 
          "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f", " ",
           "\:043e\:0442", " ", 
          RowBox[{
          "\:043f\:0440\:043e\:0442\:0438\:0432\:043e\:043b", ".", " ", 
           "\:0432\:0435\:0440\:0448\:0438\:043d\:044b"}], " ", 
          "\:0434\:043e", " ", "\:044d\:0442\:043e\:0439", " ", 
          "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", "v3", ",", "v4"}], "}"}], "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"Y", ",", "chopaccuracy"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"AA", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "#1", ",", "#2"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], "&"}], "\[IndentingNewLine]", "\t\t\t\t", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v1", ",", "v2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v2", ",", "v3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v3", ",", "v1"}], "}"}]}], "}"}]}], ",", 
           "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"BB", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "1", ",", "#2"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], "&"}], "\[IndentingNewLine]", "\t\t\t\t", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v1", ",", "v2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v2", ",", "v3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v3", ",", "v1"}], "}"}]}], "}"}]}], ",", 
           "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"CC", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "#2", ",", "1"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], "&"}], "\[IndentingNewLine]", "\t\t\t\t", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v1", ",", "v2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v2", ",", "v3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v4", ",", "v3", ",", "v1"}], "}"}]}], "}"}]}], ",", 
           "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{"NextVertexAndSubsimplex", "[", 
            RowBox[{
             RowBox[{"Nearest", "[", 
              RowBox[{"Y", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "3"}], "]"}], 
             ",", "chopaccuracy"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"nn", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"List", ",", 
           RowBox[{"{", 
            RowBox[{"AA", ",", "BB", ",", "CC"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"NonNegative", "[", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Dot", ",", 
                   RowBox[{"{", 
                    RowBox[{"nn", ",", 
                    RowBox[{"{", 
                    RowBox[{"v4", ",", "v3", ",", "v1", ",", "v2"}], "}"}]}], 
                    "}"}]}], "]"}], ",", "chopaccuracy"}], "]"}], "-", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Dot", ",", 
                   RowBox[{"{", 
                    RowBox[{"nn", ",", 
                    RowBox[{"{", 
                    RowBox[{"v1", ",", "v2", ",", "v3", ",", "v4"}], "}"}]}], 
                    "}"}]}], "]"}], ",", "chopaccuracy"}], "]"}]}], "]"}], 
             "*", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"Sign", "[", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Dot", ",", 
                   RowBox[{"{", 
                    RowBox[{"nn", ",", 
                    RowBox[{"{", 
                    RowBox[{"v1", ",", "v2", ",", "v3", ",", "v4"}], "}"}]}], 
                    "}"}]}], "]"}]}], ",", "chopaccuracy"}], "]"}], "]"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "\:0442\:043e\:0447\:043a\:0430", " ", 
            "\:0433\:0430\:0440\:0430\:043d\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:043e", " ", "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
            "\:0442\:0435\:043a\:0443\:0449\:0435\:0433\:043e", " ", 
            "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441\:0430", " ", 
            "Y"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", 
              "\:0442\:043e\:0447\:043a\:0430", " ", "\:043d\:0430", " ", 
              "\:043e\:0434\:043d\:043e\:0439", " ", "\:0438\:0437", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
              "\:0442\:0435\:0442\:0440\:0430\:044d\:0434\:0440\:0430"}], " ",
              "*)"}], "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"v1", "\[Equal]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{"v1", ",", 
                RowBox[{"{", "v1", "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"v2", "\[Equal]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{"v2", ",", 
                RowBox[{"{", "v2", "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"v3", "\[Equal]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{"v3", ",", 
                RowBox[{"{", "v3", "}"}]}], "}"}]}], ",", " ", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"v4", "\[Equal]", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{"v4", ",", 
                RowBox[{"{", "v4", "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
              "\:0435\:0441\:043b\:0438", " ", 
               "\:0442\:043e\:0447\:043a\:0430", " ", "\:043d\:0430", " ", 
               "\:0440\:0435\:0431\:0440\:0435"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", "v1"}], " ", "\[Equal]",
                " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ".", "v2"}], "\[Equal]", 
               "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v2"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", "v1"}], " ", "\[Equal]",
                " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ".", "v3"}], "\[Equal]", 
               "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v2", ",", "v3"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", "v1"}], " ", "\[Equal]",
                " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ".", "v4"}], "\[Equal]", 
               "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v3"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ".", "v2"}], " ", "\[Equal]",
                " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ".", "v3"}], "\[Equal]", 
               "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v2", ",", "v4"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ".", "v2"}], " ", "\[Equal]",
                " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ".", "v4"}], "\[Equal]", 
               "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v4"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ".", "v3"}], " ", "\[Equal]",
                " ", "0"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"nn", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ".", "v4"}], "\[Equal]", 
               "0"}]}], ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v3", ",", "v4"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
              "\:0435\:0441\:043b\:0438", " ", 
               "\:0442\:043e\:0447\:043a\:0430", " ", "\:043d\:0430", " ", 
               "\:043e\:0434\:043d\:043e\:0439", " ", "\:0438\:0437", " ", 
               "\:0433\:0440\:0430\:043d\:0435\:0439"}], "*)"}], 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ".", "v1"}], " ", "\[Equal]", 
              " ", "0"}], " ", ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ".", "v2"}], " ", "\[Equal]", 
              " ", "0"}], " ", ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v4", ",", "v1", ",", "v2"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ".", "v3"}], " ", "\[Equal]", 
              " ", "0"}], " ", ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v4", ",", "v2", ",", "v3"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"nn", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ".", "v4"}], " ", "\[Equal]", 
              " ", "0"}], " ", ",", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v4", ",", "v3", ",", "v1"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "\:0435\:0441\:043b\:0438", " ", 
                "\:0434\:043e\:0448\:043b\:043e", " ", "\:0434\:043e", " ", 
                "\:0441\:044e\:0434\:0430"}], ",", " ", 
               RowBox[{
                RowBox[{
                "\:0437\:043d\:0430\:0447\:0438\:0442", " ", 
                 "\:043e\:0431\:0449\:0438\:0439", " ", 
                 "\:0441\:043b\:0443\:0447\:0430\:0439"}], " ", "-", " ", 
                RowBox[{
                "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
                 "\:0442\:0435\:0442\:0440\:0430\:044d\:0434\:0440\:0430"}]}]}\
], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", "True", ",", " ", 
             RowBox[{"res", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "Y"}], 
               "}"}]}]}], "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}], 
          "\[IndentingNewLine]", "\t\t\t", ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "\:0442\:043e\:0447\:043a\:0430", " ", 
            "\:0433\:0430\:0440\:0430\:043d\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:043e", " ", "\:0432\:043d\:0435", " ", 
            "\:0442\:0435\:043a\:0443\:0449\:0435\:0433\:043e", " ", 
            "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441\:0430", " ", 
            RowBox[{"Y", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "\:0440\:0435\:043a\:0443\:0440\:0441\:0438\:0432\:043d\:043e", 
            " ", "\:0432\:044b\:0437\:044b\:0432\:0430\:0435\:043c", " ", 
            "\:0444\:0443\:043d\:043a\:0446\:0438\:044e", " ", "\:0438", " ", 
            "\:043f\:0435\:0440\:0435\:0434\:0430\:0435\:043c", " ", 
            "\:043a\:0430\:0436\:0434\:0443\:044e", " ", "\:0438\:0437", " ", 
            "\:0433\:0440\:0430\:043d\:0435\:0439"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"results", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"NextVertexAndMinSubsimplex", "[", 
               RowBox[{"#", ",", "chopaccuracy"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"v4", ",", "v1", ",", "v2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"v4", ",", "v2", ",", "v3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"v4", ",", "v3", ",", "v1"}], "}"}]}], "}"}]}]}], ";",
            "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"dddd", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", ".", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"results", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"res", "=", 
            RowBox[{"results", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Min", "[", "#", "]"}]}], "]"}], "&"}], "@", 
                 "dddd"}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.831303082908269*^9, 3.831303087089057*^9}, {
   3.8313031196988506`*^9, 3.831303155841626*^9}, {3.8313033662092*^9, 
   3.8313033775558844`*^9}, {3.831303446368861*^9, 3.8313035702978106`*^9}, {
   3.831305253696718*^9, 3.8313053949294643`*^9}, {3.8313054264651294`*^9, 
   3.8313055183613405`*^9}, {3.831305609241312*^9, 3.831305743250329*^9}, {
   3.83130578668121*^9, 3.8313058063535995`*^9}, {3.831305838921478*^9, 
   3.831306225729226*^9}, {3.83130626004346*^9, 3.8313069360075507`*^9}, {
   3.831306967662897*^9, 3.8313070861275935`*^9}, {3.8313072849610186`*^9, 
   3.8313072872638655`*^9}, {3.8313079339919443`*^9, 
   3.8313079560800467`*^9}, {3.8313080150145855`*^9, 
   3.8313080200311675`*^9}, {3.831308060732294*^9, 3.8313080683838587`*^9}, {
   3.831308102186434*^9, 3.8313081642560425`*^9}, {3.831308245721208*^9, 
   3.831308374319376*^9}, {3.831308435137729*^9, 3.831308465169259*^9}, {
   3.8313084977840605`*^9, 3.8313085248237495`*^9}, {3.831308578523142*^9, 
   3.8313085791205444`*^9}, {3.8313087755926266`*^9, 3.831308842224538*^9}, {
   3.831308882654417*^9, 3.831308912960369*^9}, {3.831308954937112*^9, 
   3.8313091445058417`*^9}, {3.831309505032967*^9, 3.831309524617617*^9}, {
   3.8313103468432364`*^9, 3.8313103605206842`*^9}, {3.831310430402154*^9, 
   3.8313104375919275`*^9}, {3.831310551088381*^9, 3.8313105965441265`*^9}, {
   3.831310829859031*^9, 3.831310848232308*^9}, {3.8313114227368064`*^9, 
   3.831311428440552*^9}, {3.8313122089227333`*^9, 3.8313122108565664`*^9}, {
   3.831312492649026*^9, 3.8313124937051764`*^9}, {3.8313126672262974`*^9, 
   3.831312717023178*^9}, {3.831312926727523*^9, 3.8313130610961504`*^9}, {
   3.831313111085535*^9, 3.831313143368433*^9}, {3.8313132453639936`*^9, 
   3.831313290246959*^9}, {3.8313133688417797`*^9, 3.8313134468482814`*^9}, {
   3.8313134782474904`*^9, 3.8313134960869226`*^9}, {3.831314314175503*^9, 
   3.8313143548787966`*^9}, {3.831314475237897*^9, 3.831314490046321*^9}, {
   3.831314577029709*^9, 3.831314607142148*^9}, {3.831314862354289*^9, 
   3.8313148734057684`*^9}, {3.831315190687834*^9, 3.831315206862212*^9}, {
   3.831315385808234*^9, 3.8313153989181986`*^9}, {3.831315524039668*^9, 
   3.8313155761034064`*^9}, {3.8313159622076397`*^9, 
   3.8313159674137187`*^9}, {3.8313162982495704`*^9, 
   3.8313163430938206`*^9}, {3.83131816428193*^9, 3.8313182493824244`*^9}, {
   3.831318745472506*^9, 3.831319235323736*^9}, {3.831319272816498*^9, 
   3.831319273469749*^9}, {3.831319526893162*^9, 3.8313196403959064`*^9}, {
   3.831389444011986*^9, 3.8313895452179337`*^9}, {3.831389857111414*^9, 
   3.8313898582802615`*^9}, {3.831390167794945*^9, 3.8313903031279836`*^9}, {
   3.831390367008131*^9, 3.831390375050599*^9}, {3.831390659527766*^9, 
   3.8313906636108484`*^9}, {3.831390767194301*^9, 3.831390930396489*^9}, {
   3.8313909982973776`*^9, 3.8313910352615137`*^9}, {3.8313921059993105`*^9, 
   3.8313922103075347`*^9}, {3.831392736438106*^9, 3.8313928730874577`*^9}, {
   3.831392908437975*^9, 3.83139302136594*^9}, {3.831393218486218*^9, 
   3.831393223699534*^9}, {3.831393377722612*^9, 3.831393401677546*^9}, {
   3.831393534950097*^9, 3.8313935851787243`*^9}, {3.8313936264254074`*^9, 
   3.8313936466305013`*^9}, {3.831393678967012*^9, 3.8313937134809084`*^9}, {
   3.8313937506714396`*^9, 3.8313942187767954`*^9}, {3.8313942554317307`*^9, 
   3.8313942677757406`*^9}, {3.831394337498355*^9, 3.831394354862911*^9}, {
   3.8313944155466075`*^9, 3.831394452540659*^9}, {3.831394485763776*^9, 
   3.831394601854699*^9}, {3.831394643714738*^9, 3.831394673874069*^9}, {
   3.8313947138371897`*^9, 3.8313947529886465`*^9}, {3.8313947932828474`*^9, 
   3.8313948332709246`*^9}, {3.8313949211169715`*^9, 
   3.8313949979986477`*^9}, {3.8313950636710005`*^9, 3.8313950825877*^9}, {
   3.8313951360028276`*^9, 3.831395219465308*^9}, {3.8313952727946653`*^9, 
   3.8313952783587894`*^9}, {3.8313955750414124`*^9, 3.831395738221261*^9}, {
   3.8314436018292036`*^9, 3.831443605478413*^9}, 3.831443733552844*^9, {
   3.8314437789014225`*^9, 3.831443942267644*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"6428e5a4-ba7f-4923-8665-5a6b62355265"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp1", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pp2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", " ", 
       RowBox[{"Point", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", "pp1", ",", 
          "pp2", ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", "pp1", ",", 
          "pp2", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], ",", "pp1", ",", 
          "pp2", ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", "Green", ",", 
       RowBox[{"Point", "@", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "Purple", ",", 
       RowBox[{"Point", "[", 
        RowBox[{"First", "@", 
         RowBox[{"NextVertexAndMinSubsimplex", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", "pp1", ",", 
            "pp2", ",", 
            RowBox[{"{", 
             RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "}"}], "]"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "16"}], ",", "16"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "16"}], ",", "16"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "16"}], ",", "16"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "2"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z1", ",", "3"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{"-", "3"}]}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y2", ",", "5"}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.831319993820228*^9, 3.8313200367485275`*^9}, {
  3.8313885739420958`*^9, 3.831388634734474*^9}, {3.831389578118932*^9, 
  3.831389685212901*^9}, {3.831389717384537*^9, 3.8313897915952063`*^9}, {
  3.8313950857272916`*^9, 3.831395089061381*^9}, {3.831395822946974*^9, 
  3.831395858400487*^9}, {3.831395889195118*^9, 3.8313958963450003`*^9}, {
  3.8313959323736343`*^9, 3.831395933720035*^9}, {3.831396001734585*^9, 
  3.831396004393498*^9}, {3.8313964331988363`*^9, 3.8313964357211266`*^9}, {
  3.831396485921373*^9, 3.8313964972879734`*^9}, {3.8313967013821034`*^9, 
  3.831396705755405*^9}, {3.831396755671894*^9, 3.831396797289841*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"22c16f0d-e1f9-4e56-9506-453ae960d5c4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x1$$ = 
    7.5, $CellContext`x2$$ = -8.3, $CellContext`y1$$ = -5.299999999999999, \
$CellContext`y2$$ = 10.700000000000003`, $CellContext`z1$$ = 
    3, $CellContext`z2$$ = -11.2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`x1$$], 2}, -15, 15, 0.1}, {{
       Hold[$CellContext`y1$$], -1}, -15, 15, 0.1}, {{
       Hold[$CellContext`z1$$], 3}, -15, 15, 0.1}, {{
       Hold[$CellContext`x2$$], -3}, -15, 15, 0.1}, {{
       Hold[$CellContext`y2$$], 5}, -15, 15, 0.1}, {{
       Hold[$CellContext`z2$$], -1}, -15, 15, 0.1}}, Typeset`size$$ = {
    303., {174., 179.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x1$3352$$ = 
    0, $CellContext`y1$3353$$ = 0, $CellContext`z1$3354$$ = 
    0, $CellContext`x2$3355$$ = 0, $CellContext`y2$3356$$ = 
    0, $CellContext`z2$3357$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`x1$$ = 
        2, $CellContext`x2$$ = -3, $CellContext`y1$$ = -1, $CellContext`y2$$ = 
        5, $CellContext`z1$$ = 3, $CellContext`z2$$ = -1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x1$$, $CellContext`x1$3352$$, 0], 
        Hold[$CellContext`y1$$, $CellContext`y1$3353$$, 0], 
        Hold[$CellContext`z1$$, $CellContext`z1$3354$$, 0], 
        Hold[$CellContext`x2$$, $CellContext`x2$3355$$, 0], 
        Hold[$CellContext`y2$$, $CellContext`y2$3356$$, 0], 
        Hold[$CellContext`z2$$, $CellContext`z2$3357$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics3D[{PointSize -> 0.025, 
         Point[{{$CellContext`x1$$, $CellContext`y1$$, $CellContext`z1$$}, \
$CellContext`pp1, $CellContext`pp2, {$CellContext`x2$$, $CellContext`y2$$, \
$CellContext`z2$$}}], 
         Line[{{$CellContext`x1$$, $CellContext`y1$$, $CellContext`z1$$}, \
$CellContext`pp1, $CellContext`pp2, {$CellContext`x1$$, $CellContext`y1$$, \
$CellContext`z1$$}, {$CellContext`x2$$, $CellContext`y2$$, \
$CellContext`z2$$}, $CellContext`pp1, $CellContext`pp2, {$CellContext`x2$$, \
$CellContext`y2$$, $CellContext`z2$$}}], Green, 
         Point[{0, 0, 0}], Purple, 
         Point[
          First[
           $CellContext`NextVertexAndMinSubsimplex[{{$CellContext`x1$$, \
$CellContext`y1$$, $CellContext`z1$$}, $CellContext`pp1, $CellContext`pp2, \
{$CellContext`x2$$, $CellContext`y2$$, $CellContext`z2$$}}]]]}, Axes -> True, 
        PlotRange -> {{-16, 16}, {-16, 16}, {-16, 16}}], 
      "Specifications" :> {{{$CellContext`x1$$, 2}, -15, 15, 
         0.1}, {{$CellContext`y1$$, -1}, -15, 15, 
         0.1}, {{$CellContext`z1$$, 3}, -15, 15, 
         0.1}, {{$CellContext`x2$$, -3}, -15, 15, 
         0.1}, {{$CellContext`y2$$, 5}, -15, 15, 
         0.1}, {{$CellContext`z2$$, -1}, -15, 15, 0.1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{354., {291., 297.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.831320039924037*^9, 3.8313884614658003`*^9, 
  3.8313886390459423`*^9, 3.831389794894389*^9, 3.831389866916161*^9, 
  3.831395230877776*^9, 3.8313957764573154`*^9, 3.831395863256468*^9, 
  3.8313959014742517`*^9, 3.8313960049709606`*^9, 3.8313964384089007`*^9, 
  3.831396487546996*^9, 3.831396706532327*^9, 3.831396771531691*^9, 
  3.831396824774432*^9, 3.8314004534183903`*^9, 3.831537873078907*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"cb21defd-de56-48a8-8009-f9749bd41760"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pp1", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pp2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", " ", 
           RowBox[{"Point", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "pp1", ",", 
              "pp2"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "pp1", ",", 
              "pp2", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], "]"}], ",", 
           "Green", ",", 
           RowBox[{"Point", "@", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "Purple", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"First", "@", 
             RowBox[{"NextVertexAndMinSubsimplex", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "pp1", ",", 
                "pp2"}], "}"}], "]"}]}], "]"}]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "16"}], ",", "16"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "16"}], ",", "16"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "16"}], ",", "16"}], "}"}]}], "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "0.2"}], "}"}], ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "0.2"}]}], "}"}], ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0.2"}], "}"}], ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", " ", 
           RowBox[{"Point", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "pp1"}], 
             "}"}]}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "pp1"}], "}"}], 
            "]"}], ",", "Green", ",", 
           RowBox[{"Point", "@", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           "\[IndentingNewLine]", "Purple", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"First", "@", 
             RowBox[{"NextVertexAndMinSubsimplex", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "pp1"}], 
               "}"}], "]"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
         RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "16"}], ",", "16"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "16"}], ",", "16"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "16"}], ",", "16"}], "}"}]}], "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "0.2"}], "}"}], ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "0.2"}]}], "}"}], ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0.2"}], "}"}], ",", 
         RowBox[{"-", "15"}], ",", "15", ",", "0.1"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8313968113523216`*^9, 3.831396911391736*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"e17908ae-d9ed-4e6f-87e4-8d2c939bba44"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      StyleBox[
       DynamicModuleBox[{$CellContext`x$$ = 0.2, $CellContext`y$$ = 
        2., $CellContext`z$$ = 0.2, Typeset`show$$ = True, 
        Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
        Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
        "\"untitled\"", Typeset`specs$$ = {{{
           Hold[$CellContext`x$$], 0.2}, -15, 15, 0.1}, {{
           Hold[$CellContext`y$$], -0.2}, -15, 15, 0.1}, {{
           Hold[$CellContext`z$$], 0.2}, -15, 15, 0.1}}, Typeset`size$$ = {
        354., {191., 197.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
        Typeset`skipInitDone$$ = True, $CellContext`x$3405$$ = 
        0, $CellContext`y$3406$$ = 0, $CellContext`z$3407$$ = 0}, 
        DynamicBox[Manipulate`ManipulateBoxes[
         1, StandardForm, 
          "Variables" :> {$CellContext`x$$ = 
            0.2, $CellContext`y$$ = -0.2, $CellContext`z$$ = 0.2}, 
          "ControllerVariables" :> {
            Hold[$CellContext`x$$, $CellContext`x$3405$$, 0], 
            Hold[$CellContext`y$$, $CellContext`y$3406$$, 0], 
            Hold[$CellContext`z$$, $CellContext`z$3407$$, 0]}, 
          "OtherVariables" :> {
           Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
            Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
            Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
            Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
          Graphics3D[{PointSize -> 0.025, 
             
             Point[{{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`pp1, $CellContext`pp2}], 
             
             Line[{{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`pp1, $CellContext`pp2, {$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}}], Green, 
             Point[{0, 0, 0}], Purple, 
             Point[
              First[
               $CellContext`NextVertexAndMinSubsimplex[{{$CellContext`x$$, \
$CellContext`y$$, $CellContext`z$$}, $CellContext`pp1, $CellContext`pp2}]]]}, 
            Axes -> True, PlotRange -> {{-16, 16}, {-16, 16}, {-16, 16}}], 
          "Specifications" :> {{{$CellContext`x$$, 0.2}, -15, 15, 
             0.1}, {{$CellContext`y$$, -0.2}, -15, 15, 
             0.1}, {{$CellContext`z$$, 0.2}, -15, 15, 0.1}}, "Options" :> {}, 
          "DefaultOptions" :> {}],
         ImageSizeCache->{405., {266., 272.}},
         SingleEvaluation->True],
        Deinitialization:>None,
        DynamicModuleValues:>{},
        SynchronousInitialization->True,
        UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
        UnsavedVariables:>{Typeset`initDone$$},
        UntrackedVariables:>{Typeset`size$$}], "Manipulate",
       Deployed->True,
       StripOnInput->False],
      Manipulate`InterpretManipulate[1]], 
     TagBox[
      StyleBox[
       DynamicModuleBox[{$CellContext`x$$ = -6.699999999999999, \
$CellContext`y$$ = -0.1999999999999993, $CellContext`z$$ = -4.799999999999999,
         Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
        Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, 
        Typeset`animvar$$ = 1, Typeset`name$$ = "\"untitled\"", 
        Typeset`specs$$ = {{{
           Hold[$CellContext`x$$], 0.2}, -15, 15, 0.1}, {{
           Hold[$CellContext`y$$], -0.2}, -15, 15, 0.1}, {{
           Hold[$CellContext`z$$], 0.2}, -15, 15, 0.1}}, Typeset`size$$ = {
        392., {214., 219.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
        Typeset`skipInitDone$$ = True, $CellContext`x$3428$$ = 
        0, $CellContext`y$3429$$ = 0, $CellContext`z$3430$$ = 0}, 
        DynamicBox[Manipulate`ManipulateBoxes[
         1, StandardForm, 
          "Variables" :> {$CellContext`x$$ = 
            0.2, $CellContext`y$$ = -0.2, $CellContext`z$$ = 0.2}, 
          "ControllerVariables" :> {
            Hold[$CellContext`x$$, $CellContext`x$3428$$, 0], 
            Hold[$CellContext`y$$, $CellContext`y$3429$$, 0], 
            Hold[$CellContext`z$$, $CellContext`z$3430$$, 0]}, 
          "OtherVariables" :> {
           Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
            Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
            Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
            Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
          Graphics3D[{PointSize -> 0.025, 
             
             Point[{{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`pp1}], 
             
             Line[{{$CellContext`x$$, $CellContext`y$$, $CellContext`z$$}, \
$CellContext`pp1}], Green, 
             Point[{0, 0, 0}], Purple, 
             Point[
              First[
               $CellContext`NextVertexAndMinSubsimplex[{{$CellContext`x$$, \
$CellContext`y$$, $CellContext`z$$}, $CellContext`pp1}]]]}, Axes -> True, 
            PlotRange -> {{-16, 16}, {-16, 16}, {-16, 16}}], 
          "Specifications" :> {{{$CellContext`x$$, 0.2}, -15, 15, 
             0.1}, {{$CellContext`y$$, -0.2}, -15, 15, 
             0.1}, {{$CellContext`z$$, 0.2}, -15, 15, 0.1}}, "Options" :> {}, 
          "DefaultOptions" :> {}],
         ImageSizeCache->{443., {289., 295.}},
         SingleEvaluation->True],
        Deinitialization:>None,
        DynamicModuleValues:>{},
        SynchronousInitialization->True,
        UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
        UnsavedVariables:>{Typeset`initDone$$},
        UntrackedVariables:>{Typeset`size$$}], "Manipulate",
       Deployed->True,
       StripOnInput->False],
      Manipulate`InterpretManipulate[1]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.8313968130427694`*^9, 3.8313968204759283`*^9}, 
   3.8313969166497035`*^9, 3.831400453577962*^9, 3.8315378732159467`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"14898cf9-bdb2-4550-b7a7-95869f752323"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SupportVector", "[", 
   RowBox[{"v0_", ",", "verts_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"verts", ".", "v0"}]}], "}"}], ",", 
    RowBox[{"verts", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"temp", ",", 
         RowBox[{"Max", "[", "temp", "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.831388809905175*^9, 3.831388843461376*^9}, {
   3.8313891635641966`*^9, 3.8313892658279076`*^9}, 3.831389336012811*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"8b8b406f-c67e-4d2d-a696-017acd196f05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StaticCollisionQ3DConvPolyhedronConvPolyhedron", "[", 
   RowBox[{"{", 
    RowBox[{"P1_", ",", "P2_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "w", ",", "W", ",", "Y", ",", "AB", ",", 
      RowBox[{"iter", "=", "1"}], ",", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"-", "53"}], ")"}]}]}], ",", "\[Epsilon]tol"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"GJK", "-", 
      RowBox[{
      "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c", " ", 
       "\:0434\:043b\:044f", " ", 
       "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:044f", " ", 
       RowBox[{"\:0440\:0430\:0437\:0434", ".", " ", "\:043e\:0441\:0438"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GJK", " ", "separating"}], "-", 
         RowBox[{"axis", " ", 
          RowBox[{"alg", "."}]}]}], ")"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"\[Epsilon]tol", "=", 
      RowBox[{"N", "[", 
       RowBox[{"100", "\[Epsilon]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"AB", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "-", "#2"}], "&"}], ",", 
          RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], ",", 
          RowBox[{"P2", "[", "\"\<coord\>\"", "]"}], ",", "1"}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"v", "=", 
      RowBox[{"P1", "[", 
       RowBox[{"\"\<coord\>\"", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"W", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Y", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"w", "=", 
         RowBox[{"SupportVector", "[", 
          RowBox[{
           RowBox[{"-", "v"}], ",", "AB"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"Y", ",", "w"}], "]"}], " ", "||", 
           RowBox[{
            RowBox[{"v", ".", "w"}], ">", "0"}]}], ",", "\[IndentingNewLine]",
           "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"v", " ", "-", " ", 
            RowBox[{
            "\:0440\:0430\:0437\:0434\:0435\:043b\:044f\:044e\:0449\:0430\
\:044f", " ", "\:043e\:0441\:044c"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"Y", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"W", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v", ",", "W"}], "}"}], "=", 
         RowBox[{"NextVertexAndMinSubsimplex", "[", 
          RowBox[{"Y", ",", "\[Epsilon]tol"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "@", "W"}], "==", "4"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"v", ".", "v"}], "\[LessEqual]", " ", 
             RowBox[{"\[Epsilon]tol", "*", 
              RowBox[{"Max", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Dot", ",", 
                 RowBox[{"{", 
                  RowBox[{"W", ",", "W"}], "}"}]}], "]"}]}]}]}], ")"}]}], ",",
           " ", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iter", "\[GreaterEqual]", " ", "20"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"iter", "=", 
         RowBox[{"iter", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\t", 
   "\[IndentingNewLine]", "\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.831278575445249*^9, 3.8312785920628943`*^9}, {
   3.8312786249030395`*^9, 3.8312786601728244`*^9}, {3.831278703884921*^9, 
   3.8312787689013023`*^9}, {3.831279047606352*^9, 3.831279073365552*^9}, {
   3.8313887594918246`*^9, 3.831388796234767*^9}, {3.8313893639500904`*^9, 
   3.831389370242261*^9}, {3.831397863240677*^9, 3.8313978738606634`*^9}, {
   3.831397919645355*^9, 3.831397925118389*^9}, {3.831397959993204*^9, 
   3.831398031638838*^9}, {3.831398080737464*^9, 3.831398093883852*^9}, {
   3.831400500486235*^9, 3.8314005016020803`*^9}, {3.831441605035346*^9, 
   3.8314417231693497`*^9}, {3.8314419743998957`*^9, 3.831441996567622*^9}, {
   3.8314420504706964`*^9, 3.8314421069839*^9}, {3.8314421799839067`*^9, 
   3.8314421832243347`*^9}, {3.8314422210682554`*^9, 3.831442279907672*^9}, 
   3.83144238851377*^9, {3.8314424231090155`*^9, 3.831442423701461*^9}, {
   3.8314424651391134`*^9, 3.831442468019082*^9}, {3.8314426263216734`*^9, 
   3.831442706399727*^9}, {3.8314427510398097`*^9, 3.831443125174362*^9}, {
   3.831443167204336*^9, 3.831443216503014*^9}, {3.83144328804191*^9, 
   3.831443290444907*^9}, 3.831443325081324*^9, {3.8315381470537233`*^9, 
   3.8315381471444798`*^9}, {3.831538255843893*^9, 3.8315382820757675`*^9}, {
   3.831539464388359*^9, 3.831539484540489*^9}, {3.8315396583103056`*^9, 
   3.8315396617122087`*^9}, {3.831540332414065*^9, 3.8315403345971823`*^9}, {
   3.831540416484271*^9, 3.8315404446849856`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"8650bfcb-3de6-4a85-89b7-4f9f2c8a552d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P10", "=", 
   RowBox[{"P1", "[", "\"\<coord\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P30", "=", 
   RowBox[{"P3", "[", "\"\<coord\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], "=", 
         RowBox[{"P10", "+", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
            RowBox[{"P1", "[", "\"\<nverts\>\"", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PolyhedronShow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P1", ",", "P2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}]}], "}"}]}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"StaticCollisionQ3DConvPolyhedronConvPolyhedron", "[", 
             RowBox[{"{", 
              RowBox[{"P1", ",", "P2"}], "}"}], "]"}]}], "}"}], "}"}], 
         "]"}]}], "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "0"}]}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"P3", "[", "\"\<coord\>\"", "]"}], "=", 
         RowBox[{"P30", "+", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
            RowBox[{"P3", "[", "\"\<nverts\>\"", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PolyhedronShow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P3", ",", "P2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}]}], "}"}]}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"StaticCollisionQ3DConvPolyhedronConvPolyhedron", "[", 
             RowBox[{"{", 
              RowBox[{"P3", ",", "P2"}], "}"}], "]"}]}], "}"}], "}"}], 
         "]"}]}], "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "0"}]}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}]}], "]"}]}], 
    "}"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.831538422368723*^9, 3.831538504007477*^9}, {
  3.831539082186822*^9, 3.831539169999109*^9}, {3.831539217848194*^9, 
  3.831539290015409*^9}, {3.8315393484004307`*^9, 3.8315393753603992`*^9}, {
  3.8315394211429696`*^9, 3.831539448712267*^9}, {3.831539560418002*^9, 
  3.8315395776150274`*^9}, {3.8315397591916156`*^9, 3.831539787005373*^9}, {
  3.8315401057455297`*^9, 3.8315401376363244`*^9}, {3.8315401957291174`*^9, 
  3.8315402220916424`*^9}, {3.831540338907658*^9, 3.8315403405492725`*^9}, {
  3.8315404594535017`*^9, 3.8315404614601393`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"16ed083c-f5b6-43c4-b7ca-06ba8d4880a4"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      StyleBox[
       DynamicModuleBox[{$CellContext`x$$ = -3., $CellContext`y$$ = 
        2.5, $CellContext`z$$ = -17.5, Typeset`show$$ = True, 
        Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
        Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
        "\"untitled\"", Typeset`specs$$ = {{{
           Hold[$CellContext`x$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`y$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`z$$], 0}, -25, 25, 0.5}}, Typeset`size$$ = {
        404., {183.5, 189.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
        Typeset`skipInitDone$$ = True, $CellContext`x$66988$$ = 
        0, $CellContext`y$66989$$ = 0, $CellContext`z$66990$$ = 0}, 
        DynamicBox[Manipulate`ManipulateBoxes[
         1, StandardForm, 
          "Variables" :> {$CellContext`x$$ = 0, $CellContext`y$$ = 
            0, $CellContext`z$$ = 0}, "ControllerVariables" :> {
            Hold[$CellContext`x$$, $CellContext`x$66988$$, 0], 
            Hold[$CellContext`y$$, $CellContext`y$66989$$, 0], 
            Hold[$CellContext`z$$, $CellContext`z$66990$$, 0]}, 
          "OtherVariables" :> {
           Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
            Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
            Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
            Typeset`initDone$$, Typeset`skipInitDone$$}, 
          "Body" :> ($CellContext`P1["coord"] = $CellContext`P10 + 
             ConstantArray[{$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}, 
               $CellContext`P1["nverts"]]; Grid[{{
               $CellContext`PolyhedronShow[{$CellContext`P1, \
$CellContext`P2}, {
                Axes -> True, 
                 PlotRange -> {{-30, 30}, {-30, 30}, {-30, 30}}}], 
               $CellContext`StaticCollisionQ3DConvPolyhedronConvPolyhedron[{$\
CellContext`P1, $CellContext`P2}]}}]), 
          "Specifications" :> {{{$CellContext`x$$, 0}, -25, 25, 
             0.5}, {{$CellContext`y$$, 0}, -25, 25, 
             0.5}, {{$CellContext`z$$, 0}, -25, 25, 0.5}}, "Options" :> {}, 
          "DefaultOptions" :> {}],
         ImageSizeCache->{455., {259., 265.}},
         SingleEvaluation->True],
        Deinitialization:>None,
        DynamicModuleValues:>{},
        SynchronousInitialization->True,
        UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
        UnsavedVariables:>{Typeset`initDone$$},
        UntrackedVariables:>{Typeset`size$$}], "Manipulate",
       Deployed->True,
       StripOnInput->False],
      Manipulate`InterpretManipulate[1]], 
     TagBox[
      StyleBox[
       DynamicModuleBox[{$CellContext`x$$ = -15.5, $CellContext`y$$ = -10.5, \
$CellContext`z$$ = 10.5, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
        Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, 
        Typeset`animvar$$ = 1, Typeset`name$$ = "\"untitled\"", 
        Typeset`specs$$ = {{{
           Hold[$CellContext`x$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`y$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`z$$], 0}, -25, 25, 0.5}}, Typeset`size$$ = {
        357., {213., 219.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
        Typeset`skipInitDone$$ = True, $CellContext`x$67012$$ = 
        0, $CellContext`y$67013$$ = 0, $CellContext`z$67014$$ = 0}, 
        DynamicBox[Manipulate`ManipulateBoxes[
         1, StandardForm, 
          "Variables" :> {$CellContext`x$$ = 0, $CellContext`y$$ = 
            0, $CellContext`z$$ = 0}, "ControllerVariables" :> {
            Hold[$CellContext`x$$, $CellContext`x$67012$$, 0], 
            Hold[$CellContext`y$$, $CellContext`y$67013$$, 0], 
            Hold[$CellContext`z$$, $CellContext`z$67014$$, 0]}, 
          "OtherVariables" :> {
           Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
            Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
            Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
            Typeset`initDone$$, Typeset`skipInitDone$$}, 
          "Body" :> ($CellContext`P3["coord"] = $CellContext`P30 + 
             ConstantArray[{$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}, 
               $CellContext`P3["nverts"]]; Grid[{{
               $CellContext`PolyhedronShow[{$CellContext`P3, \
$CellContext`P2}, {
                Axes -> True, 
                 PlotRange -> {{-30, 30}, {-30, 30}, {-30, 30}}}], 
               $CellContext`StaticCollisionQ3DConvPolyhedronConvPolyhedron[{$\
CellContext`P3, $CellContext`P2}]}}]), 
          "Specifications" :> {{{$CellContext`x$$, 0}, -25, 25, 
             0.5}, {{$CellContext`y$$, 0}, -25, 25, 
             0.5}, {{$CellContext`z$$, 0}, -25, 25, 0.5}}, "Options" :> {}, 
          "DefaultOptions" :> {}],
         ImageSizeCache->{408., {288., 294.}},
         SingleEvaluation->True],
        Deinitialization:>None,
        DynamicModuleValues:>{},
        SynchronousInitialization->True,
        UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
        UnsavedVariables:>{Typeset`initDone$$},
        UntrackedVariables:>{Typeset`size$$}], "Manipulate",
       Deployed->True,
       StripOnInput->False],
      Manipulate`InterpretManipulate[1]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.8315384842881923`*^9, 3.8315391759890957`*^9, 
  3.8315392950569296`*^9, 3.831539402668358*^9, 3.8315394546055117`*^9, 
  3.8315394930398655`*^9, 3.8315395800195985`*^9, 3.8315402279489822`*^9, 
  3.8315404677573028`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"716ebee0-3d51-4e0f-b00a-f4b3042cb70b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StaticNDistance3DConvPolyhedronConvPolyhedron", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"P1_", ",", "P2_"}], "}"}], ",", " ", 
    RowBox[{"\[Epsilon]rel_:", "0.1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "w", ",", "W", ",", "Y", ",", "AB", ",", 
      RowBox[{"iter", "=", "1"}], ",", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"-", "53"}], ")"}]}]}], ",", "\[Epsilon]tol"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"GJK", "-", 
      RowBox[{
      "\:0430\:043b\:0433\:043e\:0440\:0438\:0442\:043c", " ", 
       "\:0434\:043b\:044f", " ", 
       "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f", 
       " ", "\:0447\:0438\:0441\:043b\:0435\:043d\:043d\:043e\:0433\:043e", 
       " ", "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f", 
       " ", 
       RowBox[{"(", 
        RowBox[{"GJK", " ", "numerical", " ", "distance", " ", 
         RowBox[{"alg", "."}]}], ")"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"\[Epsilon]tol", "=", 
      RowBox[{"N", "[", 
       RowBox[{"100", "\[Epsilon]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"AB", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "-", "#2"}], "&"}], ",", 
          RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], ",", 
          RowBox[{"P2", "[", "\"\<coord\>\"", "]"}], ",", "1"}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"v", "=", 
      RowBox[{"P1", "[", 
       RowBox[{"\"\<coord\>\"", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"W", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Y", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"w", "=", 
         RowBox[{"SupportVector", "[", 
          RowBox[{
           RowBox[{"-", "v"}], ",", "AB"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"Y", ",", "w"}], "]"}], " ", "||", 
           RowBox[{
            RowBox[{
             RowBox[{"v", ".", "v"}], " ", "-", 
             RowBox[{"v", ".", "w"}]}], "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"\[Epsilon]rel", "^", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{"v", ".", "v"}], ")"}]}]}]}], ",", 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"|", "v", "|", " ", 
            RowBox[{
            "\:0434\:043e\:0441\:0442\:0430\:0442\:043e\:0447\:043d\:043e", 
             " ", "\:0431\:043b\:0438\:0437\:043a\:043e", " ", "\:043f\:043e",
              " ", "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044e", " ", 
             "\:043a", " ", 
             "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044e"}]}\
], "  ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"Norm", "@", "v"}], "]"}], ";"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"Y", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"W", ",", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v", ",", "W"}], "}"}], "=", 
         RowBox[{"NextVertexAndMinSubsimplex", "[", 
          RowBox[{"Y", ",", "\[Epsilon]tol"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "@", "W"}], "==", "4"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"v", ".", "v"}], "\[LessEqual]", " ", 
             RowBox[{"\[Epsilon]tol", "*", 
              RowBox[{"Max", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Dot", ",", 
                 RowBox[{"{", 
                  RowBox[{"W", ",", "W"}], "}"}]}], "]"}]}]}]}], ")"}]}], ",",
           " ", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iter", "\[GreaterEqual]", " ", "20"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"iter", "=", 
         RowBox[{"iter", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "\t", 
      "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", "0", "]"}], ";"}]}], "\t", "\[IndentingNewLine]", 
   "\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.831540003446009*^9, 3.8315400169199877`*^9}, {
  3.831540048999228*^9, 3.831540054303049*^9}, {3.8315401902288227`*^9, 
  3.8315402202236357`*^9}, {3.8315408901830587`*^9, 3.8315409502797127`*^9}, {
  3.8315410428063602`*^9, 3.8315410578541327`*^9}, {3.831541165157276*^9, 
  3.831541251250224*^9}, {3.831541409017462*^9, 3.831541414698273*^9}, {
  3.8315414566461344`*^9, 3.8315414734362526`*^9}, {3.8315453348601665`*^9, 
  3.831545397610865*^9}},ExpressionUUID->"5b08b42e-c024-4103-951e-\
c6cfc29ffaf3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], "=", 
         RowBox[{"P10", "+", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
            RowBox[{"P1", "[", "\"\<nverts\>\"", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PolyhedronShow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P1", ",", "P2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}]}], "}"}]}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\"\<d = \>\"", 
            ",", 
            RowBox[{"StaticNDistance3DConvPolyhedronConvPolyhedron", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P1", ",", "P2"}], "}"}], ",", "0.01"}], "]"}]}], 
           "}"}], "}"}], "]"}]}], "\[IndentingNewLine]", "\t", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "0"}]}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"P3", "[", "\"\<coord\>\"", "]"}], "=", 
         RowBox[{"P30", "+", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
            RowBox[{"P3", "[", "\"\<nverts\>\"", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PolyhedronShow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P3", ",", "P2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "30"}], ",", "30"}], "}"}]}], "}"}]}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\"\<d = \>\"", 
            ",", 
            RowBox[{"StaticNDistance3DConvPolyhedronConvPolyhedron", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P3", ",", "P2"}], "}"}], ",", "0.01"}], "]"}]}], 
           "}"}], "}"}], "]"}]}], "\[IndentingNewLine]", "\t", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "0"}]}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0"}], "}"}], ",", 
         RowBox[{"-", "25"}], ",", "25", ",", "0.5"}], "}"}]}], "]"}]}], 
    "}"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.831541481226425*^9, 3.8315415466517553`*^9}, {
  3.8315415874895535`*^9, 3.8315415908376055`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"40a0478d-a72b-4c74-9b85-d74598fb526b"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      StyleBox[
       DynamicModuleBox[{$CellContext`x$$ = -21., $CellContext`y$$ = -1., \
$CellContext`z$$ = 25., Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
        Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, 
        Typeset`animvar$$ = 1, Typeset`name$$ = "\"untitled\"", 
        Typeset`specs$$ = {{{
           Hold[$CellContext`x$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`y$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`z$$], 0}, -25, 25, 0.5}}, Typeset`size$$ = {
        418., {213., 219.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
        Typeset`skipInitDone$$ = True, $CellContext`x$84563$$ = 
        0, $CellContext`y$84564$$ = 0, $CellContext`z$84565$$ = 0}, 
        DynamicBox[Manipulate`ManipulateBoxes[
         1, StandardForm, 
          "Variables" :> {$CellContext`x$$ = 0, $CellContext`y$$ = 
            0, $CellContext`z$$ = 0}, "ControllerVariables" :> {
            Hold[$CellContext`x$$, $CellContext`x$84563$$, 0], 
            Hold[$CellContext`y$$, $CellContext`y$84564$$, 0], 
            Hold[$CellContext`z$$, $CellContext`z$84565$$, 0]}, 
          "OtherVariables" :> {
           Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
            Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
            Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
            Typeset`initDone$$, Typeset`skipInitDone$$}, 
          "Body" :> ($CellContext`P1["coord"] = $CellContext`P10 + 
             ConstantArray[{$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}, 
               $CellContext`P1["nverts"]]; Grid[{{
               $CellContext`PolyhedronShow[{$CellContext`P1, \
$CellContext`P2}, {
                Axes -> True, 
                 PlotRange -> {{-30, 30}, {-30, 30}, {-30, 30}}}], "d = ", 
               $CellContext`StaticNDistance3DConvPolyhedronConvPolyhedron[{$\
CellContext`P1, $CellContext`P2}, 0.01]}}]), 
          "Specifications" :> {{{$CellContext`x$$, 0}, -25, 25, 
             0.5}, {{$CellContext`y$$, 0}, -25, 25, 
             0.5}, {{$CellContext`z$$, 0}, -25, 25, 0.5}}, "Options" :> {}, 
          "DefaultOptions" :> {}],
         ImageSizeCache->{469., {288., 294.}},
         SingleEvaluation->True],
        Deinitialization:>None,
        DynamicModuleValues:>{},
        SynchronousInitialization->True,
        UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
        UnsavedVariables:>{Typeset`initDone$$},
        UntrackedVariables:>{Typeset`size$$}], "Manipulate",
       Deployed->True,
       StripOnInput->False],
      Manipulate`InterpretManipulate[1]], 
     TagBox[
      StyleBox[
       DynamicModuleBox[{$CellContext`x$$ = -9., $CellContext`y$$ = -14.5, \
$CellContext`z$$ = 7.5, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
        Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, 
        Typeset`animvar$$ = 1, Typeset`name$$ = "\"untitled\"", 
        Typeset`specs$$ = {{{
           Hold[$CellContext`x$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`y$$], 0}, -25, 25, 0.5}, {{
           Hold[$CellContext`z$$], 0}, -25, 25, 0.5}}, Typeset`size$$ = {
        462., {213., 219.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
        Typeset`skipInitDone$$ = True, $CellContext`x$84586$$ = 
        0, $CellContext`y$84587$$ = 0, $CellContext`z$84588$$ = 0}, 
        DynamicBox[Manipulate`ManipulateBoxes[
         1, StandardForm, 
          "Variables" :> {$CellContext`x$$ = 0, $CellContext`y$$ = 
            0, $CellContext`z$$ = 0}, "ControllerVariables" :> {
            Hold[$CellContext`x$$, $CellContext`x$84586$$, 0], 
            Hold[$CellContext`y$$, $CellContext`y$84587$$, 0], 
            Hold[$CellContext`z$$, $CellContext`z$84588$$, 0]}, 
          "OtherVariables" :> {
           Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
            Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
            Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
            Typeset`initDone$$, Typeset`skipInitDone$$}, 
          "Body" :> ($CellContext`P3["coord"] = $CellContext`P30 + 
             ConstantArray[{$CellContext`x$$, $CellContext`y$$, \
$CellContext`z$$}, 
               $CellContext`P3["nverts"]]; Grid[{{
               $CellContext`PolyhedronShow[{$CellContext`P3, \
$CellContext`P2}, {
                Axes -> True, 
                 PlotRange -> {{-30, 30}, {-30, 30}, {-30, 30}}}], "d = ", 
               $CellContext`StaticNDistance3DConvPolyhedronConvPolyhedron[{$\
CellContext`P3, $CellContext`P2}, 0.01]}}]), 
          "Specifications" :> {{{$CellContext`x$$, 0}, -25, 25, 
             0.5}, {{$CellContext`y$$, 0}, -25, 25, 
             0.5}, {{$CellContext`z$$, 0}, -25, 25, 0.5}}, "Options" :> {}, 
          "DefaultOptions" :> {}],
         ImageSizeCache->{513., {288., 294.}},
         SingleEvaluation->True],
        Deinitialization:>None,
        DynamicModuleValues:>{},
        SynchronousInitialization->True,
        UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
        UnsavedVariables:>{Typeset`initDone$$},
        UntrackedVariables:>{Typeset`size$$}], "Manipulate",
       Deployed->True,
       StripOnInput->False],
      Manipulate`InterpretManipulate[1]]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.831541548713244*^9, 3.831541591771107*^9, {3.831551399833768*^9, 
   3.8315514028794327`*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"68bc8dc1-d30e-43f7-af84-96db260baa7c"]
}, Open  ]]
},
WindowSize->{1597, 997},
WindowMargins->{{-6, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 15036, 289, 676, "Input",ExpressionUUID->"a8d8d513-9518-4602-8a27-e2d3405f4d70"],
Cell[15597, 311, 2114, 49, 48, "Input",ExpressionUUID->"75d02300-3964-4cde-82f6-de245fc00b9b"],
Cell[17714, 362, 4461, 120, 86, "Input",ExpressionUUID->"36dd3cfd-a6ba-4c79-8366-4bc78ef98e08"],
Cell[22178, 484, 7812, 165, 570, "Input",ExpressionUUID->"69bd0812-c264-4887-b17e-ce086a935efb"],
Cell[29993, 651, 4168, 92, 422, "Input",ExpressionUUID->"a16074f1-012f-4092-a903-1a425420ef25"],
Cell[34164, 745, 740, 18, 67, "Input",ExpressionUUID->"c871f9de-e385-4955-b8d1-6122eb0b9cd7"],
Cell[34907, 765, 2550, 63, 270, "Input",ExpressionUUID->"0cd58331-e3d8-46cc-be32-4444a152d789"],
Cell[37460, 830, 3859, 96, 418, "Input",ExpressionUUID->"23cc6d24-dce9-4346-ada4-7cc621971267"],
Cell[CellGroupData[{
Cell[41344, 930, 586, 13, 45, "Input",ExpressionUUID->"7d202f44-0107-4999-83d5-3ce612bcf0c3"],
Cell[41933, 945, 11859, 289, 299, "Output",ExpressionUUID->"40a52975-61a2-47da-859c-1c80ecff5009"]
}, Open  ]],
Cell[53807, 1237, 18567, 417, 1161, "Input",ExpressionUUID->"52375f14-3b0f-4e81-8615-f3c01d704d95"],
Cell[CellGroupData[{
Cell[72399, 1658, 2787, 65, 123, "Input",ExpressionUUID->"abed19f7-b990-435e-b00e-062aea065a89"],
Cell[75189, 1725, 2777, 52, 545, "Output",ExpressionUUID->"7fd5b217-859a-4a85-ad06-7e7c6c55dc28"]
}, Open  ]],
Cell[77981, 1780, 8146, 194, 744, "Input",ExpressionUUID->"66919027-88ca-48a5-affa-1a75c2686e37"],
Cell[86130, 1976, 48788, 1076, 2767, "Input",ExpressionUUID->"7ed9ee63-c043-4a50-91c2-0811406c3512"],
Cell[CellGroupData[{
Cell[134943, 3056, 2376, 65, 120, "Input",ExpressionUUID->"8871d665-44fa-414e-a557-c6e57a18dc3f"],
Cell[137322, 3123, 3631, 68, 483, "Output",ExpressionUUID->"87331de1-5c24-40aa-a372-8ebfea82f75c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140990, 3196, 2709, 71, 122, "Input",ExpressionUUID->"2936e2d5-15e7-40b0-83c9-94aa03a1fd1f"],
Cell[143702, 3269, 3524, 69, 591, "Output",ExpressionUUID->"5fd7cb0f-4b3b-40a4-9689-4128628ad0df"]
}, Open  ]],
Cell[147241, 3341, 59632, 1373, 3323, "Input",ExpressionUUID->"6428e5a4-ba7f-4923-8665-5a6b62355265"],
Cell[CellGroupData[{
Cell[206898, 4718, 4097, 110, 178, "Input",ExpressionUUID->"22c16f0d-e1f9-4e56-9506-453ae960d5c4"],
Cell[210998, 4830, 4224, 77, 607, "Output",ExpressionUUID->"cb21defd-de56-48a8-8009-f9749bd41760"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215259, 4912, 5240, 143, 289, "Input",ExpressionUUID->"e17908ae-d9ed-4e6f-87e4-8d2c939bba44"],
Cell[220502, 5057, 6016, 119, 603, "Output",ExpressionUUID->"14898cf9-bdb2-4550-b7a7-95869f752323"]
}, Open  ]],
Cell[226533, 5179, 758, 20, 45, "Input",ExpressionUUID->"8b8b406f-c67e-4d2d-a696-017acd196f05"],
Cell[227294, 5201, 6036, 136, 608, "Input",ExpressionUUID->"8650bfcb-3de6-4a85-89b7-4f9f2c8a552d"],
Cell[CellGroupData[{
Cell[233355, 5341, 5397, 133, 384, "Input",ExpressionUUID->"16ed083c-f5b6-43c4-b7ca-06ba8d4880a4"],
Cell[238755, 5476, 5758, 111, 601, "Output",ExpressionUUID->"716ebee0-3d51-4e0f-b00a-f4b3042cb70b"]
}, Open  ]],
Cell[244528, 5590, 5594, 133, 609, "Input",ExpressionUUID->"5b08b42e-c024-4103-951e-c6cfc29ffaf3"],
Cell[CellGroupData[{
Cell[250147, 5727, 4885, 127, 346, "Input",ExpressionUUID->"40a0478d-a72b-4c74-9b85-d74598fb526b"],
Cell[255035, 5856, 5647, 110, 601, "Output",ExpressionUUID->"68bc8dc1-d30e-43f7-af84-96db260baa7c"]
}, Open  ]]
}
]
*)

