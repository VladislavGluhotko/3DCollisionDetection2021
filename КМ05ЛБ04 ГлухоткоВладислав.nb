(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    135097,       3072]
NotebookOptionsPosition[    130001,       2990]
NotebookOutlinePosition[    130345,       3005]
CellTagsIndexPosition[    130302,       3002]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1. \:041d\:0430\:043f\:0438\:0448\
\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:0438, \:043e\:043f\
\:0440\:0435\:0434\:0435\:043b\:044f\:044e\:0449\:0438\:0435 \:0441\:0432\
\:043e\:0439\:0441\:0442\:0432\:0430 \:043f\:043e\:043b\:0438\:044d\:0434\
\:0440\:0430 \:0438\:043b\:0438 \:0435\:0433\:043e \:043e\:0442\:043d\:043e\
\:0448\:0435\:043d\:0438\:044f \:0441 \:0433\:0435\:043e\:043c\:0435\:0442\
\:0440\:0438\:0447\:0435\:0441\:043a\:0438\:043c\:0438 \:043e\:0431\:044a\
\:0435\:043a\:0442\:0430\:043c\:0438 \:0432 \:043f\:0440\:043e\:0441\:0442\
\:0440\:0430\:043d\:0441\:0442\:0432\:0435. . \
\>", "Section",
 CellChangeTimes->{{3.699768787191681*^9, 3.699768800895378*^9}, {
   3.699773019778221*^9, 3.699773036607109*^9}, {3.699773073648346*^9, 
   3.6997731001119695`*^9}, {3.777342337806446*^9, 3.777342343714958*^9}, {
   3.812767893404801*^9, 3.8127679063774133`*^9}, 3.8127795479522505`*^9, {
   3.814528423774716*^9, 3.8145284427427936`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"28b642df-7834-4a5e-b229-b76c5bdd582c"],

Cell[CellGroupData[{

Cell[TextData[{
 "\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.1 \:041d\:0430\:043f\:0438\
\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:044e, \:0432\
\:044b\:0447\:0438\:0441\:043b\:044f\:044e\:0449\:0443\:044e \:0441\:043f\
\:0438\:0441\:043e\:043a \:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\
\:0442 \:0432\:0435\:0440\:0448\:0438\:043d i-\:0442\:043e\:0439 \:0433\:0440\
\:0430\:043d\:0438 \:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430. \:0412\
\:044b\:0445\:043e\:0434 \[Dash] \:043f\:043e\:043b\:0438\:0433\:043e\:043d, \
\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\:043d\:043e \
\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:043d\
\:044b\:0439 \:043e\:0442\:043d\:043e\:0441\:0438\:0442\:0435\:043b\:044c\
\:043d\:043e \:0432\:043d\:0435\:0448\:043d\:0435\:0439 \:043d\:043e\:0440\
\:043c\:0430\:043b\:0438, \:043f\:0440\:0435\:0434\:0441\:0442\:0430\:0432\
\:043b\:0435\:043d\:043d\:044b\:0439 \:0441\:043f\:0438\:0441\:043a\:043e\
\:043c Q= ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["q", "1"], ",", 
     SubscriptBox["q", "2"], ",", " ", "...", ",", " ", 
     SubscriptBox["q", "nGi"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7609e7dd-e947-420f-ad55-5aced6392340"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7b08950d-d0f4-4dbc-9e0e-abc566319636"],
 "} \:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442 \:0432\:0435\:0440\
\:0448\:0438\:043d i-\:0442\:043e\:0439 \:0433\:0440\:0430\:043d\:0438, \
\:043f\:0440\:0438 \:044d\:0442\:043e\:043c \:0432\:0435\:043b\:0438\:0447\
\:0438\:043d\:0430 \:0443\:0433\:043b\:0430 ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], 
    SubscriptBox["q", "2"], 
    SubscriptBox["q", "3"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "17eb1c39-cfef-4b24-9df2-08bf7b860869"],
 " \:0441\:043e\:0441\:0442\:0430\:0432\:043b\:044f\:0435\:0442 \:043c\:0435\
\:043d\:0435\:0435 180 \:0433\:0440\:0430\:0434\:0443\:0441\:043e\:0432. ."
}], "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, {
   3.812768538012515*^9, 3.812768564362065*^9}, {3.812769321854453*^9, 
   3.8127693325649843`*^9}, {3.812769950274976*^9, 3.812769959642497*^9}, {
   3.8127710940175095`*^9, 3.812771106800135*^9}, {3.8127746119321566`*^9, 
   3.812774621015869*^9}, {3.812778743871883*^9, 3.812778750252804*^9}, 
   3.812779231637751*^9, {3.812779592141118*^9, 3.812779600920615*^9}, {
   3.8145284612302694`*^9, 3.814528497207673*^9}, {3.814528544495632*^9, 
   3.8145285808682146`*^9}, {3.8145290440401435`*^9, 3.814529045607963*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"d970f10b-d87d-46b0-830b-9527464b182e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmPolyhedronFaceToSurface", "[", 
   RowBox[{"vertcoord_List", ",", "face_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "=", 
       RowBox[{"Transpose", "@", "vertcoord"}]}], ",", "V", ",", "e1", ",", 
      "e2", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\:041f\:0430\:0440\:0430\:043b\:043b\:0435\:043b\:044c\:043d\:044b\:0439\
", " ", "\:043f\:0435\:0440\:0435\:043d\:043e\:0441", " ", "\:043a", " ", 
      "\:043d\:0430\:0447\:0430\:043b\:0443", " ", 
      "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442"}], " ", "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"[", "face", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", 
          RowBox[{"First", "@", 
           RowBox[{"P", "[", 
            RowBox[{"[", "face", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
       RowBox[{"P", "[", 
        RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0412\:0435\:043a\:0442\:043e\:0440\:044b", " ", "\:043d\:0430", " ", 
       "\:0440\:0435\:0431\:0440\:0430\:0445", " ", 
       "\:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430", " ", "\:0432", " ",
        "\:0441\:0442\:0430\:0440\:043e\:043c", " ", 
       "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Most", "@", "#"}], "-", 
          RowBox[{"Rest", "@", "#"}]}], ")"}], "&"}], "@", 
       RowBox[{"P", "[", 
        RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:041f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435", " ", 
       "\:043d\:043e\:0432\:043e\:0433\:043e", " ", 
       "\:0431\:0430\:0437\:0438\:0441\:0430"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "@", "V"}], ",", 
        RowBox[{"First", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Rest", "@", "V"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"MatrixRank", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "@", "V"}], ",", "#"}], "}"}], "]"}], ">", 
             "1"}], "&"}], ",", "1"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:041e\:0440\:0442\:043e\:0433\:043e\:043d\:0430\:043b\:0438\:0437\
\:0430\:0446\:0438\:044f", " ", "\:0413\:0440\:0430\:043c\:0430", " ", 
       "\:0438", " ", 
       "\:043d\:043e\:0440\:043c\:0430\:043b\:0438\:0437\:0430\:0446\:0438\
\:044f"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"e1", ",", 
        RowBox[{"e2", "-", 
         RowBox[{
          RowBox[{
           RowBox[{"e1", ".", "e2"}], "/", 
           RowBox[{"e1", ".", "e1"}]}], "*", "e1"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1", ",", "e2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e1", "/", 
         RowBox[{"Norm", "@", "e1"}]}], ",", 
        RowBox[{"e2", "/", 
         RowBox[{"Norm", "@", "e2"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e3", "=", 
      RowBox[{"Cross", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:041a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b", " ", 
       "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
       "\:0433\:0440\:0430\:043d\:0438", " ", "\:0432", " ", 
       "\:043d\:043e\:0432\:043e\:043c", " ", 
       "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"#", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"{", 
            RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}], "]"}]}], ",", "2"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"P", "[", 
       RowBox[{"[", "face", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzF9I03EABPApMt1wa24xK9dA2WapaMOtcrVFKebMMnOWmSVJsdGqxYQp
5IpYhaT5ohMpCiwzc5XKpptJbG5kZjZK2ZKIopnO/EsE0gKh330fjs/DcZdc
bTh2PppGo8moQJrGGXHol/YXTXlpA5Tz6igWPKtISIFS+cFUqJsY2QY9jhUl
dHrcuVD09FIpZBUklkE62xuG166Y5+HVIHsFxsnDq2TvbIvA40HWOmR6vzUO
UmYkDjXBWkFI5KR8cGpYDLWN0/dgw0x+Jwy+kPZAh0b8HJrMI32wojTHDYen
Qj74vah8EkYFMubgxkHlbyix3Y/AUW/bP8gwCHguyoUsXiJcsnGSIFvLEUBP
7vV0aPz8kvg3IZQNZbwhFTzTJ1aTfqyWeMCaUgbXT+eXw65dxri3+BMtEunL
hp5xyo+xVhsURJLo7ynX3ui4UMMs5MNbVvlWuGN2WQr9ug3ZsNgyp4LuH3VH
YJNpsx4GNWvEQKHABGVhSz28LUm+CUU7xQ2wMiemFS7YOURfla5jgtLiLnwG
m9ld/XBaMkAsSd/+Gr5qOeeGPle7D66crByFe5trx2HrPr4fxszEhmBaoOIX
3G20L0PTlier8Eumlv6B8m7eIrH1cHc8rGmvZsELLXouTKt/R6yLr9oEH2XW
EM1CkQL+vNivhNYsYS7k8Ivz4Q3r4w54aF7UCU8wmHF+yodFnniouvxHAdV+
zR44xLAfhb0MZgnMvJPqg2FXL/HrLHMCCse4xEB0d94nSttkTgH8D5RCtFc=

  "],
 CellLabel->
  "In[1973]:=",ExpressionUUID->"062c0354-0964-4644-a4f3-655530e55547"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kmGetPolyhedronFace", "[", 
    RowBox[{"vertcoord_List", ",", "face_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"F", ",", 
       RowBox[{"l", "=", 
        RowBox[{"Length", "@", "face"}]}], ",", 
       RowBox[{"V", "=", 
        RowBox[{"kmPolyhedronFaceToSurface", "[", 
         RowBox[{"vertcoord", ",", "face"}], "]"}]}], ",", "X", ",", "Y", ",",
        "pos"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"F", "=", 
       RowBox[{
        RowBox[{"Range", "[", "l", "]"}], "//", 
        RowBox[{"Append", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:041e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:0435", 
         " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0430", " ", 
         RowBox[{"\:043e\:0431\:0445\:043e\:0434\:0430", ":", " ", 
          RowBox[{
          "\:0435\:0441\:043b\:0438", " ", "\:043e\:0431\:0445\:043e\:0434", 
           " ", "\:043e\:0442\:0440\:0438\:0446\:0430\:0442\:0435\:043b\:044c\
\:043d\:044b\:0439"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "\:0442\:043e", " ", "\:0433\:0440\:0430\:043d\:044c", " ", 
          "\:043e\:0442\:0440\:0430\:0436\:0430\:0435\:043c", " ", 
          RowBox[{
          "\:0441\:0438\:043c\:043c", ".", " ", "\:043e\:0442\:043d", ".", 
           " ", "X"}]}], "-", 
         RowBox[{"\:043e\:0441\:0438", " ", 
          RowBox[{"(", 
           RowBox[{"y", " ", "\[Rule]", " ", 
            RowBox[{"-", "y"}]}], ")"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Most", "[", 
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      RowBox[{"Y", "=", 
       RowBox[{"Most", "[", 
        RowBox[{"V", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Total", "@", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Most", "@", "X"}], ",", 
               RowBox[{"Rest", "@", "Y"}]}], "}"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "*", 
           RowBox[{"Y", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{"Total", "@", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Rest", "@", "X"}], ",", 
               RowBox[{"Most", "@", "Y"}]}], "}"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"Y", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], "<", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{"V", "*", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"Length", "@", "V"}]}], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:041d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435", " ", 
         "\:043f\:0435\:0440\:0432\:043e\:0433\:043e", " ", 
         "\:043f\:043e\:043f\:0430\:0432\:0448\:0435\:0433\:043e\:0441\:044f",
          " ", "\:0443\:0433\:043b\:0430"}], ",", " ", 
        RowBox[{"\:0438\:043c\:0435\:044e\:0449\:0435\:0433\:043e", "..."}]}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "@", 
        RowBox[{"First", "@", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"List", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"F", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "3"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Take", "[", 
                RowBox[{"F", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Take", "[", 
                RowBox[{"F", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"x_", "/;", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"x", "===", " ", "List"}], ",", "False", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Det", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#2", "-", "#1"}], ",", 
                    RowBox[{"#3", "-", "#2"}]}], "}"}], "]"}], "&"}], "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"V", "[", 
                  RowBox[{"[", "x", "]"}], "]"}]}], "]"}], ">", "0"}]}], 
             "]"}]}], ",", "1", ",", "1"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"\:041d\:0430", " ", "\:0432\:044b\:0445\:043e\:0434\:0435"}],
         " ", "-", " ", 
        RowBox[{
        "\:0433\:0440\:0430\:043d\:044c", " ", "\:043f\:0440\:0438", " ", 
         "\:0432\:0437\:0433\:043b\:044f\:0434\:0435", " ", "\:0441\:043e", 
         " ", "\:0441\:0442\:043e\:0440\:043e\:043d\:044b", " ", 
         "\:0432\:043d\:0435\:0448\:043d\:0435\:0439", " ", 
         "\:043d\:043e\:0440\:043c\:0430\:043b\:0438", " ", "\:0438", " ", 
         "\:043d\:043e\:043c\:0435\:0440\:0430", " ", 
         "\:0432\:0435\:0440\:0448\:0438\:043d"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"Transpose", "[", "vertcoord", "]"}], "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], "@", 
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"face", ",", 
           RowBox[{"Rest", "@", "face"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pos", ",", 
           RowBox[{"pos", "+", "l", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.814539484365218*^9, 3.8145394958743825`*^9}, 
   3.814541652278888*^9, 3.814542812339297*^9, {3.8145429832106185`*^9, 
   3.814543118467157*^9}, {3.8145431737947745`*^9, 3.814543183805554*^9}, {
   3.8145432209469457`*^9, 3.8145432874272795`*^9}, {3.8145433477391973`*^9, 
   3.814543352226832*^9}, {3.8145433991709647`*^9, 3.814543400690629*^9}, {
   3.8145434411960588`*^9, 3.814543459514557*^9}, {3.8145434941783257`*^9, 
   3.8145435473862934`*^9}, {3.8145436189496317`*^9, 3.814543641146269*^9}, {
   3.814543687709167*^9, 3.8145436974599905`*^9}, {3.814543733397743*^9, 
   3.8145437689639397`*^9}, {3.8145438320947447`*^9, 
   3.8145439120744476`*^9}, {3.8145441031482415`*^9, 3.814544157690527*^9}, {
   3.814544452948533*^9, 3.8145444670109153`*^9}, {3.814544556570731*^9, 
   3.814544629698929*^9}, {3.814544852220502*^9, 3.814544853547048*^9}, {
   3.814544895700808*^9, 3.814544897075135*^9}, {3.814545004372452*^9, 
   3.8145450256356807`*^9}, {3.814545161532631*^9, 3.814545166859405*^9}, {
   3.814545305877385*^9, 3.81454543892385*^9}, {3.8145455088429146`*^9, 
   3.8145455235963507`*^9}, {3.8145457851877813`*^9, 3.81454587473199*^9}, {
   3.8145459247022085`*^9, 3.814545971203436*^9}, {3.8145479730844755`*^9, 
   3.814548028467121*^9}, {3.814552106309222*^9, 3.8145521469386525`*^9}, {
   3.8146027696443157`*^9, 3.8146027746176157`*^9}, {3.81460309617709*^9, 
   3.8146031431142855`*^9}, {3.814604992114867*^9, 3.8146049965234113`*^9}, {
   3.8146050631875114`*^9, 3.8146051606261945`*^9}, {3.8146052495796223`*^9, 
   3.8146052547867284`*^9}, {3.814616389384232*^9, 3.8146163902871857`*^9}, {
   3.814616429692835*^9, 3.81461645453487*^9}, {3.8146165024403343`*^9, 
   3.8146165435607443`*^9}, {3.814616639872409*^9, 3.8146166461118393`*^9}, {
   3.814616702840227*^9, 3.8146169404794717`*^9}, {3.8146170264324217`*^9, 
   3.8146170269669685`*^9}, {3.8146172605043707`*^9, 3.814617281073078*^9}, {
   3.8146175669224195`*^9, 3.8146175725123515`*^9}, {3.81462387881116*^9, 
   3.8146238807919416`*^9}, {3.814623985751172*^9, 3.8146240212633243`*^9}, {
   3.8146241716869974`*^9, 3.8146241931118336`*^9}, {3.8146242954241395`*^9, 
   3.8146243201521235`*^9}, {3.8146243908879457`*^9, 3.814624420448741*^9}, {
   3.814624455921114*^9, 3.814624466697448*^9}, {3.814624637265664*^9, 
   3.8146246485615172`*^9}, {3.8146248918274384`*^9, 3.814624980898059*^9}, {
   3.8146250763715367`*^9, 3.8146251079463825`*^9}, {3.8146256069476757`*^9, 
   3.814625667634589*^9}, {3.814625709098819*^9, 3.8146257822028847`*^9}, {
   3.8146321140909595`*^9, 3.8146321608025503`*^9}},
 CellLabel->
  "In[1974]:=",ExpressionUUID->"1e9a72d5-195f-45f4-97c7-aef243d5c85e"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:043a\:0430 :", "Text",
 CellChangeTimes->{{3.814547626724498*^9, 
  3.814547643234553*^9}},ExpressionUUID->"7bb8d145-dfb3-412e-bb81-\
67c963f17a10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"11", ",", "10", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", 
        FractionBox["25", "2"], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "15", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "14"}], ",", "5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", 
        RowBox[{"-", "5"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7.45"}], ",", "1", ",", 
        RowBox[{"-", "2.35"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7.9"}], ",", "7", ",", 
        RowBox[{"-", "3.7"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "6"}], ",", "15", ",", 
        RowBox[{"-", "10"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "7", ",", "6", ",", "5", ",", "4", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "6", ",", "7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7", ",", "8", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "8", ",", "3", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "8", ",", "4", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PT", " ", "=", " ", 
   RowBox[{"Transpose", "@", "P"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PP", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"kmPolyhedronFaceToSurface", "[", 
      RowBox[{"P", ",", "#"}], "]"}], "&"}], "/@", "G"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.814627734590618*^9, 3.8146277704839168`*^9}, {
  3.8146278037982645`*^9, 3.8146278160668387`*^9}, {3.814627911755357*^9, 
  3.814627920810567*^9}, {3.8146279509313164`*^9, 3.814628033882922*^9}, {
  3.8146281332112703`*^9, 3.814628147444256*^9}, {3.8146282201170273`*^9, 
  3.814628223755368*^9}, {3.814632271264215*^9, 3.814632323327325*^9}, {
  3.8146327372016573`*^9, 3.8146327374722676`*^9}},
 CellLabel->
  "In[1975]:=",ExpressionUUID->"66ddde72-8aac-4971-a42c-0a1c6fb850f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Tooltip", "/@", 
            RowBox[{"Point", "/@", 
             RowBox[{"PP", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], ",", 
           RowBox[{"Line", "@", 
            RowBox[{"PP", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"G", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "i"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"PP", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "i"}], "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0.75", ",", "0.75"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"PP", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "-", "1"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
      "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", 
         "\[IndentingNewLine]", "     ", 
         RowBox[{"Tooltip", "/@", 
          RowBox[{"Point", "/@", "PT"}]}], ",", "\[IndentingNewLine]", 
         "     ", "Blue", ",", " ", 
         RowBox[{"Point", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "3", ",", "1"}], "}"}]}], ",", "Black", 
         ",", "\[IndentingNewLine]", "      ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "@", 
             RowBox[{"PT", "[", 
              RowBox[{"[", 
               RowBox[{"G", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "G"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "      ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"PT", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "}"}]}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "PT"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "}"}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8145460318514004`*^9, 3.814546108274602*^9}, {
   3.814546141243408*^9, 3.814546209546884*^9}, {3.8145462504194613`*^9, 
   3.81454642698711*^9}, {3.814546465629243*^9, 3.8145465097476196`*^9}, {
   3.8145466411322927`*^9, 3.81454665624293*^9}, {3.8145469513174663`*^9, 
   3.8145469576907215`*^9}, {3.8145469933245964`*^9, 
   3.8145470075722203`*^9}, {3.814547119131287*^9, 3.81454715274663*^9}, {
   3.8145473042454157`*^9, 3.8145473065554457`*^9}, {3.8145473572921925`*^9, 
   3.814547400899522*^9}, {3.814550583514966*^9, 3.814550633412074*^9}, {
   3.8145563846996374`*^9, 3.8145564589125137`*^9}, {3.8145577438426437`*^9, 
   3.81455775086438*^9}, {3.814605392684985*^9, 3.8146054031953444`*^9}, {
   3.814605440427391*^9, 3.8146054777394524`*^9}, {3.8146055120917807`*^9, 
   3.81460559173197*^9}, {3.814606031685501*^9, 3.8146060846766024`*^9}, {
   3.8146062659260664`*^9, 3.814606453363804*^9}, {3.8146064921727777`*^9, 
   3.814606567981304*^9}, 3.814607302160222*^9, {3.8146073531738806`*^9, 
   3.814607354469998*^9}, 3.8146074270776243`*^9, {3.8146075230414352`*^9, 
   3.814607596526103*^9}, 3.814607688311672*^9, {3.8146077547190914`*^9, 
   3.81460780054204*^9}, 3.8146080063580265`*^9, 3.814608176615475*^9, 
   3.8146082209512973`*^9, {3.81460897873691*^9, 3.814608978862604*^9}, {
   3.814612478374874*^9, 3.8146125487869587`*^9}, {3.8146132688958516`*^9, 
   3.814613329820691*^9}, {3.8146134749816713`*^9, 3.8146134881323905`*^9}, {
   3.8146135346176176`*^9, 3.8146136573911295`*^9}, {3.8146136888648415`*^9, 
   3.8146137472248325`*^9}, 3.81461382797764*^9, {3.8146138590539417`*^9, 
   3.8146138710702176`*^9}, {3.8146141363828783`*^9, 3.8146141499198427`*^9}, 
   3.8146142448244724`*^9, 3.8146150578414745`*^9, {3.81461516511152*^9, 
   3.8146151706482153`*^9}, 3.8146153070718727`*^9, 3.814615685472456*^9, {
   3.8146177628678617`*^9, 3.8146178537311015`*^9}, {3.8146179075546627`*^9, 
   3.814617912618781*^9}, 3.814617963703536*^9, {3.814618005081991*^9, 
   3.814618027114215*^9}, {3.814620911341402*^9, 3.814620952917268*^9}, {
   3.814620988301478*^9, 3.814620988614603*^9}, {3.814624749779868*^9, 
   3.8146248473775215`*^9}, {3.814625011323152*^9, 3.814625011538046*^9}, 
   3.8146272011415434`*^9, 3.8146272971412196`*^9, {3.8146273426136475`*^9, 
   3.8146273441320972`*^9}, {3.8146274442225437`*^9, 3.8146274527240925`*^9}, 
   3.8146275909021997`*^9, 3.8146282806873503`*^9, {3.8146284989017515`*^9, 
   3.814628512741626*^9}, {3.8146294875586863`*^9, 3.814629505651518*^9}, 
   3.8146295866326847`*^9, {3.8146296361432486`*^9, 3.8146296575665913`*^9}, {
   3.8146296884164715`*^9, 3.8146296910691643`*^9}, {3.814629735158924*^9, 
   3.8146297376572824`*^9}, {3.8146299950261803`*^9, 3.814629997297555*^9}, {
   3.8146301824535613`*^9, 3.814630188069504*^9}, {3.814630312648156*^9, 
   3.81463031631672*^9}, 3.8146308672659893`*^9, {3.814632330842872*^9, 
   3.814632352706275*^9}, {3.814632391323251*^9, 3.8146324028727045`*^9}, {
   3.8146326424010353`*^9, 3.8146326658021975`*^9}, {3.8146327250601206`*^9, 
   3.8146327313696017`*^9}, {3.8146372255121727`*^9, 
   3.8146372500305986`*^9}, {3.8146372926014166`*^9, 
   3.8146372933041677`*^9}, {3.814637324344799*^9, 3.8146373361023865`*^9}, {
   3.814637369968649*^9, 3.814637396311911*^9}, {3.814637478737661*^9, 
   3.8146375429770927`*^9}, {3.81463766740082*^9, 3.8146377070080814`*^9}, 
   3.8146386764603767`*^9, {3.8146394051066704`*^9, 3.8146394273800735`*^9}},
 CellLabel->
  "In[1979]:=",ExpressionUUID->"c5fadade-00e3-4f5b-be67-a4107422eaac"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[
      {PointSize[0.025], {
        TagBox[
         TooltipBox[PointBox[{0., 0.}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"0.`", ",", "0.`"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{0., 0.}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-10.358571330062848`, 4.440892098500626*^-16}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "10.358571330062848`"}], ",", 
                "4.440892098500626`*^-16"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-10.358571330062848`, 4.440892098500626*^-16}], 
          "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-15.730933813921165`, -3.026998735056174}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "15.730933813921165`"}], ",", 
                RowBox[{"-", "3.026998735056174`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-15.730933813921165`, -3.026998735056174}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-21.103296297779483`, -6.053997470112349}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "21.103296297779483`"}], ",", 
                RowBox[{"-", "6.053997470112349`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-21.103296297779483`, -6.053997470112349}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-20.137912203645012`, 9.080996205168528}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "20.137912203645012`"}], ",", 
                "9.080996205168528`"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-20.137912203645012`, 9.080996205168528}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{0., 0.}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"0.`", ",", "0.`"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{0., 0.}], "Tooltip"]& ]}, 
       LineBox[{{0., 0.}, {-10.358571330062848`, 
        4.440892098500626*^-16}, {-15.730933813921165`, -3.026998735056174}, \
{-21.103296297779483`, -6.053997470112349}, {-20.137912203645012`, 
        9.080996205168528}, {0., 0.}}], InsetBox["8", {0.75, 0.75}], 
       InsetBox["7", {-9.608571330062848, 0.7500000000000004}], 
       InsetBox["6", {-14.980933813921165, -2.276998735056174}], 
       InsetBox["5", {-20.353296297779483, -5.303997470112349}], 
       InsetBox["4", {-19.387912203645012, 9.830996205168528}]},
      Axes->True,
      ImageSize->Medium], 
     Graphics3DBox[
      {PointSize[0.025], {
        TagBox[
         TooltipBox[Point3DBox[{11, 10, 3}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"11", ",", "10", ",", "3"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{11, 10, 3}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          Point3DBox[NCache[{10, Rational[25, 2], 5}, {10, 12.5, 5}]],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"10", ",", 
                FractionBox["25", "2"], ",", "5"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{10, 
            Rational[25, 2], 5}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{9, 15, 7}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"9", ",", "15", ",", "7"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{9, 15, 7}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-14, 5, 8}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "14"}], ",", "5", ",", "8"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-14, 5, 8}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-7, -5, -1}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "7"}], ",", 
                RowBox[{"-", "5"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-7, -5, -1}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-7.45, 1, -2.35}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "7.45`"}], ",", "1", ",", 
                RowBox[{"-", "2.35`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-7.45, 1, -2.35}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-7.9, 7, -3.7}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "7.9`"}], ",", "7", ",", 
                RowBox[{"-", "3.7`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-7.9, 7, -3.7}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-6, 15, -10}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "6"}], ",", "15", ",", 
                RowBox[{"-", "10"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-6, 15, -10}], "Tooltip"]& ]}, 
       {RGBColor[0, 0, 1], Point3DBox[{-2, 3, 1}]}, 
       {GrayLevel[0], 
        Line3DBox[
         NCache[{{11, 10, 3}, {10, Rational[25, 2], 5}, {9, 15, 7}, {-14, 5, 
           8}, {-7, -5, -1}, {11, 10, 3}}, {{11, 10, 3}, {10, 12.5, 5}, {9, 
           15, 7}, {-14, 5, 8}, {-7, -5, -1}, {11, 10, 3}}]], 
        Line3DBox[{{-6, 15, -10}, {-7.9, 7, -3.7}, {-7.45, 1, -2.35}, {-7, -5,
           -1}, {-14, 5, 8}, {-6, 15, -10}}], 
        Line3DBox[{{11, 10, 
          3}, {-7, -5, -1}, {-7.45, 1, -2.35}, {-7.9, 7, -3.7}, {11, 10, 3}}],
         Line3DBox[{{11, 10, 3}, {-7.9, 7, -3.7}, {-6, 15, -10}, {11, 10, 
          3}}], Line3DBox[
         NCache[{{11, 10, 3}, {-6, 15, -10}, {9, 15, 7}, {
           10, Rational[25, 2], 5}, {11, 10, 3}}, {{11, 10, 3}, {-6, 
           15, -10}, {9, 15, 7}, {10, 12.5, 5}, {11, 10, 3}}]], 
        Line3DBox[{{9, 15, 7}, {-6, 15, -10}, {-14, 5, 8}, {9, 15, 7}}], 
        Text3DBox["1", {11.75, 10.75, 3.75}], 
        Text3DBox["2", {10.75, 13.25, 5.75}], 
        Text3DBox["3", {9.75, 15.75, 7.75}], 
        Text3DBox["4", {-13.25, 5.75, 8.75}], 
        Text3DBox["5", {-6.25, -4.25, -0.25}], 
        Text3DBox["6", {-6.7, 1.75, -1.6}], 
        Text3DBox["7", {-7.15, 7.75, -2.95}], 
        Text3DBox["8", {-5.25, 15.75, -9.25}]}},
      Axes->True,
      ImageSize->Medium]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.814632666546548*^9, 3.814632739412833*^9, {3.814637238374202*^9, 
   3.8146372505077353`*^9}, {3.8146372825786934`*^9, 
   3.8146372979905334`*^9}, {3.8146373287184615`*^9, 
   3.8146373364903507`*^9}, {3.8146373709438677`*^9, 3.814637396793682*^9}, {
   3.814637442966668*^9, 3.8146375434392557`*^9}, {3.8146376502566247`*^9, 
   3.8146377073607635`*^9}, 3.8146386776725082`*^9, {3.814639406179802*^9, 
   3.814639427962182*^9}, 3.814720448821103*^9},
 CellLabel->
  "Out[1979]=",ExpressionUUID->"839fff48-3e9f-4f21-a815-02b8cfc90f77"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"G", "[", 
  RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"kmPolyhedronFaceToSurface", "[", 
  RowBox[{"P", ",", 
   RowBox[{"G", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"kmGetPolyhedronFace", "[", 
  RowBox[{"P", ",", 
   RowBox[{"G", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8146126313503695`*^9, 3.8146126642972665`*^9}, {
   3.8146139244863806`*^9, 3.8146139362298365`*^9}, 3.8146173158421745`*^9, {
   3.814617386921524*^9, 3.8146173975839663`*^9}, {3.8146175367440815`*^9, 
   3.814617542944626*^9}, {3.8146175780736723`*^9, 3.814617578224271*^9}, 
   3.8146182450351825`*^9, {3.814618282426399*^9, 3.814618285840187*^9}, {
   3.8146183267772765`*^9, 3.814618334671855*^9}, {3.8146184657865567`*^9, 
   3.8146184701693287`*^9}, {3.814618757226863*^9, 3.8146187661051855`*^9}, {
   3.814618796802642*^9, 3.8146188075610065`*^9}, {3.814627384684845*^9, 
   3.8146273865233784`*^9}, {3.8146283004936714`*^9, 3.81462830432465*^9}},
 CellLabel->
  "In[1980]:=",ExpressionUUID->"09866175-5ca3-4c1d-a862-f45bd11f6782"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "7", ",", "6", ",", "5", ",", "4", ",", "8"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8146183282503295`*^9, 3.8146183359810143`*^9}, 
   3.814618471050972*^9, 3.8146185690800953`*^9, 3.8146186680341196`*^9, {
   3.814618739253228*^9, 3.8146187666908455`*^9}, {3.8146188015682526`*^9, 
   3.8146188084506454`*^9}, 3.8146272823989487`*^9, 3.814627387134934*^9, {
   3.8146282960449724`*^9, 3.814628304749385*^9}, 3.814720448872965*^9},
 CellLabel->
  "Out[1980]=",ExpressionUUID->"cf936107-9c38-426c-98ea-83fa2dc22060"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "10.358571330062848`"}], ",", "4.440892098500626`*^-16"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "15.730933813921165`"}], ",", 
     RowBox[{"-", "3.026998735056174`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "21.103296297779483`"}], ",", 
     RowBox[{"-", "6.053997470112349`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "20.137912203645012`"}], ",", "9.080996205168528`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8146183282503295`*^9, 3.8146183359810143`*^9}, 
   3.814618471050972*^9, 3.8146185690800953`*^9, 3.8146186680341196`*^9, {
   3.814618739253228*^9, 3.8146187666908455`*^9}, {3.8146188015682526`*^9, 
   3.8146188084506454`*^9}, 3.8146272823989487`*^9, 3.814627387134934*^9, {
   3.8146282960449724`*^9, 3.814628304749385*^9}, 3.814720448877952*^9},
 CellLabel->
  "Out[1981]=",ExpressionUUID->"2c23d5dc-3b65-4d46-a66f-33211e365419"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6", ",", "5", ",", "4", ",", "8", ",", "7", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "7.45`"}], ",", "1", ",", 
       RowBox[{"-", "2.35`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "7"}], ",", 
       RowBox[{"-", "5"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "14"}], ",", "5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", "15", ",", 
       RowBox[{"-", "10"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "7.9`"}], ",", "7", ",", 
       RowBox[{"-", "3.7`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "7.45`"}], ",", "1", ",", 
       RowBox[{"-", "2.35`"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8146183282503295`*^9, 3.8146183359810143`*^9}, 
   3.814618471050972*^9, 3.8146185690800953`*^9, 3.8146186680341196`*^9, {
   3.814618739253228*^9, 3.8146187666908455`*^9}, {3.8146188015682526`*^9, 
   3.8146188084506454`*^9}, 3.8146272823989487`*^9, 3.814627387134934*^9, {
   3.8146282960449724`*^9, 3.814628304749385*^9}, 3.8147204488849335`*^9},
 CellLabel->
  "Out[1982]=",ExpressionUUID->"6c610438-7bd6-45c2-92d8-6b2979a022cf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.2 \:041d\:0430\:043f\:0438\
\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:044e, \:0432\
\:044b\:0447\:0438\:0441\:043b\:044f\:044e\:0449\:0443\:044e \:0432\:043d\
\:0435\:0448\:043d\:044e\:044e \:043d\:043e\:0440\:043c\:0430\:043b\:044c \
\:043a i-\:0442\:043e\:0439 \:0433\:0440\:0430\:043d\:0438 \:043f\:043e\:043b\
\:0438\:044d\:0434\:0440\:0430. \:0415\:0441\:043b\:0438 \:0433\:0440\:0430\
\:043d\:044c \:043f\:0440\:0435\:0434\:0441\:0442\:0430\:0432\:043b\:0435\
\:043d\:0430 \:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\
\:043d\:043e \:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:043e\:0439 \:0433\:043b\:044f\:0434\:044f \:0441 \:043a\
\:043e\:043d\:0446\:0430 \:0432\:043d\:0435\:0448\:043d\:0435\:0439 \:043d\
\:043e\:0440\:043c\:0430\:043b\:0438 (\:043e\:0431\:0445\:043e\:0434 \:0432\
\:0435\:0440\:0448\:0438\:043d \:043f\:0440\:043e\:0442\:0438\:0432 \:0447\
\:0430\:0441\:043e\:0432\:043e\:0439 \:0441\:0442\:0440\:0435\:043b\:043a\
\:0438, \:043f\:0440\:0438 \:043e\:0431\:0445\:043e\:0434\:0435 \:043e\:0431\
\:043b\:0430\:0441\:0442\:044c \:043e\:0441\:0442\:0430\:0435\:0442\:0441\
\:044f \:0441\:043b\:0435\:0432\:0430) \:0438 \:0432\:0435\:043b\:0438\:0447\
\:0438\:043d\:0430 \:0443\:0433\:043b\:0430 ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], 
    SubscriptBox["q", "2"], 
    SubscriptBox["q", "3"]}], TraditionalForm]],ExpressionUUID->
  "c4c9c350-c87e-4495-9f95-766dfd69259f"],
 " \:043c\:0435\:043d\:0435\:0435 180 \:0433\:0440\:0430\:0434\:0443\:0441\
\:043e\:0432, \:0442\:043e \:0432\:043d\:0435\:0448\:043d\:044f\:044f \:043d\
\:043e\:0440\:043c\:0430\:043b\:044c \:043f\:043e\:043b\:0438\:044d\:0434\
\:0440\:0430 \:043a \:0433\:0440\:0430\:043d\:0438 \:043c\:043e\:0436\:0435\
\:0442 \:0431\:044b\:0442\:044c \:0432\:044b\:0447\:0438\:0441\:043b\:0435\
\:043d\:0430 \:043a\:0430\:043a \:0432\:0435\:043a\:0442\:043e\:0440\:043d\
\:043e\:0435 \:043f\:0440\:043e\:0438\:0437\:0432\:0435\:0434\:0435\:043d\
\:0438\:0435 \:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432 ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", " ", "=", " ", 
    RowBox[{"V", " ", "x", " ", "W"}]}], TraditionalForm]],ExpressionUUID->
  "a0248f97-d21e-44d8-92f2-9a43a31a8097"],
 ", \:0433\:0434\:0435  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "=", " ", 
    RowBox[{
     SubscriptBox["q", "2"], "-", 
     SubscriptBox["q", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "21bc5c66-6bbc-4e76-9bc0-68ddd3326cdb"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", " ", "=", " ", 
    RowBox[{
     SubscriptBox["q", 
      RowBox[{"3", " "}]], "-", " ", 
     SubscriptBox["q", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "a0294410-bd84-4aa3-8f7a-83309640314c"],
 ", \:0430 \:0442\:043e\:0447\:043a\:0438 ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "d107d170-8c95-4698-bb9f-3350f00d8dac"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "2"], TraditionalForm]],ExpressionUUID->
  "466b885e-f5cc-4489-80a6-4349b957efd2"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["q", "3"], TraditionalForm]],ExpressionUUID->
  "a397225c-d564-4dfa-92a5-f06a313d49ed"],
 " - \:043f\:043e\:0434\:0440\:044f\:0434 \
\:0438\:0434\:0443\:0449\:0438\:0435 \:0432\:0435\:0440\:0448\:0438\:043d\
\:044b \:0433\:0440\:0430\:043d\:0438 \:043f\:043e\:043b\:0438\:044d\:0434\
\:0440\:0430."
}], "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, {
   3.812768538012515*^9, 3.812768564362065*^9}, {3.812769321854453*^9, 
   3.8127693325649843`*^9}, {3.812769950274976*^9, 3.812769959642497*^9}, {
   3.8127710940175095`*^9, 3.812771106800135*^9}, {3.8127746119321566`*^9, 
   3.812774621015869*^9}, {3.812778743871883*^9, 3.812778750252804*^9}, 
   3.812779231637751*^9, {3.812779592141118*^9, 3.812779600920615*^9}, {
   3.8145284612302694`*^9, 3.814528497207673*^9}, {3.814528544495632*^9, 
   3.8145285808682146`*^9}, {3.8145290440401435`*^9, 3.814529045607963*^9}, 
   3.8145476584434285`*^9, {3.8145476896558266`*^9, 3.8145477182924705`*^9}, {
   3.814547750383865*^9, 3.8145479283942766`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"d22ac87c-2852-4c7a-8b81-24fb5c24a630"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmGetPolyhedronFaceNorm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vertcoord_List", ",", "faces_List"}], "}"}], ",", "i_Integer"}],
    "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"#2", "-", "#1"}], ",", 
      RowBox[{"#3", "-", "#2"}]}], "]"}], "&"}], "[", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"kmGetPolyhedronFace", "[", 
        RowBox[{"vertcoord", ",", 
         RowBox[{"faces", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "3"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8145501606998763`*^9, 3.8145501955779266`*^9}, {
  3.814550244249682*^9, 3.814550329138361*^9}, {3.8145503688087687`*^9, 
  3.8145503996013927`*^9}, {3.814550472489846*^9, 3.814550480706564*^9}, {
  3.814550521643429*^9, 3.81455056020934*^9}, {3.814623261182953*^9, 
  3.814623275334264*^9}},
 CellLabel->
  "In[1983]:=",ExpressionUUID->"8aa5b540-9ba0-44db-83c6-285e325198b6"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:043a\:0430 :", "Text",
 CellChangeTimes->{{3.8145509927941685`*^9, 
  3.8145510058066626`*^9}},ExpressionUUID->"cef2d120-37b7-40b2-b8b9-\
96170c3b078b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", " ", "=", 
    RowBox[{"kmGetPolyhedronFaceNorm", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"P", ",", "G"}], "}"}], ",", "2"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"n", "=", 
  RowBox[{"n", "/", 
   RowBox[{"Norm", "@", "n"}]}]}]}], "Input",
 CellChangeTimes->{{3.814550402962425*^9, 3.814550448136936*^9}, {
   3.8146208962435613`*^9, 3.81462089830686*^9}, {3.8146295211177297`*^9, 
   3.814629522084293*^9}, {3.814629552636752*^9, 3.814629569859799*^9}, {
   3.814629667349947*^9, 3.81462967850904*^9}, 3.8146297209830513`*^9, 
   3.8146299869350557`*^9, 3.814630173862632*^9, 3.814630300847042*^9, {
   3.8146320749690485`*^9, 3.8146320784656487`*^9}, 3.814637265446888*^9, {
   3.814718613848651*^9, 3.8147186144241104`*^9}, {3.814718713374955*^9, 
   3.8147187144951315`*^9}},
 CellLabel->
  "In[1984]:=",ExpressionUUID->"a2309885-8f94-441d-b2f6-b0e8c8c4de48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.8610961821610054`"}], ",", 
   RowBox[{"-", "0.17221923643220108`"}], ",", 
   RowBox[{"-", "0.47838676786722517`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.814550451252324*^9, 3.8145504830474825`*^9, 3.8145505639667964`*^9, 
   3.8146128827886286`*^9, {3.814620888152774*^9, 3.814620898625039*^9}, 
   3.8146284876795025`*^9, 3.8146295716773443`*^9, {3.814629668310054*^9, 
   3.814629678865121*^9}, 3.814629721383551*^9, 3.8146299876107874`*^9, 
   3.8146301742960396`*^9, 3.814630304948626*^9, {3.8146320754301414`*^9, 
   3.814632079154435*^9}, 3.814637265863774*^9, 3.814720448943776*^9},
 CellLabel->
  "Out[1985]=",ExpressionUUID->"5fd0d19a-9451-47da-9a0e-10a0840ae136"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.4 \:041d\:0430\:043f\:0438\:0448\
\:0438\:0442\:0435 \:0442\:0435\:0441\:0442-\:0444\:0443\:043d\:043a\:0446\
\:0438\:044e \:043e\:0440\:0438\:0435\:043d\:0442\:0430\:0446\:0438\:0438 \
\:0442\:043e\:0447\:043a\:0438 \:043e\:0442\:043d\:043e\:0441\:0438\:0442\
\:0435\:043b\:044c\:043d\:043e \:0432\:044b\:043f\:0443\:043a\:043b\:043e\
\:0433\:043e \:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430\
\>", "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, {
   3.812768538012515*^9, 3.812768564362065*^9}, {3.812769321854453*^9, 
   3.8127693325649843`*^9}, {3.812769950274976*^9, 3.812769959642497*^9}, {
   3.8127710940175095`*^9, 3.812771106800135*^9}, {3.8127746119321566`*^9, 
   3.812774621015869*^9}, {3.812778743871883*^9, 3.812778750252804*^9}, 
   3.812779231637751*^9, {3.812779592141118*^9, 3.812779600920615*^9}, {
   3.8145284612302694`*^9, 3.814528497207673*^9}, {3.814528544495632*^9, 
   3.8145285808682146`*^9}, {3.8145290440401435`*^9, 3.814529045607963*^9}, 
   3.8145476584434285`*^9, {3.8145476896558266`*^9, 3.8145477182924705`*^9}, {
   3.814547750383865*^9, 3.8145479283942766`*^9}, {3.814637765480056*^9, 
   3.8146377769829893`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"8873b412-28d0-4d51-bd81-088c2c491960"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmPolyhedronPointPosConvex", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vertcoord_List", ",", "faces_List"}], "}"}], ",", "p0_List"}], 
   "]"}], ":=", 
  RowBox[{"Not", "@", 
   RowBox[{"ContainsAny", "[", 
    RowBox[{
     RowBox[{"Sign", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ".", "p0"}], "-", 
            RowBox[{"#", ".", 
             RowBox[{
              RowBox[{"Transpose", "[", "vertcoord", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"faces", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], 
           ")"}], "&"}], "@", 
         RowBox[{"kmGetPolyhedronFaceNorm", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vertcoord", ",", "faces"}], "}"}], ",", "i"}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "faces"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.814637782059045*^9, 3.8146378527753997`*^9}, {
  3.8146380901898527`*^9, 3.8146381035502706`*^9}, {3.8146381981495714`*^9, 
  3.814638207038371*^9}, {3.8146383234061813`*^9, 3.814638346191248*^9}, {
  3.8146384720081244`*^9, 3.8146385256280785`*^9}, {3.8146385675202756`*^9, 
  3.8146386157745023`*^9}, {3.8146386489291472`*^9, 3.814638653223673*^9}, {
  3.814639520617372*^9, 3.814639577640068*^9}, {3.8147198036161647`*^9, 
  3.814719849071309*^9}, {3.8147200204636283`*^9, 3.8147200495911217`*^9}, {
  3.814720159230954*^9, 3.8147201773023834`*^9}},
 CellLabel->
  "In[1986]:=",ExpressionUUID->"5d582a66-de74-4123-9650-cb9e84b6b915"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:043a\:0430 :", "Text",
 CellChangeTimes->{{3.814718873160825*^9, 
  3.8147188834935374`*^9}},ExpressionUUID->"f69b87e0-d002-417c-a56a-\
4fe482db44e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"11", ",", "10", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", 
        FractionBox["25", "2"], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "15", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "14"}], ",", "5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", 
        RowBox[{"-", "5"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.9"}], ",", 
        RowBox[{"-", "3"}], ",", 
        RowBox[{"-", "12.7"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "6"}], ",", "15", ",", 
        RowBox[{"-", "10"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "6", ",", "5", ",", "4", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "6", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "6", ",", "7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7", ",", "3", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "4", ",", "3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1T", " ", "=", " ", 
   RowBox[{"Transpose", "@", "P1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PP1", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"kmPolyhedronFaceToSurface", "[", 
      RowBox[{"P1", ",", "#"}], "]"}], "&"}], "/@", "G1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.814627734590618*^9, 3.8146277704839168`*^9}, {
  3.8146278037982645`*^9, 3.8146278160668387`*^9}, {3.814627911755357*^9, 
  3.814627920810567*^9}, {3.8146279509313164`*^9, 3.814628033882922*^9}, {
  3.8146281332112703`*^9, 3.814628147444256*^9}, {3.8146282201170273`*^9, 
  3.814628223755368*^9}, {3.814632271264215*^9, 3.814632323327325*^9}, {
  3.8146327372016573`*^9, 3.8146327374722676`*^9}, {3.8147187749123974`*^9, 
  3.814718829656232*^9}, {3.814719035136044*^9, 3.8147190837998953`*^9}, {
  3.814719251611205*^9, 3.8147192572474794`*^9}},
 CellLabel->
  "In[1987]:=",ExpressionUUID->"a4aeba64-982d-4add-a832-68c3494cf3e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Tooltip", "/@", 
            RowBox[{"Point", "/@", 
             RowBox[{"PP1", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], ",", 
           RowBox[{"Line", "@", 
            RowBox[{"PP1", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"G1", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", ",", "i"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"PP1", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "i"}], "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0.75", ",", "0.75"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"PP1", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], "-", "1"}]}], "}"}]}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
      "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", 
         "\[IndentingNewLine]", "     ", 
         RowBox[{"Tooltip", "/@", 
          RowBox[{"Point", "/@", "P1T"}]}], ",", "\[IndentingNewLine]", 
         "     ", "Blue", ",", " ", 
         RowBox[{"Point", "@", 
          RowBox[{"{", 
           RowBox[{
           "4.5785758266795575`", ",", "14.877211807262938`", ",", 
            "3.2888686434056007`"}], "}"}]}], ",", "Black", ",", 
         "\[IndentingNewLine]", "      ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "@", 
             RowBox[{"P1T", "[", 
              RowBox[{"[", 
               RowBox[{"G1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "G1"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "      ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"P1T", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "}"}]}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "P1T"}]}], "}"}]}], "]"}]}]}], "}"}], 
       ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "}"}], 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8145460318514004`*^9, 3.814546108274602*^9}, {
   3.814546141243408*^9, 3.814546209546884*^9}, {3.8145462504194613`*^9, 
   3.81454642698711*^9}, {3.814546465629243*^9, 3.8145465097476196`*^9}, {
   3.8145466411322927`*^9, 3.81454665624293*^9}, {3.8145469513174663`*^9, 
   3.8145469576907215`*^9}, {3.8145469933245964`*^9, 
   3.8145470075722203`*^9}, {3.814547119131287*^9, 3.81454715274663*^9}, {
   3.8145473042454157`*^9, 3.8145473065554457`*^9}, {3.8145473572921925`*^9, 
   3.814547400899522*^9}, {3.814550583514966*^9, 3.814550633412074*^9}, {
   3.8145563846996374`*^9, 3.8145564589125137`*^9}, {3.8145577438426437`*^9, 
   3.81455775086438*^9}, {3.814605392684985*^9, 3.8146054031953444`*^9}, {
   3.814605440427391*^9, 3.8146054777394524`*^9}, {3.8146055120917807`*^9, 
   3.81460559173197*^9}, {3.814606031685501*^9, 3.8146060846766024`*^9}, {
   3.8146062659260664`*^9, 3.814606453363804*^9}, {3.8146064921727777`*^9, 
   3.814606567981304*^9}, 3.814607302160222*^9, {3.8146073531738806`*^9, 
   3.814607354469998*^9}, 3.8146074270776243`*^9, {3.8146075230414352`*^9, 
   3.814607596526103*^9}, 3.814607688311672*^9, {3.8146077547190914`*^9, 
   3.81460780054204*^9}, 3.8146080063580265`*^9, 3.814608176615475*^9, 
   3.8146082209512973`*^9, {3.81460897873691*^9, 3.814608978862604*^9}, {
   3.814612478374874*^9, 3.8146125487869587`*^9}, {3.8146132688958516`*^9, 
   3.814613329820691*^9}, {3.8146134749816713`*^9, 3.8146134881323905`*^9}, {
   3.8146135346176176`*^9, 3.8146136573911295`*^9}, {3.8146136888648415`*^9, 
   3.8146137472248325`*^9}, 3.81461382797764*^9, {3.8146138590539417`*^9, 
   3.8146138710702176`*^9}, {3.8146141363828783`*^9, 3.8146141499198427`*^9}, 
   3.8146142448244724`*^9, 3.8146150578414745`*^9, {3.81461516511152*^9, 
   3.8146151706482153`*^9}, 3.8146153070718727`*^9, 3.814615685472456*^9, {
   3.8146177628678617`*^9, 3.8146178537311015`*^9}, {3.8146179075546627`*^9, 
   3.814617912618781*^9}, 3.814617963703536*^9, {3.814618005081991*^9, 
   3.814618027114215*^9}, {3.814620911341402*^9, 3.814620952917268*^9}, {
   3.814620988301478*^9, 3.814620988614603*^9}, {3.814624749779868*^9, 
   3.8146248473775215`*^9}, {3.814625011323152*^9, 3.814625011538046*^9}, 
   3.8146272011415434`*^9, 3.8146272971412196`*^9, {3.8146273426136475`*^9, 
   3.8146273441320972`*^9}, {3.8146274442225437`*^9, 3.8146274527240925`*^9}, 
   3.8146275909021997`*^9, 3.8146282806873503`*^9, {3.8146284989017515`*^9, 
   3.814628512741626*^9}, {3.8146294875586863`*^9, 3.814629505651518*^9}, 
   3.8146295866326847`*^9, {3.8146296361432486`*^9, 3.8146296575665913`*^9}, {
   3.8146296884164715`*^9, 3.8146296910691643`*^9}, {3.814629735158924*^9, 
   3.8146297376572824`*^9}, {3.8146299950261803`*^9, 3.814629997297555*^9}, {
   3.8146301824535613`*^9, 3.814630188069504*^9}, {3.814630312648156*^9, 
   3.81463031631672*^9}, 3.8146308672659893`*^9, {3.814632330842872*^9, 
   3.814632352706275*^9}, {3.814632391323251*^9, 3.8146324028727045`*^9}, {
   3.8146326424010353`*^9, 3.8146326658021975`*^9}, {3.8146327250601206`*^9, 
   3.8146327313696017`*^9}, {3.8146372255121727`*^9, 
   3.8146372500305986`*^9}, {3.8146372926014166`*^9, 
   3.8146372933041677`*^9}, {3.814637324344799*^9, 3.8146373361023865`*^9}, {
   3.814637369968649*^9, 3.814637396311911*^9}, {3.814637478737661*^9, 
   3.8146375429770927`*^9}, {3.81463766740082*^9, 3.8146377070080814`*^9}, 
   3.8146386764603767`*^9, {3.8146394051066704`*^9, 3.8146394273800735`*^9}, {
   3.814719089701707*^9, 3.814719106929179*^9}, {3.8147193072372556`*^9, 
   3.8147193359484816`*^9}, {3.8147193753645363`*^9, 
   3.8147194170756044`*^9}, {3.8147194624103394`*^9, 
   3.8147194862810307`*^9}, {3.8147195649560604`*^9, 3.814719599638565*^9}, {
   3.8147196817337303`*^9, 3.814719731477264*^9}, 3.8147198838595295`*^9, 
   3.8147200770290537`*^9, {3.8147202075171337`*^9, 3.8147202260620823`*^9}, {
   3.8147203418847256`*^9, 3.8147203903251505`*^9}},
 CellLabel->
  "In[1991]:=",ExpressionUUID->"b0c8bfe7-85ac-49ad-a1b3-d6a532771d17"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[
      {PointSize[0.025], {
        TagBox[
         TooltipBox[PointBox[{0., 0.}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"0.`", ",", "0.`"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{0., 0.}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-18.902380802428038`, -8.881784197001252*^-16}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "18.902380802428038`"}], ",", 
                RowBox[{"-", "8.881784197001252`*^-16"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-18.902380802428038`, -8.881784197001252*^-16}], 
          "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-17.48986032264962, -13.270447840755285`}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "17.48986032264962`"}], ",", 
                RowBox[{"-", "13.270447840755285`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-17.48986032264962, -13.270447840755285`}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{-4.793047021270587, -21.56447774122734}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "4.793047021270587`"}], ",", 
                RowBox[{"-", "21.56447774122734`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-4.793047021270587, -21.56447774122734}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[PointBox[{0., 0.}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"0.`", ",", "0.`"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{0., 0.}], "Tooltip"]& ]}, 
       LineBox[{{0., 
        0.}, {-18.902380802428038`, -8.881784197001252*^-16}, \
{-17.48986032264962, -13.270447840755285`}, {-4.793047021270587, \
-21.56447774122734}, {0., 0.}}], InsetBox["7", {0.75, 0.75}], 
       InsetBox["6", {-18.152380802428038, 0.7499999999999991}], 
       InsetBox["5", {-16.73986032264962, -12.520447840755285}], 
       InsetBox["4", {-4.043047021270587, -20.81447774122734}]},
      Axes->True,
      ImageSize->Medium], 
     Graphics3DBox[
      {PointSize[0.025], {
        TagBox[
         TooltipBox[Point3DBox[{11, 10, 3}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"11", ",", "10", ",", "3"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{11, 10, 3}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[
          Point3DBox[NCache[{10, Rational[25, 2], 5}, {10, 12.5, 5}]],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"10", ",", 
                FractionBox["25", "2"], ",", "5"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{10, 
            Rational[25, 2], 5}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{9, 15, 7}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{"9", ",", "15", ",", "7"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{9, 15, 7}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-14, 5, 8}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "14"}], ",", "5", ",", "8"}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-14, 5, 8}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-7, -5, -1}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "7"}], ",", 
                RowBox[{"-", "5"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-7, -5, -1}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-0.9, -3, -12.7}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "0.9`"}], ",", 
                RowBox[{"-", "3"}], ",", 
                RowBox[{"-", "12.7`"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-0.9, -3, -12.7}], "Tooltip"]& ], 
        TagBox[
         TooltipBox[Point3DBox[{-6, 15, -10}],
          RowBox[{"Point", "[", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "6"}], ",", "15", ",", 
                RowBox[{"-", "10"}]}], "}"}], "]"}]],
         Annotation[#, 
          Point[{-6, 15, -10}], "Tooltip"]& ]}, 
       {RGBColor[0, 0, 1], 
        Point3DBox[{4.5785758266795575`, 14.877211807262938`, 
         3.2888686434056007`}]}, 
       {GrayLevel[0], 
        Line3DBox[
         NCache[{{11, 10, 3}, {10, Rational[25, 2], 5}, {9, 15, 7}, {-14, 5, 
           8}, {-7, -5, -1}, {11, 10, 3}}, {{11, 10, 3}, {10, 12.5, 5}, {9, 
           15, 7}, {-14, 5, 8}, {-7, -5, -1}, {11, 10, 3}}]], 
        Line3DBox[{{-6, 15, -10}, {-0.9, -3, -12.7}, {-7, -5, -1}, {-14, 5, 
          8}, {-6, 15, -10}}], 
        Line3DBox[{{11, 10, 3}, {-7, -5, -1}, {-0.9, -3, -12.7}, {11, 10, 
          3}}], Line3DBox[{{11, 10, 3}, {-0.9, -3, -12.7}, {-6, 15, -10}, {11,
           10, 3}}], 
        Line3DBox[
         NCache[{{11, 10, 3}, {-6, 15, -10}, {9, 15, 7}, {
           10, Rational[25, 2], 5}, {11, 10, 3}}, {{11, 10, 3}, {-6, 
           15, -10}, {9, 15, 7}, {10, 12.5, 5}, {11, 10, 3}}]], 
        Line3DBox[{{9, 15, 7}, {-6, 15, -10}, {-14, 5, 8}, {9, 15, 7}}], 
        Text3DBox["1", {11.75, 10.75, 3.75}], 
        Text3DBox["2", {10.75, 13.25, 5.75}], 
        Text3DBox["3", {9.75, 15.75, 7.75}], 
        Text3DBox["4", {-13.25, 5.75, 8.75}], 
        Text3DBox["5", {-6.25, -4.25, -0.25}], 
        Text3DBox["6", {-0.15000000000000002`, -2.25, -11.95}], 
        Text3DBox["7", {-5.25, 15.75, -9.25}]}},
      Axes->True,
      ImageSize->Medium,
      ViewPoint->{2.817172811950478, 0.6020299049527813, 1.7751330488584736`},
      ViewVertical->{0.05711753768400119, 0.5693786113974556, 
       0.8200887657882053}]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.814719109314045*^9, 3.8147192591856775`*^9, {3.8147193079770975`*^9, 
   3.81471948666158*^9}, {3.814719566135724*^9, 3.8147196007796*^9}, {
   3.8147196824199767`*^9, 3.8147197320916457`*^9}, 3.8147198845297403`*^9, {
   3.814720208359912*^9, 3.81472022656781*^9}, {3.8147203425195985`*^9, 
   3.814720390880638*^9}, 3.8147204490624876`*^9},
 CellLabel->
  "Out[1991]=",ExpressionUUID->"acb6a40d-c713-4e18-ab24-2432535610ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"P0", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "7", ",", 
     RowBox[{"-", "2"}]}], "}"}], "+", 
   RowBox[{"8", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Random", "[", "]"}], ",", 
      RowBox[{"Random", "[", "]"}], ",", 
      RowBox[{"Random", "[", "]"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "@", 
  RowBox[{"kmPolyhedronPointPosConvex", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"P1", ",", "G1"}], "}"}], ",", "P0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.814719502774415*^9, 3.8147195523180523`*^9}, {
  3.814719588535948*^9, 3.8147195886785955`*^9}, {3.8147196259362645`*^9, 
  3.8147196887024946`*^9}, {3.8147202339668226`*^9, 3.8147203805416603`*^9}},
 CellLabel->
  "In[1992]:=",ExpressionUUID->"fddc2cbc-c2ce-4de6-bcc8-fe96ad675707"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.9995158935587742`", ",", "12.78105043842638`", ",", 
   RowBox[{"-", "1.055681906299098`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8147203357778645`*^9, 3.814720380956521*^9}, 
   3.8147204491103296`*^9},
 CellLabel->
  "Out[1992]=",ExpressionUUID->"c311f090-b0c6-4090-b32b-0777bf508610"],

Cell[BoxData["True"], "Print",
 CellChangeTimes->{{3.814720294385054*^9, 3.8147203809973955`*^9}, 
   3.8147204491173115`*^9},
 CellLabel->
  "During evaluation of \
In[1992]:=",ExpressionUUID->"a8491831-2c91-40a9-a2b3-2572bf425020"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.814638619056566*^9, 3.8146386371099176`*^9}, {
   3.8146394577452354`*^9, 3.8146394586642256`*^9}, {3.8146395833455524`*^9, 
   3.814639584448507*^9}, {3.814719283688623*^9, 3.8147193280949755`*^9}, {
   3.814719367679989*^9, 3.8147194084793463`*^9}, {3.814719455439926*^9, 
   3.8147194571835127`*^9}, {3.8147194960784917`*^9, 3.8147194963746743`*^9}, 
   3.814719561072378*^9, 3.814719594010273*^9, {3.8147196312554054`*^9, 
   3.8147196375506268`*^9}, {3.8147197387196856`*^9, 
   3.8147197413514423`*^9}, {3.8147198785357003`*^9, 
   3.8147198787576036`*^9}, {3.814720195193636*^9, 3.8147202198860006`*^9}, 
   3.814720257547269*^9},
 CellLabel->
  "In[1994]:=",ExpressionUUID->"3a33c4cb-8198-4b76-a775-066eb6a5b53f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2. \:0421\:043f\:0440\:043e\:0435\
\:043a\:0442\:0438\:0440\:0443\:0439\:0442\:0435 \:0438 \:043f\:043e\:0441\
\:0442\:0440\:043e\:0439\:0442\:0435 \:0443\:043a\:0430\:0437\:0430\:043d\
\:043d\:044b\:0439 \:0432 \:0437\:0430\:0434\:0430\:043d\:0438\:0438 \:043e\
\:0431\:044a\:0435\:043a\:0442 \[LeftGuillemet]\:041f\:043e\:043b\:0438\:044d\
\:0434\:0440\[RightGuillemet]. \:041d\:0430\:043f\:0438\:0448\:0438\:0442\
\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:0438, \:0441\:043e\:0437\:0434\
\:0430\:044e\:0449\:0438\:0435 \:0441\:0444\:0435\:0440\:043e\:0438\:0434\
\:043d\:044b\:0439 \:0438\:043b\:0438 \:0437\:0432\:0435\:0437\:0434\:043d\
\:044b\:0439 \:043e\:0431\:044a\:0435\:043a\:0442. \:0412\:0438\:0437\:0443\
\:0430\:043b\:0438\:0437\:0438\:0440\:0443\:0439\:0442\:0435 \:0440\:0435\
\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:044b \:0440\:0430\:0431\:043e\
\:0442\:044b \:0444\:0443\:043d\:043a\:0446\:0438\:0439. \
\>", "Section",
 CellChangeTimes->{{3.699768787191681*^9, 3.699768800895378*^9}, {
   3.699773019778221*^9, 3.699773036607109*^9}, {3.699773073648346*^9, 
   3.6997731001119695`*^9}, {3.777342337806446*^9, 3.777342343714958*^9}, {
   3.812767893404801*^9, 3.8127679063774133`*^9}, 3.8127795479522505`*^9, {
   3.814528423774716*^9, 3.8145284427427936`*^9}, {3.814640213180241*^9, 
   3.8146402637963495`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"4c7d503b-7b75-493e-98a6-5f222d6978a1"],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2.4 \:041c\:043e\:0434\:0435\:043b\
\:0438\:0440\:0443\:0439\:0442\:0435 \:043a\:0430\:0440\:043a\:0430\:0441\
\:043d\:044b\:0439 \:0441\:0444\:0435\:0440\:043e\:0438\:0434\:043d\:044b\
\:0439 \:043e\:0431\:044a\:0435\:043a\:0442, \:0434\:0432\:0443\:043a\:0440\
\:0430\:0442\:043d\:043e \:043d\:0430\:0434\:0441\:0442\:0440\:0430\:0438\
\:0432\:0430\:044f \:0433\:0440\:0430\:043d\:0438 \:0433\:0435\:043a\:0441\
\:0430\:044d\:0434\:0440\:0430. \:0418\:0437\:043e\:0431\:0440\:0430\:0437\
\:0438\:0442\:0435 \:044d\:0442\:0430\:043f\:044b \:043c\:043e\:0434\:0435\
\:043b\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:044f \:0438 \:043f\:043e\
\:043b\:0443\:0447\:0435\:043d\:043d\:044b\:0439 \:043e\:0431\:044a\:0435\
\:043a\:0442. \
\>", "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, {
   3.812768538012515*^9, 3.812768564362065*^9}, {3.812769321854453*^9, 
   3.8127693325649843`*^9}, {3.812769950274976*^9, 3.812769959642497*^9}, {
   3.8127710940175095`*^9, 3.812771106800135*^9}, {3.8127746119321566`*^9, 
   3.812774621015869*^9}, {3.812778743871883*^9, 3.812778750252804*^9}, 
   3.812779231637751*^9, {3.812779592141118*^9, 3.812779600920615*^9}, {
   3.8145284612302694`*^9, 3.814528497207673*^9}, {3.814528544495632*^9, 
   3.8145285808682146`*^9}, {3.8145290440401435`*^9, 3.814529045607963*^9}, 
   3.8145476584434285`*^9, {3.8145476896558266`*^9, 3.8145477182924705`*^9}, {
   3.814547750383865*^9, 3.8145479283942766`*^9}, {3.814637765480056*^9, 
   3.8146377769829893`*^9}, {3.8146402667685804`*^9, 3.8146402730730534`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"cff49606-ee4f-440c-925a-0f4c871f5f21"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kmHexaedroInit", "[", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4", ",", "3", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "4", ",", "1"}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.814708491497293*^9, 3.814708491646865*^9}, {
  3.814708542071102*^9, 3.8147085477677636`*^9}, {3.814708597366742*^9, 
  3.81470865673499*^9}},
 CellLabel->
  "In[1995]:=",ExpressionUUID->"e224338f-c787-4c54-949f-31b32cd3b33f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmHexaedroExpand", "[", 
   RowBox[{"{", 
    RowBox[{"vertcoord_List", ",", "faces_List"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "PT", ",", "G", ",", "p0", ",", "R", ",", " ", "Phalf", ",", "Pnew", ",",
       "pn", ",", "p2n", ",", "Gnew", ",", "GNnew", ",", "dl", ",", "d", ",", 
      "d2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PT", "=", 
      RowBox[{"Transpose", "@", "vertcoord"}]}], ";", " ", 
     RowBox[{"G", "=", "faces"}], ";", "\[IndentingNewLine]", 
     RowBox[{"p0", " ", "=", " ", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "PT", "]"}]}], "*", 
       RowBox[{"Total", "@", "PT"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"#", ".", "#"}], "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"PT", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "p0"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "\:041d\:0430\:0434\:0441\:0442\:0440\:043e\:0439\:043a\:0430", " ", 
         "i"}], "-", 
        RowBox[{"\:043e\:0439", " ", "\:0433\:0440\:0430\:043d\:0438"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Phalf", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"PT", "[", 
              RowBox[{"[", "#1", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PT", "[", 
                 RowBox[{"[", "#2", "]"}], "]"}], "-", 
                RowBox[{"PT", "[", 
                 RowBox[{"[", "#1", "]"}], "]"}]}], ")"}]}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Most", "@", 
              RowBox[{"G", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"Rest", "@", 
              RowBox[{"G", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Pnew", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"p0", "+", 
            RowBox[{"R", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", "p0"}], ")"}], "/", 
              RowBox[{"Norm", "[", 
               RowBox[{"#", "-", "p0"}], "]"}]}]}]}], "&"}], "/@", 
          "Phalf"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pn", "=", 
         RowBox[{"Most", "@", 
          RowBox[{"G", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p2n", "=", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "PT"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Length", "@", "PT"}], "+", 
            RowBox[{"Length", "@", "pn"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Gnew", "=", 
         RowBox[{"p2n", "//", 
          RowBox[{"Append", "[", 
           RowBox[{"First", "@", "p2n"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GNnew", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"First", "@", "#"}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"List", ",", 
            RowBox[{"{", 
             RowBox[{"pn", ",", "p2n", ",", 
              RowBox[{
               RowBox[{"Most", "[", "p2n", "]"}], "//", 
               RowBox[{"Prepend", "[", 
                RowBox[{"Last", "@", "p2n"}], "]"}]}]}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"PT", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"PT", ",", "Pnew"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", "Gnew"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"G", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"G", ",", "GNnew"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:041f\:043e\:0438\:0441\:043a", " ", 
          "\:043f\:043e\:0432\:0442\:043e\:0440\:044f\:044e\:0449\:0438\:0445\
\:0441\:044f", " ", "\:0432\:0435\:0440\:0448\:0438\:043d", " ", "\:0438", 
          " ", "\:0438\:0445", " ", 
          "\:0443\:0434\:0430\:043b\:0435\:043d\:0438\:0435"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dl", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"DeleteDuplicates", "[", "PT", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "PT"}], " ", ">", " ", "dl"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"First", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Tally", "@", "PT"}], ",", 
                RowBox[{"y_", "/;", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"y", "===", "List"}], ",", "False", ",", 
                   RowBox[{
                    RowBox[{"Last", "@", "y"}], ">", "1"}]}], "]"}]}], ",", 
                "1", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"d2", "=", 
            RowBox[{"Last", "@", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Position", "[", 
               RowBox[{"PT", ",", 
                RowBox[{"PT", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", "1"}], "]"}]}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"G", "=", 
            RowBox[{"G", "/.", 
             RowBox[{"{", 
              RowBox[{"d2", "\[Rule]", " ", "d"}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"G", "=", 
            RowBox[{"G", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x_", "/;", 
                RowBox[{"x", ">", "d2"}]}], "\[Rule]", 
               RowBox[{"x", "-", "1"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"PT", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"PT", ",", "d2"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "G"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0412\:043e\:0437\:0432\:0440\:0430\:0442", " ", 
       "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:0430", " ", 
       RowBox[{"(", 
        RowBox[{
        "\:043d\:0430\:0434\:0441\:0442\:0440\:043e\:0435\:043d\:043d\:043e\
\:0433\:043e", " ", 
         "\:0433\:0435\:043a\:0441\:0430\:044d\:0434\:0440\:0430"}], ")"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "@", "PT"}], ",", "G"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8147087065430737`*^9, 3.814708784632995*^9}, {
   3.814708850567704*^9, 3.8147089186715946`*^9}, {3.814710610389553*^9, 
   3.8147107335732155`*^9}, {3.814710990005945*^9, 3.814710993893907*^9}, {
   3.8147110417098975`*^9, 3.8147110851731124`*^9}, {3.814711115757723*^9, 
   3.814711230256496*^9}, {3.814711271768321*^9, 3.8147114743360314`*^9}, 
   3.8147115987470393`*^9, {3.8147116367936764`*^9, 3.8147116387363925`*^9}, {
   3.814713032816588*^9, 3.8147130620001774`*^9}, {3.814713130457489*^9, 
   3.8147131598069625`*^9}, 3.814713235367342*^9, 3.814718120983395*^9, {
   3.814718160758838*^9, 3.814718190707942*^9}},
 CellLabel->
  "In[1996]:=",ExpressionUUID->"2dcb67c1-634e-4c42-bfc5-415293e0dc11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kmHexaedroReduce", "[", 
   RowBox[{"{", 
    RowBox[{"vertcoord_List", ",", "faces_List"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"PT", ",", "G", ",", "Gnext", ",", " ", "nP", ",", "nG"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PT", "=", 
      RowBox[{"Transpose", "@", "vertcoord"}]}], ";", " ", 
     RowBox[{"G", "=", "faces"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:041e\:0431\:0440\:0430\:0437\:043e\:0432\:0430\:043d\:0438\:0435", 
       " ", "\:043d\:043e\:0432\:044b\:0445", " ", 
       "\:0433\:0440\:0430\:043d\:0435\:0439", " ", "\:043d\:0430", " ", 
       "\:043c\:0435\:0441\:0442\:0435", " ", 
       "\:0443\:0434\:0430\:043b\:0435\:043d\:0438\:044f", " ", 
       "\:043f\:0440\:0435\:0436\:043d\:0438\:0445"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nP", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "G"}], ">", "16"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", "G"}], "-", 
           RowBox[{"Length", "@", "PT"}], "-", "2"}], ")"}], "/", "2"}], ",", 
        "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nG", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "G"}], ">", "16"}], ",", 
        RowBox[{"nP", "+", "2"}], ",", "4"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Gnext", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"First", "@", "#"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Join", "@@", 
             RowBox[{"Select", "[", 
              RowBox[{"G", ",", 
               RowBox[{
                RowBox[{"ContainsAny", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", "i", "}"}]}], "]"}], "&"}]}], "]"}]}], "]"}], 
           ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nP"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "\:0423\:0434\:0430\:043b\:0435\:043d\:0438\:0435", " ", 
        "\:043f\:0440\:0435\:0436\:043d\:0438\:0445", " ", 
        "\:0433\:0440\:0430\:043d\:0435\:0439", " ", "\:0438", " ", 
        "\:0432\:0435\:0440\:0448\:0438\:043d"}], ",", " ", 
       RowBox[{
       "\:0441", " ", "\:043d\:0438\:043c\:0438", " ", 
        "\:0441\:0432\:044f\:0437\:0430\:043d\:043d\:044b\:0445"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"G", ",", "nG"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"G", "=", 
         RowBox[{"G", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "i"}]}], "\[Rule]", 
            RowBox[{"x", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gnext", "=", 
         RowBox[{"Gnext", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "i"}]}], "\[Rule]", 
            RowBox[{"x", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PT", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"PT", ",", "1"}], "]"}]}], ";"}], " ", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "Gnext"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0414\:043e\:0431\:0430\:0432\:043b\:0435\:043d\:0438\:0435", " ", 
       "\:043d\:043e\:0432\:044b\:0445", " ", 
       "\:0433\:0440\:0430\:043d\:0435\:0439"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"G", ",", "Gnext"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "\:0412\:043e\:0437\:0432\:0440\:0430\:0442", " ", 
       "\:0440\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:0430", " ", 
       RowBox[{"(", 
        RowBox[{
        "\:0433\:0435\:043a\:0441\:0430\:044d\:0434\:0440\:0430", " ", 
         "\:0441", " ", 
         "\:043e\:0431\:0440\:0435\:0437\:0430\:043d\:043d\:044b\:043c\:0438",
          " ", "\:0433\:0440\:0430\:043d\:044f\:043c\:0438"}], ")"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "@", "PT"}], ",", "G"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.814711863398012*^9, 3.8147120897013865`*^9}, {
   3.8147121309088807`*^9, 3.814712263943262*^9}, {3.81471234773558*^9, 
   3.8147123638295155`*^9}, {3.8147123942073927`*^9, 3.814712398733119*^9}, 
   3.8147132166620045`*^9, 3.8147133947362957`*^9, {3.814713461259924*^9, 
   3.8147134622532425`*^9}, {3.814713844653076*^9, 3.814713868340872*^9}, {
   3.814713909061968*^9, 3.8147139208771524`*^9}, {3.8147141455646467`*^9, 
   3.8147142890925727`*^9}, {3.814714328292127*^9, 3.8147143482609367`*^9}, {
   3.814714427741305*^9, 3.8147144389002886`*^9}, {3.8147165461324177`*^9, 
   3.814716558755248*^9}, {3.8147168229706106`*^9, 3.814716853290779*^9}, {
   3.814717260786399*^9, 3.81471730563486*^9}, {3.814717404916258*^9, 
   3.814717442618601*^9}, {3.814717762187637*^9, 3.8147178008985834`*^9}, {
   3.814717940586128*^9, 3.8147179408903627`*^9}, {3.8147204845377417`*^9, 
   3.814720498488594*^9}},ExpressionUUID->"f8a7373e-333c-4949-a883-\
9d46d11a34bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"P2", ",", "G2"}], "}"}], "=", 
   RowBox[{"kmHexaedroInit", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8147086612667665`*^9, 3.8147086693910103`*^9}, {
  3.814711548533593*^9, 3.8147115551574993`*^9}, {3.81471398199644*^9, 
  3.814713983642161*^9}},
 CellLabel->
  "In[1998]:=",ExpressionUUID->"9ba01d09-d5ef-4b25-81cc-a03e8f0ba03e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"P2", ",", "G2"}], "}"}], "=", 
   RowBox[{"kmHexaedroExpand", "[", 
    RowBox[{"{", 
     RowBox[{"P2", ",", "G2"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.814711497550679*^9, 3.81471149813258*^9}, {
   3.814711572646928*^9, 3.814711592524884*^9}, {3.814713581389085*^9, 
   3.814713583267462*^9}, 3.814713931005104*^9, {3.814713985755907*^9, 
   3.8147139918349886`*^9}},
 CellLabel->
  "In[1999]:=",ExpressionUUID->"952ee46f-fb98-4fc0-8d24-ef53f69fe7b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"P2", ",", "G2"}], "}"}], "=", 
   RowBox[{"kmHexaedroReduce", "[", 
    RowBox[{"{", 
     RowBox[{"P2", ",", "G2"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8147139346226454`*^9, 3.814713996418872*^9}},
 CellLabel->
  "In[2000]:=",ExpressionUUID->"23b1a372-9133-4e9c-b8c7-ad0e6db5cb4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P2T", "=", 
   RowBox[{"Transpose", "@", "P2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", 
     "\[IndentingNewLine]", "     ", 
     RowBox[{"Point", "/@", "P2T"}], ",", "\[IndentingNewLine]", "      ", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Line", "@", 
         RowBox[{"P2T", "[", 
          RowBox[{"[", 
           RowBox[{"G2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "G2"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "      ", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"P2T", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "0.05", ",", "0.05"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "P2T"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "      ", "Blue", ","}], 
    RowBox[{"(*", 
     RowBox[{"Point", "@", 
      RowBox[{"Take", "[", 
       RowBox[{"P2T", ",", "12"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
    "}"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.814640569289214*^9, 3.814640585601098*^9}, {
   3.814640724547762*^9, 3.8146407501872883`*^9}, {3.814641251955287*^9, 
   3.8146412795518565`*^9}, {3.8146417261966424`*^9, 3.814641729163474*^9}, {
   3.814641932076563*^9, 3.8146419388999176`*^9}, {3.814642842206759*^9, 
   3.81464286802079*^9}, 3.8146429982101536`*^9, 3.8146430555611606`*^9, 
   3.814643221900077*^9, 3.8146432582108746`*^9, {3.814643336618472*^9, 
   3.814643349683117*^9}, 3.814643751857806*^9, 3.814643832960107*^9, 
   3.8146440519940863`*^9, {3.814644636520521*^9, 3.8146446396584325`*^9}, {
   3.814645329313837*^9, 3.8146453398014097`*^9}, {3.8146454254353495`*^9, 
   3.8146454279769497`*^9}, {3.8146455949379015`*^9, 
   3.8146456103164425`*^9}, {3.814646147228897*^9, 3.8146461478762674`*^9}, {
   3.8146468993652687`*^9, 3.814646899851921*^9}, {3.8146489675415487`*^9, 
   3.814648969275858*^9}, {3.814652374479683*^9, 3.8146524271448374`*^9}, {
   3.814653581970896*^9, 3.8146536819954967`*^9}, {3.814653720435435*^9, 
   3.8146538086329336`*^9}, {3.814653841794194*^9, 3.8146538588419285`*^9}, {
   3.8146542161072245`*^9, 3.8146542190100603`*^9}, {3.8146542800666795`*^9, 
   3.8146542836660695`*^9}, {3.814654400107622*^9, 3.81465440986718*^9}, {
   3.8146547117476187`*^9, 3.814654713378989*^9}, {3.8146548139005594`*^9, 
   3.814654847283901*^9}, {3.8146935912013235`*^9, 3.814693607701912*^9}, {
   3.814694029476121*^9, 3.81469404420492*^9}, {3.81469414723627*^9, 
   3.8146941552601504`*^9}, {3.814694188907849*^9, 3.814694275831422*^9}, {
   3.8146978434338045`*^9, 3.814697844888751*^9}, {3.814700035553018*^9, 
   3.814700039671402*^9}, {3.8147002367127357`*^9, 3.8147002626567764`*^9}, {
   3.8147028983510513`*^9, 3.814702901348733*^9}, {3.8147037795340233`*^9, 
   3.814703788269268*^9}, {3.8147040832614717`*^9, 3.8147040833960814`*^9}, {
   3.81470488354906*^9, 3.814704899491232*^9}, {3.814705050284451*^9, 
   3.8147050649164333`*^9}, {3.814705099383837*^9, 3.8147051015239463`*^9}, {
   3.81470548734943*^9, 3.8147054886024647`*^9}, {3.8147055265275803`*^9, 
   3.8147055284834385`*^9}, {3.81470570276642*^9, 3.814705721850398*^9}, {
   3.8147059345956116`*^9, 3.814706014243637*^9}, {3.814706147259538*^9, 
   3.814706148074438*^9}, {3.814706459614833*^9, 3.8147064633301997`*^9}, {
   3.8147065702195787`*^9, 3.8147065780671115`*^9}, {3.814706618082142*^9, 
   3.8147066374028215`*^9}, {3.814706687645115*^9, 3.8147067041787767`*^9}, {
   3.8147068273505907`*^9, 3.814706832811531*^9}, {3.8147068777875795`*^9, 
   3.8147068875143833`*^9}, {3.814706931789161*^9, 3.814706934330171*^9}, {
   3.814707381636139*^9, 3.8147074245453777`*^9}, {3.8147075271621995`*^9, 
   3.8147075920988693`*^9}, {3.8147076715537148`*^9, 
   3.8147076786580944`*^9}, {3.8147081113180037`*^9, 
   3.8147081260485024`*^9}, {3.814708166546345*^9, 3.814708190610515*^9}, {
   3.8147082412654924`*^9, 3.814708260497583*^9}, {3.8147157467974634`*^9, 
   3.814715754979437*^9}, {3.814715846815728*^9, 3.814715848859384*^9}, {
   3.8147160580480623`*^9, 3.8147160760425653`*^9}, {3.814717559667069*^9, 
   3.814717560290002*^9}, {3.8147176589149523`*^9, 3.814717729297633*^9}, {
   3.814718237172274*^9, 3.814718238042201*^9}},
 CellLabel->
  "In[2001]:=",ExpressionUUID->"c1f49e62-2efc-4f1f-b72d-d52218f7f069"],

Cell[BoxData[
 Graphics3DBox[
  {PointSize[
   0.025], {Point3DBox[
     NCache[{Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2]}, {
      0.5, -0.3660254037844386, 0.5}]], 
    Point3DBox[
     NCache[{Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2],
        Rational[1, 2]}, {1.3660254037844386`, 0.5, 0.5}]], 
    Point3DBox[
     NCache[{Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}, {0.5, 0.5, 1.3660254037844386`}]], 
    Point3DBox[
     NCache[{Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2]}, {0.5, 0.5, -0.3660254037844386}]], 
    Point3DBox[
     NCache[{Rational[1, 2], Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2],
        Rational[1, 2]}, {0.5, 1.3660254037844386`, 0.5}]], 
    Point3DBox[
     NCache[{Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], Rational[
       1, 2], Rational[1, 2]}, {-0.3660254037844386, 0.5, 0.5}]]}, 
   Line3DBox[
    NCache[{{Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2]}, {
      Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}}, {{0.5, -0.3660254037844386, 0.5}, {
     1.3660254037844386`, 0.5, 0.5}, {0.5, 0.5, 1.3660254037844386`}, {
     0.5, -0.3660254037844386, 0.5}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2],
        Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}}, {{1.3660254037844386`, 0.5, 0.5}, {0.5, 
     0.5, -0.3660254037844386}, {0.5, 1.3660254037844386`, 0.5}, {
     1.3660254037844386`, 0.5, 0.5}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], Rational[
       1, 2], Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}}, {{-0.3660254037844386, 0.5, 0.5}, {0.5, 
     0.5, -0.3660254037844386}, {0.5, -0.3660254037844386, 
     0.5}, {-0.3660254037844386, 0.5, 0.5}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}}, {{0.5, 0.5, 1.3660254037844386`}, {
     0.5, 1.3660254037844386`, 0.5}, {-0.3660254037844386, 0.5, 0.5}, {0.5, 
     0.5, 1.3660254037844386`}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}}, {{0.5, -0.3660254037844386, 0.5}, {0.5, 0.5, 
     1.3660254037844386`}, {-0.3660254037844386, 0.5, 0.5}, {
     0.5, -0.3660254037844386, 0.5}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[1, 2] 3^Rational[1, 2]}}, {{0.5, 0.5, 1.3660254037844386`}, {
     1.3660254037844386`, 0.5, 0.5}, {0.5, 1.3660254037844386`, 0.5}, {0.5, 
     0.5, 1.3660254037844386`}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2],
        Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}}, {{1.3660254037844386`, 0.5, 0.5}, {
     0.5, -0.3660254037844386, 0.5}, {0.5, 0.5, -0.3660254037844386}, {
     1.3660254037844386`, 0.5, 0.5}}]], 
   Line3DBox[
    NCache[{{Rational[1, 2], Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2],
        Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2] + 
       Rational[-1, 2] 3^Rational[1, 2]}, {
      Rational[1, 2] + Rational[-1, 2] 3^Rational[1, 2], Rational[1, 2], 
       Rational[1, 2]}, {
      Rational[1, 2], Rational[1, 2] + Rational[1, 2] 3^Rational[1, 2], 
       Rational[1, 2]}}, {{0.5, 1.3660254037844386`, 0.5}, {0.5, 
     0.5, -0.3660254037844386}, {-0.3660254037844386, 0.5, 0.5}, {0.5, 
     1.3660254037844386`, 0.5}}]], 
   Text3DBox["1", {0.55, -0.31602540378443855`, 0.55}], 
   Text3DBox["2", {1.4160254037844386`, 0.55, 0.55}], 
   Text3DBox["3", {0.55, 0.55, 1.4160254037844386`}], 
   Text3DBox["4", {0.55, 0.55, -0.31602540378443855`}], 
   Text3DBox["5", {0.55, 1.4160254037844386`, 0.55}], 
   Text3DBox["6", {-0.31602540378443855`, 0.55, 0.55}], 
   {RGBColor[0, 0, 1]}},
  Axes->True,
  ImageSize->Large,
  ViewPoint->{0.101606756447435, 3.077084931202128, -1.404002989032794},
  ViewVertical->{0.834486831534477, 
   0.5193434057340058, -0.18415796185925132`}]], "Output",
 CellChangeTimes->{{3.814717569736026*^9, 3.814717608575175*^9}, {
   3.814717673349102*^9, 3.8147177477304416`*^9}, {3.814717804564535*^9, 
   3.8147178218702307`*^9}, 3.8147178589141827`*^9, {3.814717965546163*^9, 
   3.8147179758136005`*^9}, {3.814718012803846*^9, 3.814718022814199*^9}, 
   3.8147181367887287`*^9, {3.8147181704490614`*^9, 3.8147183079937954`*^9}, {
   3.814720422565027*^9, 3.8147204493317633`*^9}},
 CellLabel->
  "Out[2002]=",ExpressionUUID->"2da3d789-9c28-4486-bb16-6979471e3fb2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.814566248986643*^9, 3.8145662613513594`*^9}, {
  3.8145679176227107`*^9, 3.8145679203906775`*^9}, {3.81461201967292*^9, 
  3.8146120213529263`*^9}, {3.8146169304224515`*^9, 3.8146169321179533`*^9}, {
  3.814617032326561*^9, 3.814617032541956*^9}, {3.8146176070494847`*^9, 
  3.814617607447474*^9}, {3.8147189149588027`*^9, 3.814718916558923*^9}, {
  3.814720444318877*^9, 3.8147204458542013`*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[2003]:=",ExpressionUUID->"74bd3cca-d044-45eb-a811-4ee6e255a39b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Phalf", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"P2T", "[", 
           RowBox[{"[", "#1", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"P2T", "[", 
              RowBox[{"[", "#2", "]"}], "]"}], "-", 
             RowBox[{"P2T", "[", 
              RowBox[{"[", "#1", "]"}], "]"}]}], ")"}]}]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Most", "@", 
           RowBox[{"G2", "[", 
            RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
          RowBox[{"Rest", "@", 
           RowBox[{"G2", "[", 
            RowBox[{"[", "iii", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pnew", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"p0", "+", 
         RowBox[{"R", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "-", "p0"}], ")"}], "/", 
           RowBox[{"Norm", "[", 
            RowBox[{"#", "-", "p0"}], "]"}]}]}]}], "&"}], "/@", "Phalf"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"l", "=", 
      RowBox[{"Length", "@", "P2T"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pn", "=", 
      RowBox[{"Most", "@", 
       RowBox[{"G2", "[", 
        RowBox[{"[", "iii", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p2n", "=", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"l", "+", "1"}], ",", 
        RowBox[{"l", "+", 
         RowBox[{"Length", "@", "pn"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Gnew", "=", 
      RowBox[{"p2n", "//", 
       RowBox[{"Append", "[", 
        RowBox[{"First", "@", "p2n"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GNnew", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"First", "@", "#"}], "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"MapThread", "[", 
        RowBox[{"List", ",", 
         RowBox[{"{", 
          RowBox[{"pn", ",", "p2n", ",", 
           RowBox[{
            RowBox[{"Most", "[", "p2n", "]"}], "//", 
            RowBox[{"Prepend", "[", 
             RowBox[{"Last", "@", "p2n"}], "]"}]}]}], "}"}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"P2T", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"P2T", ",", "Pnew"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G2", "[", 
       RowBox[{"[", "iii", "]"}], "]"}], "=", "Gnew"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"G2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"G2", ",", "GNnew"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dl", "=", 
      RowBox[{"Length", "@", 
       RowBox[{"DeleteDuplicates", "[", "P2T", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "P2T"}], " ", ">", " ", "dl"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"First", "@", 
          RowBox[{"First", "@", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Tally", "@", "P2T"}], ",", 
             RowBox[{"y_", "/;", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"y", "===", "List"}], ",", "False", ",", 
                RowBox[{
                 RowBox[{"Last", "@", "y"}], ">", "1"}]}], "]"}]}], ",", "1", 
             ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d2", "=", 
         RowBox[{"Last", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Position", "[", 
            RowBox[{"P2T", ",", 
             RowBox[{"P2T", "[", 
              RowBox[{"[", "d", "]"}], "]"}], ",", "1"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"G2", "=", 
         RowBox[{"G2", "/.", 
          RowBox[{"{", 
           RowBox[{"d2", "\[Rule]", " ", "d"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"G2", "=", 
         RowBox[{"G2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "d2"}]}], "\[Rule]", 
            RowBox[{"x", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"P2T", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"P2T", ",", "d2"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"iii", ",", "1", ",", "26"}], "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8146429051475964`*^9, 3.814642990132888*^9}, {
   3.8146430257404194`*^9, 3.814643047582591*^9}, {3.814643141589532*^9, 
   3.81464320610894*^9}, {3.814643245332893*^9, 3.8146433440919695`*^9}, {
   3.8146433912848587`*^9, 3.8146434150921917`*^9}, {3.814643742893572*^9, 
   3.814643745852497*^9}, {3.814643809973606*^9, 3.8146438250844274`*^9}, {
   3.814643885486765*^9, 3.8146440036526537`*^9}, {3.814644629750491*^9, 
   3.814644629885168*^9}, {3.814645062391035*^9, 3.814645148029211*^9}, {
   3.8146451888773375`*^9, 3.8146453162159104`*^9}, {3.814645445672966*^9, 
   3.814645478046093*^9}, {3.814645841280052*^9, 3.8146458490470066`*^9}, {
   3.814646966378063*^9, 3.814646967552534*^9}, {3.8146476100027075`*^9, 
   3.814647611513939*^9}, {3.814649079427269*^9, 3.8146491527394238`*^9}, 
   3.814649222839332*^9, {3.8146493231262045`*^9, 3.8146493635403037`*^9}, {
   3.814649553847124*^9, 3.814649576837307*^9}, {3.814649688348773*^9, 
   3.8146496994847236`*^9}, {3.814649754861659*^9, 3.8146498133089514`*^9}, {
   3.814649862948065*^9, 3.814649872156497*^9}, {3.8146499153323374`*^9, 
   3.81465001965263*^9}, {3.8146508506386414`*^9, 3.8146509257026787`*^9}, {
   3.8146509883453617`*^9, 3.814651043609383*^9}, {3.8146511134253025`*^9, 
   3.8146511854308863`*^9}, {3.814651271193651*^9, 3.8146513077752843`*^9}, {
   3.8146515357285976`*^9, 3.814651550415368*^9}, {3.814651834553728*^9, 
   3.814651871264655*^9}, {3.8146530003633986`*^9, 3.8146530322340336`*^9}, {
   3.814654228838473*^9, 3.814654262619341*^9}, {3.814654732957466*^9, 
   3.814654754996071*^9}, {3.8146560809095793`*^9, 3.8146560971086035`*^9}, {
   3.814656451198947*^9, 3.814656467964098*^9}, {3.8146565195809097`*^9, 
   3.8146565563979373`*^9}, {3.8146566279914975`*^9, 3.814656690301793*^9}, {
   3.814656752463468*^9, 3.8146567581496*^9}, {3.8146574805666866`*^9, 
   3.8146574996448708`*^9}, {3.8146936639491577`*^9, 3.814693699852565*^9}, {
   3.8146939575350122`*^9, 3.814693981229716*^9}, {3.814697860971505*^9, 
   3.814697890691598*^9}, {3.8146980315087605`*^9, 3.814698097937931*^9}, 
   3.814698135921872*^9, {3.8146983913537636`*^9, 3.814698396082822*^9}, 
   3.81469855168239*^9, 3.814698603593337*^9, {3.814700188727479*^9, 
   3.814700212696859*^9}, {3.8147019900009804`*^9, 3.814701996391655*^9}, {
   3.814702487704785*^9, 3.814702494440706*^9}, {3.8147025758573837`*^9, 
   3.8147025834957886`*^9}, {3.8147027147206135`*^9, 3.8147027223287425`*^9}, 
   3.814702908072275*^9, {3.814702965280555*^9, 3.814703010503089*^9}, {
   3.8147030948560257`*^9, 3.8147031062718053`*^9}, {3.8147033714571056`*^9, 
   3.814703415407232*^9}, {3.814703568862623*^9, 3.8147035930237956`*^9}, {
   3.814703658527173*^9, 3.814703666214548*^9}, 3.814703704183857*^9, {
   3.8147038194152546`*^9, 3.81470384754311*^9}, {3.8147039980856614`*^9, 
   3.814704037710576*^9}, 3.8147040891352777`*^9, 3.8147041406472673`*^9, {
   3.8147042397421737`*^9, 3.814704279839562*^9}, 3.814704382501915*^9, 
   3.8147044250541425`*^9, 3.8147046215920687`*^9, 3.814704665047119*^9, {
   3.8147047955433426`*^9, 3.8147047974861765`*^9}, 3.81470486580614*^9, 
   3.8147051101904545`*^9, 3.814705145150635*^9, {3.8147052416377497`*^9, 
   3.814705241733493*^9}, {3.8147053871895576`*^9, 3.814705396268498*^9}, 
   3.8147054481015186`*^9, {3.814705568348937*^9, 3.8147055692226725`*^9}, {
   3.814705602765505*^9, 3.8147056181156816`*^9}, 3.814705684502311*^9, {
   3.814706293836782*^9, 3.8147063089249907`*^9}, 3.8147063519879723`*^9, 
   3.8147064206767645`*^9, 3.8147065838138437`*^9, 3.814706679110343*^9, {
   3.814706759300805*^9, 3.8147067609563055`*^9}, 3.8147071005901337`*^9, 
   3.8147071399083395`*^9, {3.8147071820045013`*^9, 3.814707182324628*^9}, {
   3.814707330972618*^9, 3.814707331692664*^9}, {3.8147077563332024`*^9, 
   3.814707784109973*^9}, {3.8147078205722103`*^9, 3.8147078208832893`*^9}, {
   3.814707853126401*^9, 3.814707853955387*^9}, {3.814707984979744*^9, 
   3.81470798541127*^9}, {3.8147083906994224`*^9, 3.81470839085105*^9}, {
   3.81470897553936*^9, 3.8147089825058436`*^9}, 3.8147150196547785`*^9, 
   3.814715134951955*^9, {3.81471525951108*^9, 3.8147152596776333`*^9}, {
   3.814715331655739*^9, 3.8147153692610855`*^9}, 3.814715461383092*^9, 
   3.814715523029695*^9, 3.814715600230495*^9, 3.8147156468068066`*^9, {
   3.814716019428685*^9, 3.8147160196131926`*^9}, {3.8147161199653916`*^9, 
   3.8147161402304974`*^9}, {3.8147169134369707`*^9, 3.814716941437003*^9}, 
   3.814717112325548*^9, {3.8147171624768066`*^9, 3.814717179899892*^9}, {
   3.814718399556148*^9, 3.814718402719696*^9}},
 CellLabel->
  "In[2003]:=",ExpressionUUID->"e5c45130-107a-4a0b-8a08-4ea4f1952725"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Gnext", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"First", "@", "#"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "@@", 
           RowBox[{"Select", "[", 
            RowBox[{"G2", ",", 
             RowBox[{
              RowBox[{"ContainsAny", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", "i", "}"}]}], "]"}], "&"}]}], "]"}]}], "]"}], 
         ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "12"}], "}"}]}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"G2", "=", 
    RowBox[{"Take", "[", 
     RowBox[{"G2", ",", "14"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"G2", "=", 
       RowBox[{"G2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "iii"}]}], "\[Rule]", 
          RowBox[{"x", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Gnext", "=", 
       RowBox[{"Gnext", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "iii"}]}], "\[Rule]", 
          RowBox[{"x", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2T", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"P2T", ",", "1"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]",
      ",", 
     RowBox[{"{", 
      RowBox[{"iii", ",", 
       RowBox[{"Length", "@", "Gnext"}], ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"G2", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"G2", ",", "Gnext"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8146958313526692`*^9, 3.814695831521218*^9}, {
   3.8147003402554097`*^9, 3.814700420446424*^9}, {3.814700495752002*^9, 
   3.8147004970788407`*^9}, {3.8147005383595376`*^9, 3.814700539462132*^9}, {
   3.814700649879161*^9, 3.814700698397905*^9}, {3.814700756679611*^9, 
   3.814700808182863*^9}, {3.8147008529114513`*^9, 3.814700880790124*^9}, {
   3.8147009278082037`*^9, 3.814700931101843*^9}, {3.8147010079113035`*^9, 
   3.8147010721730533`*^9}, 3.8147011349652786`*^9, {3.8147018975968537`*^9, 
   3.8147019038610144`*^9}, {3.81470243585435*^9, 3.814702440085327*^9}, {
   3.814702472133008*^9, 3.814702476573412*^9}, {3.814702529383062*^9, 
   3.8147025534767027`*^9}, {3.814702705134376*^9, 3.8147027059087048`*^9}, {
   3.814704549965904*^9, 3.814704597211378*^9}, {3.814704707436909*^9, 
   3.8147047077952137`*^9}, {3.814704810572117*^9, 3.814704830434602*^9}, {
   3.8147051521963387`*^9, 3.8147051568672*^9}, {3.8147054012444816`*^9, 
   3.8147054034907165`*^9}, {3.8147054598680925`*^9, 
   3.8147054621941905`*^9}, {3.8147056261954975`*^9, 3.814705627827109*^9}, {
   3.814705743131539*^9, 3.8147057447782063`*^9}, {3.8147063712915735`*^9, 
   3.8147063736336107`*^9}, {3.814706549330411*^9, 3.81470655346487*^9}, 
   3.814706684066964*^9, {3.814706956146846*^9, 3.8147069563298087`*^9}, 
   3.8147071081459355`*^9, 3.814707151370452*^9, {3.814707188321495*^9, 
   3.814707188505974*^9}, 3.814707519081984*^9, 3.8147077618967648`*^9, 
   3.8147077958421707`*^9, {3.8147078278572927`*^9, 3.814707827938075*^9}, {
   3.814707868721197*^9, 3.814707869112792*^9}, {3.8147082932258606`*^9, 
   3.8147082938884387`*^9}, 3.814712648717688*^9, {3.8147137573161964`*^9, 
   3.814713762636875*^9}, {3.8147151411244574`*^9, 3.8147151440037823`*^9}, {
   3.8147153378757095`*^9, 3.814715356314763*^9}, {3.8147156112835646`*^9, 
   3.81471561249088*^9}, {3.81471579443613*^9, 3.814715820235551*^9}, {
   3.8147160269792757`*^9, 3.8147160364434004`*^9}, {3.8147161249175625`*^9, 
   3.814716136777668*^9}, {3.8147169442536163`*^9, 3.814716946353959*^9}, {
   3.814717118970949*^9, 3.8147171208572707`*^9}, {3.8147171662108603`*^9, 
   3.8147171684248457`*^9}, {3.814718408113682*^9, 3.8147184109926553`*^9}},
 CellLabel->
  "In[2004]:=",ExpressionUUID->"b80f623a-a7e3-4870-bb8e-414b9e18fc3f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"e1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      FractionBox["5", "2"], ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"e2", "=", 
    RowBox[{"{", 
     RowBox[{"18", ",", "15", ",", "4"}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ee1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["2", 
        RowBox[{"3", " ", 
         SqrtBox["5"]}]]}], ",", 
      FractionBox[
       SqrtBox["5"], "3"], ",", 
      FractionBox["4", 
       RowBox[{"3", " ", 
        SqrtBox["5"]}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ee2", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["23", 
       RowBox[{"3", " ", 
        SqrtBox["70"]}]], ",", 
      FractionBox[
       SqrtBox[
        FractionBox["10", "7"]], "3"], ",", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"3", " ", 
         SqrtBox["70"]}]]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ee3", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["14"]]}], ",", 
      SqrtBox[
       FractionBox["2", "7"]], ",", 
      RowBox[{"-", 
       FractionBox["3", 
        SqrtBox["14"]]}]}], "}"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8145603860123634`*^9, 3.8145604473511853`*^9}, {
  3.8145622397988462`*^9, 3.814562255863092*^9}, {3.814562339929917*^9, 
  3.814562341959154*^9}, {3.8145626999071054`*^9, 3.814562699990883*^9}, {
  3.8145627340014057`*^9, 3.81456273977603*^9}, {3.8145678551566696`*^9, 
  3.8145678680161605`*^9}, {3.8145679760941753`*^9, 3.814567996823166*^9}, {
  3.8146112545426297`*^9, 3.8146112826083813`*^9}, {3.814611370635423*^9, 
  3.814611384244583*^9}, {3.8147185162668643`*^9, 3.814718518607922*^9}},
 CellLabel->
  "In[2005]:=",ExpressionUUID->"cef058e4-2b10-48a4-8486-9283870dc54a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "\[Rule]", "0.025"}], ",", "Green", ",", 
     RowBox[{"Point", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "Blue", ",", 
     RowBox[{"Point", "@", "ee1"}], ",", "Black", ",", 
     RowBox[{"Point", "@", "e1"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"e1", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "e2"}], "}"}], "]"}], 
     ",", "Blue", ",", " ", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"ee1", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "ee2", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "ee3"}], "}"}], 
      "]"}]}], "}"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.814562647825401*^9, 3.814562686519855*^9}, {
   3.8145628003459997`*^9, 3.8145628199625683`*^9}, {3.814562945194155*^9, 
   3.8145629590159426`*^9}, {3.81456327018548*^9, 3.8145632855221653`*^9}, {
   3.8145633218845205`*^9, 3.8145633812901554`*^9}, 3.814563418821824*^9, 
   3.8145635404144773`*^9, {3.8145637222809305`*^9, 3.814563749680361*^9}, {
   3.814568022376194*^9, 3.81456802253474*^9}, 3.814571942277595*^9, {
   3.814611285041855*^9, 3.8146113191059685`*^9}, {3.8147185231054544`*^9, 
   3.8147185256556764`*^9}},
 CellLabel->
  "In[2006]:=",ExpressionUUID->"eacdc08d-dad1-4cc7-ab0d-504862e6295f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"M1", "=", 
    RowBox[{"-", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"e1", ".", "e2"}], "/", 
        RowBox[{"e1", ".", "e1"}]}], "*", "e1"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"M2", "=", 
    RowBox[{"Norm", "[", 
     RowBox[{"e2", "-", 
      RowBox[{
       RowBox[{
        RowBox[{"e1", ".", "e2"}], "/", 
        RowBox[{"e1", ".", "e1"}]}], "*", "e1"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"M1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Norm", "[", "e1", "]"}], "*", "M2"}], ")"}]}], "*", "e1"}], 
    "+", 
    RowBox[{
     RowBox[{"1", "/", "M2"}], "*", "e2", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["23", 
        RowBox[{"3", " ", 
         SqrtBox["70"]}]], ",", 
       FractionBox[
        SqrtBox[
         FractionBox["10", "7"]], "3"], ",", 
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"3", " ", 
          SqrtBox["70"]}]]}]}], "}"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.814570736439392*^9, 3.814570843470645*^9}, {
  3.8145713150381804`*^9, 3.814571323453871*^9}, {3.8147032815891747`*^9, 
  3.8147032825090213`*^9}, {3.814704323827094*^9, 3.814704325323295*^9}, {
  3.8147184437203703`*^9, 3.81471848784676*^9}},
 CellLabel->
  "In[2007]:=",ExpressionUUID->"24401974-5ac5-49aa-b1b8-d8f79c5be197"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"kmPolyhedronFaceToSurface", "[", 
     RowBox[{"vertcoord_List", ",", "face_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P", "=", 
         RowBox[{"Transpose", "@", "vertcoord"}]}], ",", "V", ",", "e1", ",", 
        "e2", ",", "e3", ",", "temp", ",", "proj"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\:041f\:0430\:0440\:0430\:043b\:043b\:0435\:043b\:044c\:043d\:044b\
\:0439", " ", "\:043f\:0435\:0440\:0435\:043d\:043e\:0441", " ", "\:043a", 
        " ", "\:043d\:0430\:0447\:0430\:043b\:0443", " ", 
        "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"[", "face", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", 
            RowBox[{"First", "@", 
             RowBox[{"P", "[", 
              RowBox[{"[", "face", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
         RowBox[{"P", "[", 
          RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:0412\:0435\:043a\:0442\:043e\:0440\:044b", " ", "\:043d\:0430", 
         " ", "\:0440\:0435\:0431\:0440\:0430\:0445", " ", 
         "\:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430", " ", "\:0432", 
         " ", "\:0441\:0442\:0430\:0440\:043e\:043c", " ", 
         "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Most", "@", "#"}], "-", 
            RowBox[{"Rest", "@", "#"}]}], ")"}], "&"}], "@", 
         RowBox[{"P", "[", 
          RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:041f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435", " ", 
         "\:043d\:043e\:0432\:043e\:0433\:043e", " ", 
         "\:0431\:0430\:0437\:0438\:0441\:0430"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e1", ",", "e2"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "@", "V"}], ",", 
          RowBox[{"First", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Rest", "@", "V"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"MatrixRank", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "@", "V"}], ",", "#"}], "}"}], "]"}], ">", 
               "1"}], "&"}], ",", "1"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"e1", ".", "e2"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"e3", "=", 
        RowBox[{"Cross", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:041a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b", " ", 
         "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
         "\:0433\:0440\:0430\:043d\:0438", " ", "\:0432", " ", 
         "\:043d\:043e\:0432\:043e\:043c", " ", 
         "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"#", ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"{", 
               RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}], "]"}]}], ",", 
            "2"}], "]"}], "&"}], "/@", 
         RowBox[{"P", "[", 
          RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:041f\:0435\:0440\:0435\:0445\:043e\:0434", " ", "\:043a", " ", 
         "\:043e\:0440\:0442\:043e\:043d\:043e\:0440\:043c\:0438\:0440\:043e\
\:0432\:0430\:043d\:043d\:043e\:043c\:0443", " ", 
         "\:0431\:0430\:0437\:0438\:0441\:0443", " ", 
         "\:043f\:0440\:043e\:0446\:0435\:0441\:0441\:043e\:043c", " ", 
         "\:0413\:0440\:0430\:043c\:0430"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"proj", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"e1", ".", "e2"}], "/", 
          RowBox[{"e1", ".", "e1"}]}], "*", "e1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "\:041a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b", " ", 
         "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
         "\:0433\:0440\:0430\:043d\:0438", " ", "\:0432", " ", 
         "\:043d\:043e\:0432\:043e\:043c", " ", 
         "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"Norm", "@", "e1"}]}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Norm", "[", "proj", "]"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Norm", "[", "e1", "]"}], "*", 
                   RowBox[{"Norm", "[", 
                    RowBox[{"e2", "-", "proj"}], "]"}]}], ")"}]}], ",", 
                RowBox[{"1", "/", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"e2", "-", "proj"}], "]"}]}]}], "}"}]}], "}"}], 
            "]"}]}], ")"}], "&"}], "/@", "temp"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzD1IAnEABfBTwSy4QzGQyCXxMkgIKYkCgxIswSk1pCgoCKMIQyKHsNbA
Vh2KtijwKhwuL3FQL+h7iCRrKjBIKTPaukDo/254/IbHex1zofF5JUVRbSSQ
8gkSv1Qb9hRF6pRYdStoODuoM0GbfdQCF+4KXTDP1x1QyOec0Hy47IX0mMEP
1YxYgRsr0SpcLzF1qLFXvuW9kJDgRIluwBbxJZYmWg2ZbRgxls0CcW8qy8Jg
7HkHbr259mHp2JaEvI89gmvRQgpOegdyMFssn8NXT+ABKh6t77A17fiBndyu
BC/ExB9sDhn1Z8SPHr0B1jhtO2SCWiPMOze7YfjpRPZXV+6FffrMEJxJsW65
v4rIjsRNftiYdgXgQX9Yc4k/86es+iuUvCHeN8U5uOq9Vt4SVYsWFfwHSW3R
hw==
  "],
 CellLabel->
  "In[2008]:=",ExpressionUUID->"fe80b143-a316-4d19-83ec-8dfd38a8781f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.814570847432455*^9, 3.814570877197914*^9}, 
   3.8147184719972143`*^9},
 CellLabel->
  "In[2009]:=",ExpressionUUID->"b7dbfc42-77d7-4708-90b4-35917f5a0433"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8147184739536495`*^9, 3.8147184739606304`*^9}},
 CellLabel->
  "In[2010]:=",ExpressionUUID->"2844feea-64ab-46ba-91b4-5002d3b1de71"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1247, 909},
WindowMargins->{{Automatic, 276}, {Automatic, 24}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1111, 17, 99, "Section",ExpressionUUID->"28b642df-7834-4a5e-b229-b76c5bdd582c"],
Cell[CellGroupData[{
Cell[1716, 43, 3188, 59, 78, "Subsection",ExpressionUUID->"d970f10b-d87d-46b0-830b-9527464b182e"],
Cell[4907, 104, 5491, 140, 421, "Input",ExpressionUUID->"062c0354-0964-4644-a4f3-655530e55547"],
Cell[10401, 246, 9513, 210, 401, "Input",ExpressionUUID->"1e9a72d5-195f-45f4-97c7-aef243d5c85e"],
Cell[19917, 458, 192, 3, 34, "Text",ExpressionUUID->"7bb8d145-dfb3-412e-bb81-67c963f17a10"],
Cell[20112, 463, 2515, 69, 140, "Input",ExpressionUUID->"66ddde72-8aac-4971-a42c-0a1c6fb850f2"],
Cell[CellGroupData[{
Cell[22652, 536, 6925, 135, 362, "Input",ExpressionUUID->"c5fadade-00e3-4f5b-be67-a4107422eaac"],
Cell[29580, 673, 7319, 176, 381, "Output",ExpressionUUID->"839fff48-3e9f-4f21-a815-02b8cfc90f77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36936, 854, 1148, 21, 67, "Input",ExpressionUUID->"09866175-5ca3-4c1d-a862-f45bd11f6782"],
Cell[38087, 877, 570, 10, 32, "Output",ExpressionUUID->"cf936107-9c38-426c-98ea-83fa2dc22060"],
Cell[38660, 889, 1149, 29, 36, "Output",ExpressionUUID->"2c23d5dc-3b65-4d46-a66f-33211e365419"],
Cell[39812, 920, 1390, 38, 32, "Output",ExpressionUUID->"6c610438-7bd6-45c2-92d8-6b2979a022cf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41251, 964, 4653, 92, 103, "Subsection",ExpressionUUID->"d22ac87c-2852-4c7a-8b81-24fb5c24a630"],
Cell[45907, 1058, 1082, 28, 82, "Input",ExpressionUUID->"8aa5b540-9ba0-44db-83c6-285e325198b6"],
Cell[46992, 1088, 196, 3, 34, "Text",ExpressionUUID->"cef2d120-37b7-40b2-b8b9-96170c3b078b"],
Cell[CellGroupData[{
Cell[47213, 1095, 953, 21, 64, "Input",ExpressionUUID->"a2309885-8f94-441d-b2f6-b0e8c8c4de48"],
Cell[48169, 1118, 741, 14, 32, "Output",ExpressionUUID->"5fd0d19a-9451-47da-9a0e-10a0840ae136"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48959, 1138, 1670, 25, 28, "Subsection",ExpressionUUID->"8873b412-28d0-4d51-bd81-088c2c491960"],
Cell[50632, 1165, 1796, 44, 64, "Input",ExpressionUUID->"5d582a66-de74-4123-9650-cb9e84b6b915"],
Cell[52431, 1211, 194, 3, 34, "Text",ExpressionUUID->"f69b87e0-d002-417c-a56a-4fe482db44e8"],
Cell[52628, 1216, 2542, 67, 140, "Input",ExpressionUUID->"a4aeba64-982d-4add-a832-68c3494cf3e9"],
Cell[CellGroupData[{
Cell[55195, 1287, 7463, 144, 362, "Input",ExpressionUUID->"b0c8bfe7-85ac-49ad-a1b3-d6a532771d17"],
Cell[62661, 1433, 6601, 160, 441, "Output",ExpressionUUID->"acb6a40d-c713-4e18-ab24-2432535610ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69299, 1598, 827, 21, 64, "Input",ExpressionUUID->"fddc2cbc-c2ce-4de6-bcc8-fe96ad675707"],
Cell[70129, 1621, 334, 7, 32, "Output",ExpressionUUID->"c311f090-b0c6-4090-b32b-0777bf508610"],
Cell[70466, 1630, 233, 5, 22, "Print",ExpressionUUID->"a8491831-2c91-40a9-a2b3-2572bf425020"]
}, Open  ]],
Cell[70714, 1638, 770, 12, 28, "Input",ExpressionUUID->"3a33c4cb-8198-4b76-a775-066eb6a5b53f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71533, 1656, 1480, 22, 99, "Section",ExpressionUUID->"4c7d503b-7b75-493e-98a6-5f222d6978a1"],
Cell[CellGroupData[{
Cell[73038, 1682, 2052, 30, 53, "Subsection",ExpressionUUID->"cff49606-ee4f-440c-925a-0f4c871f5f21"],
Cell[75093, 1714, 1174, 32, 45, "Input",ExpressionUUID->"e224338f-c787-4c54-949f-31b32cd3b33f"],
Cell[76270, 1748, 8254, 205, 940, "Input",ExpressionUUID->"2dcb67c1-634e-4c42-bfc5-415293e0dc11"],
Cell[84527, 1955, 5987, 142, 588, "Input",ExpressionUUID->"f8a7373e-333c-4949-a883-9d46d11a34bd"],
Cell[90517, 2099, 408, 10, 28, "Input",ExpressionUUID->"9ba01d09-d5ef-4b25-81cc-a03e8f0ba03e"],
Cell[90928, 2111, 538, 13, 28, "Input",ExpressionUUID->"952ee46f-fb98-4fc0-8d24-ef53f69fe7b4"],
Cell[91469, 2126, 367, 10, 28, "Input",ExpressionUUID->"23b1a372-9133-4e9c-b8c7-ad0e6db5cb4f"],
Cell[CellGroupData[{
Cell[91861, 2140, 4894, 89, 267, "Input",ExpressionUUID->"c1f49e62-2efc-4f1f-b72d-d52218f7f069"],
Cell[96758, 2231, 6603, 129, 536, "Output",ExpressionUUID->"2da3d789-9c28-4486-bb16-6979471e3fb2"]
}, Open  ]],
Cell[103376, 2363, 629, 11, 28, "Input",ExpressionUUID->"74bd3cca-d044-45eb-a811-4ee6e255a39b"],
Cell[104008, 2376, 9821, 206, 447, "Input",ExpressionUUID->"e5c45130-107a-4a0b-8a08-4ea4f1952725"],
Cell[113832, 2584, 4269, 88, 162, "Input",ExpressionUUID->"b80f623a-a7e3-4870-bb8e-414b9e18fc3f"],
Cell[118104, 2674, 1911, 55, 191, "Input",ExpressionUUID->"cef058e4-2b10-48a4-8486-9283870dc54a"],
Cell[120018, 2731, 1516, 34, 28, "Input",ExpressionUUID->"eacdc08d-dad1-4cc7-ab0d-504862e6295f"],
Cell[121537, 2767, 1458, 45, 117, "Input",ExpressionUUID->"24401974-5ac5-49aa-b1b8-d8f79c5be197"],
Cell[122998, 2814, 6585, 161, 333, "Input",ExpressionUUID->"fe80b143-a316-4d19-83ec-8dfd38a8781f"],
Cell[129586, 2977, 204, 4, 28, "Input",ExpressionUUID->"b7dbfc42-77d7-4708-90b4-35917f5a0433"],
Cell[129793, 2983, 180, 3, 28, InheritFromParent,ExpressionUUID->"2844feea-64ab-46ba-91b4-5002d3b1de71"]
}, Open  ]]
}, Open  ]]
}
]
*)

