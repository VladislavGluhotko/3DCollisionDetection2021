(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    145155,       3240]
NotebookOptionsPosition[    144264,       3220]
NotebookOutlinePosition[    144637,       3236]
CellTagsIndexPosition[    144594,       3233]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\:0410\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:044b \:043e\:0431\
\:043d\:0430\:0440\:0443\:0436\:0435\:043d\:0438\:044f \:0441\:0442\:043e\
\:043b\:043a\:043d\:043e\:0432\:0435\:043d\:0438\:0439 \:0432 \:043a\:043e\
\:043c\:043f\:044c\:044e\:0442\:0435\:0440\:043d\:043e\:0439 \:0433\:0440\
\:0430\:0444\:0438\:043a\:0435.", "Text",
 CellChangeTimes->{{3.8281615279934697`*^9, 
  3.8281615493265505`*^9}},ExpressionUUID->"74d78389-241b-496f-9f67-\
034c4c7005fe"],

Cell["\<\
- \:0441\:0444\:043e\:0440\:043c\:0443\:043b\:0438\:0440\:043e\:0432\:0430\
\:0442\:044c \:043f\:0440\:043e\:0431\:043b\:0435\:043c\:0443 \:043e\:0431\
\:043d. \:0441\:0442\:043e\:043b\:043a\:043d.
 - \:043a\:0430\:043a\:0443\:044e \:0447\:0430\:0441\:0442\:044c \:043f\:0440\
\:043e\:0431\:043b\:0435\:043c\:044b \:044f \:0438\:0441\:0441\:043b\:0435\
\:0434\:0443\:044e 
 - \:043d\:0430\:0441\:043a\:043e\:043b\:044c\:043a\:043e \:044d\:0442\:0430 \
\:0447\:0430\:0441\:0442\:044c \:043f\:0440\:043e\:0431\:043b\:0435\:043c\
\:044b \:0443\:0436\:0435 \:0438\:0441\:0441\:043b\:0435\:0434\:043e\:0432\
\:0430\:043d\:0430, \:043e\:0441\:043d\:043e\:0432\:043d\:044b\:0435 \:0440\
\:0435\:0437\:0443\:043b\:044c\:0442\:0430\:0442\:044b \
\>", "Text",
 CellChangeTimes->{{3.8281616411866956`*^9, 
  3.8281617797858624`*^9}},ExpressionUUID->"dab625d7-2239-4247-a19c-\
d686f6ac1e87"],

Cell["\<\
\:0426\:0435\:043b\:044c : \:0438\:0437\:0443\:0447\:0438\:0442\:044c \:0438 \
\:0440\:0435\:0430\:043b\:0438\:0437\:043e\:0432\:0430\:0442\:044c \:043e\
\:0441\:043d\:043e\:0432\:043d\:044b\:0435 \:0430\:043b\:0433\:043e\:0440\
\:0438\:0442\:043c\:044b \:043e\:0431\:043d\:0430\:0440\:0443\:0436\:0435\
\:043d\:0438\:044f \:0441\:0442\:043e\:043b\:043a\:043d\:043e\:0432\:0435\
\:043d\:0438\:0439 \:0432 \:043a\:043e\:043c\:043f. \:0433\:0440\:0430\:0444\
\:0438\:043a\:0435.
 \
\>", "Text",
 CellChangeTimes->{{3.828161813065076*^9, 3.828161820060766*^9}, {
  3.8281630284676294`*^9, 3.8281630820964003`*^9}, {3.8281631403356237`*^9, 
  3.8281631604493113`*^9}, {3.8281632058095617`*^9, 3.8281632065209093`*^9}, {
  3.828163245104704*^9, 
  3.8281632518070717`*^9}},ExpressionUUID->"2422ae22-34c7-4bb8-8a6d-\
c95d01343304"],

Cell[TextData[{
 StyleBox["\:0412\:043e\:0437\:043c\:043e\:0436\:043d\:044b\:0435 \
\:0437\:0430\:0434\:0430\:0447\:0438 :",
  FontWeight->"Bold"],
 "\n1. (hitscan) - \:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\
\:0438\:0435 \:043b\:0443\:0447\:0430 \:0441 \:043f\:043e\:043b\:0438\:044d\
\:0434\:0440\:0430\:043c\:0438\n2. (projectile ballistic) - \
\:043e\:0431\:043d\:0430\:0440\:0443\:0436\:0435\:043d\:0438\:0435 \:0442\
\:043e\:0447\:043a\:0438 \:0441\:043e\:043f\:0440\:0438\:043a\:043e\:0441\
\:043d\:043e\:0432\:0435\:043d\:0438\:044f, \:0438\:043b\:0438 \:043d\:0430\
\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435 \:0442\:043e\:0447\:043a\
\:0438 \:043a\:0430\:0441\:0430\:043d\:0438\:044f \:0434\:0432\:0438\:0436\
\:0443\:0449\:0438\:0445\:0441\:044f \:0441\:0444\:0435\:0440\:044b \:0438 \
\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430\n3. \:0422\:0435\:0441\:0442 \
(\:0434\:0430/\:043d\:0435\:0442) \:043d\:0430 \:043f\:0435\:0440\:0435\:0441\
\:0435\:0447\:0435\:043d\:0438\:0435 \:0434\:0432\:0443\:0445 \:043f\:0440\
\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:044b\:0445 \:043f\:043e\
\:043b\:0438\:044d\:0434\:0440\:043e\:0432 (\:043a\:043e\:043d\:0435\:0447\
\:043d\:043e\:0433\:043e \:043d\:0430\:0431\:043e\:0440\:0430 \:0432\:044b\
\:043f\:0443\:043a\:043b\:044b\:0445 \:043f\:043e\:043b\:0438\:044d\:0434\
\:0440\:043e\:0432) \n4. \:041f\:0443\:0441\:0442\:044c \:043f\:0440\:043e\
\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:044b\:0435 \:043f\:043e\:043b\
\:0438\:044d\:0434\:0440\:044b \:043f\:0440\:0438 \:0434\:0432\:0438\:0436\
\:0435\:043d\:0438\:0438 \:043f\:0435\:0440\:0435\:0441\:0435\:043a\:043b\
\:0438\:0441\:044c \:043f\:043e \:0442\:0435\:0441\:0442\:0443 (\:043f\:0443\
\:043d\:043a\:0442 3). \:041e\:043f\:0440\:0435\:0434\:0435\:043b\:0438\:0442\
\:044c \:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435 \:043f\:043e\
\:043b\:0438\:044d\:0434\:0440\:043e\:0432, \:043f\:0440\:0438 \:043a\:043e\
\:0442\:043e\:0440\:043e\:043c \:043e\:043d\:0438 \:043a\:0430\:0441\:0430\
\:043b\:0438\:0441\:044c \:0434\:0440\:0443\:0433 \:0434\:0440\:0443\:0433\
\:0430. (\:043f\:043e\:0434\:043e\:0439\:0434\:0435\:0442 \:043d\:0430\:043f\
\:0440\:0438\:043c\:0435\:0440 \:0430\:043b\:0433\:043e\:0440\:0438\:0442\
\:043c GJK)"
}], "Text",
 CellChangeTimes->{{3.827424032840248*^9, 3.82742408390287*^9}, {
   3.827424506553049*^9, 3.8274245068332977`*^9}, 3.82742597278417*^9, {
   3.827427055139844*^9, 3.827427076768978*^9}, {3.8274276557653522`*^9, 
   3.8274276858937783`*^9}, {3.8274304492399464`*^9, 
   3.8274304615230885`*^9}, {3.828162245078596*^9, 3.8281622626570444`*^9}, {
   3.828162292735496*^9, 3.8281623142649007`*^9}, {3.828162506960209*^9, 
   3.828162517522592*^9}, {3.8281626440756764`*^9, 3.8281626623089657`*^9}, {
   3.828162762846959*^9, 3.82816277850439*^9}, {3.8281634131202474`*^9, 
   3.8281634162247725`*^9}},ExpressionUUID->"a088e911-5b7f-4740-b723-\
3198574edf3a"],

Cell[TextData[{
 StyleBox["\:041f\:043e\:0434\:0437\:0430\:0434\:0430\:0447\:0438 :",
  FontWeight->"Bold"],
 "\n \:0410) \:0442\:0435\:0441\:0442 \:043d\:0430 \:0432\:044b\:043f\:0443\
\:043a\:043b\:043e\:0441\:0442\:044c \:043f\:043e\:043b\:0438\:044d\:0434\
\:0440\:0430\n \:0411) \:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435 \
\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\:0433\:043e\
 \:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430 \:043d\:0430 \:0432\:044b\
\:043f\:0443\:043a\:043b\:044b\:0435 \:0447\:0430\:0441\:0442\:0438\n \:0412) \
\:0441\:043e\:0437\:0434\:0430\:043d\:0438\:0435 \:0443\:043f\:0440\:043e\
\:0449\:0435\:043d\:043d\:043e\:0433\:043e \:043e\:0431\:044a\:0435\:043c\
\:043b\:044e\:0449\:0435\:0433\:043e \:043e\:0431\:044a\:0435\:043c\:0430, \
\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0449\:0435\:0433\:043e \:0432 \
\:0441\:0435\:0431\:0435 \:043f\:043e\:043b\:0438\:044d\:0434\:0440 (bounding \
box/volume)\n \:0413) \:0434\:0432\:043e\:0438\:0447\:043d\:043e\:0435 \:0440\
\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435 \:043e\:0431\:044a\:0435\
\:043c\:043b\:044e\:0449\:0435\:0433\:043e \:043e\:0431\:044a\:0435\:043c\
\:0430 (binary space partitioning)"
}], "Text",
 CellChangeTimes->{{3.8274260092256966`*^9, 3.8274261295423293`*^9}, {
  3.8274261717085075`*^9, 3.8274261959147587`*^9}, {3.8274262295876665`*^9, 
  3.8274262448139343`*^9}, {3.8274263208176055`*^9, 3.827426326680919*^9}, {
  3.827426371619793*^9, 3.8274263802127924`*^9}, {3.827426420836505*^9, 
  3.827426421283309*^9}, {3.828161245897545*^9, 
  3.828161275278762*^9}},ExpressionUUID->"2369643b-cb5e-4638-9312-\
1756432c097f"],

Cell[TextData[{
 StyleBox["\:0410\:043b\:0433\:043e\:0440\:0438\:0442\:043c\:044b :",
  FontWeight->"Bold"],
 "\n 1) AABB\n 2) BSP\n 3) GJK\n "
}], "Text",
 CellChangeTimes->{{3.8274260092256966`*^9, 3.8274261295423293`*^9}, {
  3.8274261717085075`*^9, 3.8274261959147587`*^9}, {3.8274262295876665`*^9, 
  3.8274262448139343`*^9}, {3.8274263208176055`*^9, 3.827426326680919*^9}, {
  3.827426371619793*^9, 3.8274263802127924`*^9}, {3.827426420836505*^9, 
  3.827426421283309*^9}, {3.8281611508365927`*^9, 
  3.8281612031508846`*^9}},ExpressionUUID->"1064136e-b50e-4ad8-b762-\
45f8bb4ea268"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ConvPolyhedronFace", "[", 
     RowBox[{"vertcoord_List", ",", "face_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", 
        RowBox[{"l", "=", 
         RowBox[{"Length", "@", "face"}]}], ",", 
        RowBox[{"V", "=", 
         RowBox[{"ConvPolyhedronFaceToSurface", "[", 
          RowBox[{"vertcoord", ",", "face"}], "]"}]}], ",", "X", ",", "Y", 
        ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"F", "=", 
        RowBox[{
         RowBox[{"Range", "[", "l", "]"}], "//", 
         RowBox[{"Append", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "\:041e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:0435",
           " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0430", " ", 
          RowBox[{"\:043e\:0431\:0445\:043e\:0434\:0430", ":", " ", 
           RowBox[{
           "\:0435\:0441\:043b\:0438", " ", "\:043e\:0431\:0445\:043e\:0434", 
            " ", "\:043e\:0442\:0440\:0438\:0446\:0430\:0442\:0435\:043b\:044c\
\:043d\:044b\:0439"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{
          "\:0442\:043e", " ", "\:0433\:0440\:0430\:043d\:044c", " ", 
           "\:043e\:0442\:0440\:0430\:0436\:0430\:0435\:043c", " ", 
           RowBox[{
           "\:0441\:0438\:043c\:043c", ".", " ", "\:043e\:0442\:043d", ".", 
            " ", "X"}]}], "-", 
          RowBox[{"\:043e\:0441\:0438", " ", 
           RowBox[{"(", 
            RowBox[{"y", " ", "\[Rule]", " ", 
             RowBox[{"-", "y"}]}], ")"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"Y", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Most", "@", "X"}], ",", 
                RowBox[{"Rest", "@", "Y"}]}], "}"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "*", 
            RowBox[{"Y", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "-", 
           RowBox[{"Total", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Rest", "@", "X"}], ",", 
                RowBox[{"Most", "@", "Y"}]}], "}"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"Y", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}]}], "<", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"V", "=", 
          RowBox[{"V", "*", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"Length", "@", "V"}]}], "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "\:041d\:0430\:0445\:043e\:0436\:0434\:0435\:043d\:0438\:0435", " ", 
          "\:043f\:0435\:0440\:0432\:043e\:0433\:043e", " ", 
          
          "\:043f\:043e\:043f\:0430\:0432\:0448\:0435\:0433\:043e\:0441\:044f\
", " ", "\:0443\:0433\:043b\:0430"}], ",", " ", 
         RowBox[{
         "\:0438\:043c\:0435\:044e\:0449\:0435\:0433\:043e", "..."}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"List", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "3"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Take", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Take", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"x_", "/;", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"x", "===", " ", "List"}], ",", "False", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Det", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#2", "-", "#1"}], ",", 
                    RowBox[{"#3", "-", "#2"}]}], "}"}], "]"}], "&"}], "[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"V", "[", 
                   RowBox[{"[", "x", "]"}], "]"}]}], "]"}], ">", "0"}]}], 
              "]"}]}], ",", "1", ",", "1"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "\:041d\:0430", " ", "\:0432\:044b\:0445\:043e\:0434\:0435"}], " ", 
         "-", " ", 
         RowBox[{
         "\:0433\:0440\:0430\:043d\:044c", " ", "\:043f\:0440\:0438", " ", 
          "\:0432\:0437\:0433\:043b\:044f\:0434\:0435", " ", "\:0441\:043e", 
          " ", "\:0441\:0442\:043e\:0440\:043e\:043d\:044b", " ", 
          "\:0432\:043d\:0435\:0448\:043d\:0435\:0439", " ", 
          "\:043d\:043e\:0440\:043c\:0430\:043b\:0438", " ", "\:0438", " ", 
          "\:043d\:043e\:043c\:0435\:0440\:0430", " ", 
          "\:0432\:0435\:0440\:0448\:0438\:043d"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vertcoord", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "}"}], "&"}], "@", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"face", ",", 
            RowBox[{"Rest", "@", "face"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"pos", ",", 
            RowBox[{"pos", "+", "l", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ConvPolyhedronFaceToSurface", "[", 
     RowBox[{"vertcoord_List", ",", "face_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"P", "=", "vertcoord"}], ",", "V", ",", "e1", ",", "e2", 
          ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\:041f\:0430\:0440\:0430\:043b\:043b\:0435\:043b\:044c\:043d\:044b\
\:0439", " ", "\:043f\:0435\:0440\:0435\:043d\:043e\:0441", " ", "\:043a", 
          " ", "\:043d\:0430\:0447\:0430\:043b\:0443", " ", 
          "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "face", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"First", "@", 
               RowBox[{"P", "[", 
                RowBox[{"[", "face", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
           RowBox[{"P", "[", 
            RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "\:0412\:0435\:043a\:0442\:043e\:0440\:044b", " ", "\:043d\:0430", 
           " ", "\:0440\:0435\:0431\:0440\:0430\:0445", " ", 
           "\:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430", " ", "\:0432", 
           " ", "\:0441\:0442\:0430\:0440\:043e\:043c", " ", 
           "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"V", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Most", "@", "#"}], "-", 
              RowBox[{"Rest", "@", "#"}]}], ")"}], "&"}], "@", 
           RowBox[{"P", "[", 
            RowBox[{"[", "face", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "\:041f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:0435", " ",
            "\:043d\:043e\:0432\:043e\:0433\:043e", " ", 
           "\:0431\:0430\:0437\:0438\:0441\:0430"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "V"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Rest", "@", "V"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"MatrixRank", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"First", "@", "V"}], ",", "#"}], "}"}], "]"}], 
                 ">", "1"}], "&"}], ",", "1"}], "]"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "\:041e\:0440\:0442\:043e\:0433\:043e\:043d\:0430\:043b\:0438\:0437\
\:0430\:0446\:0438\:044f", " ", "\:0413\:0440\:0430\:043c\:0430", " ", 
           "\:0438", " ", 
           "\:043d\:043e\:0440\:043c\:0430\:043b\:0438\:0437\:0430\:0446\:0438\
\:044f"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{"e1", ",", 
            RowBox[{"e2", "-", 
             RowBox[{
              RowBox[{
               RowBox[{"e1", ".", "e2"}], "/", 
               RowBox[{"e1", ".", "e1"}]}], "*", "e1"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"e1", "/", 
             RowBox[{"Norm", "@", "e1"}]}], ",", 
            RowBox[{"e2", "/", 
             RowBox[{"Norm", "@", "e2"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"e3", "=", 
          RowBox[{"Cross", "[", 
           RowBox[{"e1", ",", "e2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "\:0412\:043e\:0437\:0432\:0440", ".", " ", 
            "\:0437\:043d\:0430\:0447", ".", " ", 
            RowBox[{
            "-", " ", 
             "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:044b"}]}\
], " ", "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
           "\:0433\:0440\:0430\:043d\:0438", " ", "\:0432", " ", 
           "\:043d\:043e\:0432\:043e\:043c", " ", 
           "\:0431\:0430\:0437\:0438\:0441\:0435"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"#", ".", 
              RowBox[{"Inverse", "[", 
               RowBox[{"{", 
                RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}], "]"}]}], ",", 
             "2"}], "]"}], "&"}], "/@", 
          RowBox[{"P", "[", 
           RowBox[{"[", "face", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PolyhedronShow", "[", 
       RowBox[{"vertcoord_List", ",", "faces_List", ",", 
        RowBox[{"othergraphics_:", 
         RowBox[{"{", "}"}]}]}], "]"}]}], ":=", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"V", "=", "vertcoord"}], ",", " ", 
           RowBox[{"texttipdelta", " ", "=", 
            RowBox[{"{", 
             RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "}"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", " ", 
             "Black", ",", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Tooltip", "/@", 
              RowBox[{"Point", "/@", "V"}]}], ",", "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Line", "@", 
                 RowBox[{"V", "[", 
                  RowBox[{"[", 
                   RowBox[{"faces", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "@", "faces"}]}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{"V", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "texttipdelta"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "@", "V"}]}], "}"}]}], "]"}]}], ",", 
             RowBox[{"Sequence", "@@", "othergraphics"}]}], "}"}], ",", " ", 
           "\[IndentingNewLine]", "\t\t  ", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"RayCasting3DConvPolyhedron", "[", 
        RowBox[{"p0_List", ",", "dir_List", ",", "P_"}], "]"}]}], ":=", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "u1", ",", "u2", ",", "u3", ",", "u4", ",", "A1", ",", "B1", ",", 
            "C1", ",", "D1", ",", "A2", ",", "B2", ",", "C2", ",", "D2", ",", 
            "A3", ",", "B3", ",", "C3", ",", "D3", ",", "d1", ",", "d2", ",", 
            "d3", ",", "\[IndentingNewLine]", "\t\t", "temp1", ",", "temp2", 
            ",", "temp3", ",", "PP", ",", "V0", ",", "V1", ",", "V2", ",", 
            "V1i", ",", "V2i", ",", "V01i", ",", "V02i", ",", "V0min", ",", 
            "V0max", ",", "\[IndentingNewLine]", "\t\t", "Vbl", ",", "Vbr", 
            ",", "Vtl", ",", "Vtr"}], "}"}], ",", " ", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "\:0441\:043d\:0430\:0447\:0430\:043b\:0430", " ", 
             "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\:0432\
\:0430\:0435\:043c", " ", "\:0432\:043c\:0435\:0441\:0442\:043e", " ", 
             "\:043b\:0443\:0447\:0430", " ", 
             RowBox[{
             "\:0441\:043e\:043e\:0442\:0432", ".", " ", 
              "\:0435\:043c\:0443"}], " ", 
             "\:043f\:0440\:044f\:043c\:0443\:044e"}], ",", " ", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
            "\:0437\:0430\:0434\:0430\:043d\:043d\:0443\:044e", " ", 
             "\:043a\:0430\:043a", " ", 
             "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:0435", " ", "\:0434\:0432\:0443\:0445", " ", 
             "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}]}\
], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MatrixRank", "[", 
               RowBox[{"{", 
                RowBox[{"dir", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], 
              ">", "1"}], ",", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"u1", " ", "=", " ", "p0"}], ";", " ", 
              RowBox[{"u2", "=", 
               RowBox[{"p0", "+", "dir"}]}], ";", " ", 
              RowBox[{"u3", "=", 
               RowBox[{"p0", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"u4", " ", "=", " ", 
               RowBox[{"p0", "+", 
                RowBox[{"Cross", "[", 
                 RowBox[{
                  RowBox[{"u2", "-", "u1"}], ",", 
                  RowBox[{"u3", "-", "u2"}]}], "]"}]}]}], ";"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"u1", "=", "p0"}], ";", "  ", 
              RowBox[{"u2", "=", 
               RowBox[{"p0", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", " ", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"u3", "=", 
               RowBox[{"p0", "+", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ";", " ", 
              RowBox[{"u4", " ", "=", " ", 
               RowBox[{"p0", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "\:043a\:043e\:044d\:0444\:0444\:0438\:0446\:0438\:0435\:043d\
\:0442\:044b", " ", "\:0432", " ", 
                "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f\:0445\
", " ", "\:044d\:0442\:0438\:0445", " ", 
                "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439\
", " ", "A1x"}], " ", "+", " ", "B1y", " ", "+", " ", "C1z", " ", "+", " ", 
               "D"}], " ", "=", " ", "0"}], ",", " ", 
             RowBox[{
              RowBox[{
              "A2x", " ", "+", " ", "B2y", " ", "+", " ", "C2z", " ", "+", 
               " ", "D"}], " ", "=", " ", "0"}]}], "  ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A1", ",", "A2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "#1", ",", "#2"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u4"}], "}"}]}], "}"}]}]}], ";",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "1", ",", "#2"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u4"}], "}"}]}], "}"}]}]}], ";",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"C1", ",", "C2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#2", ",", "1"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u4"}], "}"}]}], "}"}]}]}], ";",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"D1", ",", "D2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Det", "@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"u1", ",", "u2", ",", "u4"}], "}"}]}], "}"}]}]}], ";",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:043c", " ", 
             "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:044b\:0435", " ", 
             "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f", 
             " ", "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
             "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
             "\:0434\:043e", " ", 
             "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438", " ", 
             "1"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"temp1", ",", "temp2"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"#", ".", "#"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"A1", ",", "B1", ",", "C1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"A2", ",", "B2", ",", "C2"}], "}"}]}], "}"}]}]}], ";",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{"d1", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A1", ",", "B1", ",", "C1"}], "}"}], ".", "#"}], 
                  "+", "D1"}], ")"}], "/", "temp1"}], ")"}], "&"}], "/@", 
             RowBox[{"P", "[", "\"\<coord\>\"", "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0440\:0430\:0437\:0431\:0438\:0432\:0430\:0435\:043c", " ", 
              "\:0442\:043e\:0447\:043a\:0438", " ", 
              "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
              "\:043d\:0430", " ", "\:0434\:0432\:0435", " ", 
              "\:0433\:0440\:0443\:043f\:043f\:044b", " ", "V1", " ", 
              "\:0438", " ", "V2"}], ",", " ", 
             RowBox[{
             "\:043b\:0435\:0436\:0430\:0449\:0438\:0435", " ", 
              "\:043f\:043e", " ", "\:0440\:0430\:0437\:043d\:044b\:0435", 
              " ", "\:0441\:0442\:043e\:0440\:043e\:043d\:044b", " ", 
              "\:043e\:0442", " ", 
              "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438", " ", 
              "1"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V1i", "=", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Position", "[", 
              RowBox[{"d1", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{"x", "\[GreaterEqual]", " ", "0"}]}]}], "]"}]}]}], 
           ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V2i", "=", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Position", "[", 
              RowBox[{"d1", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{"x", "<", " ", "0"}]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", "\:0432", " ", 
              "\:043e\:0434\:043d\:043e\:0439", " ", "\:0438\:0437", " ", 
              "\:043f\:043e\:043b\:0443\:043f\:043b\:043e\:0441\:043a\:043e\
\:0441\:0442\:0435\:0439", " ", 
              "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438", " ", 
              "1", " ", "\:043d\:0438", " ", "\:043e\:0434\:043d\:043e\:0439",
               " ", "\:0432\:0435\:0440\:0448\:0438\:043d\:044b"}], " ", "-", 
             " ", 
             RowBox[{
             "\:043b\:0443\:0447", " ", 
              "\:0437\:0430\:0432\:0435\:0434\:043e\:043c\:043e", " ", 
              "\:043d\:0435", " ", 
              "\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:0435\:0442", 
              " ", "\:043f\:043e\:043b\:0438\:044d\:0434\:0440"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Or", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "V1i"}], " ", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Length", "@", "V2i"}], "\[Equal]", "0"}]}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<+\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0441\:043e\:0435\:0434\:0438\:043d\:044f\:0435\:043c", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", 
              "\:0438\:0437", " ", "\:0440\:0430\:0437\:043d\:044b\:0445", 
              " ", "\:043f\:043e\:043b\:0443\:043f\:043b\:043e\:0441\:043a\
\:043e\:0441\:0442\:0435\:0439", " ", "\:0434\:0440\:0443\:0433", " ", 
              "\:0441", " ", "\:0434\:0440\:0443\:0433\:043e\:043c"}], ",", 
             " ", 
             RowBox[{
             "\:0441\:0447\:0438\:0442\:0430\:0435\:043c", " ", 
              "\:0442\:043e\:0447\:043a\:0438", " ", 
              RowBox[{
              "\:043f\:0435\:0440\:0435\:0441\:0435\:0447", ".", " ", 
               "\:0441"}], " ", 
              "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c\:044e", 
              " ", "1"}]}], "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V0", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"\"\<coord\>\"", ",", "i"}], "]"}], "*", 
                    RowBox[{"d1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"\"\<coord\>\"", ",", "j"}], "]"}], "*", 
                    RowBox[{"d1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                   RowBox[{"d1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "V1i"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "V2i"}], "}"}]}], "]"}], ",", "1"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:043c", " ", 
              "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:044b\:0435", " ", 
              "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f", 
              " ", "\:0442\:043e\:0447\:0435\:043a", " ", "V0", " ", 
              "\:0434\:043e", " ", 
              "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438", " ", 
              "2"}], ",", " ", 
             RowBox[{
             "\:0440\:0430\:0437\:0434\:0435\:043b\:044f\:0435\:043c", " ", 
              "\:0438\:0445", " ", "\:043d\:0430", " ", 
              "\:043f\:043e\:043b\:0443\:043f\:043b\:043e\:0441\:043a\:043e\
\:0441\:0442\:0438"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"d2", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A2", ",", "B2", ",", "C2"}], "}"}], ".", "#"}], 
                  "+", "D2"}], ")"}], "/", "temp2"}], ")"}], "&"}], "/@", 
             "V0"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V01i", "=", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Position", "[", 
              RowBox[{"d2", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{"x", "\[GreaterEqual]", " ", "0"}]}]}], "]"}]}]}], 
           ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V02i", "=", 
            RowBox[{"Flatten", "@", 
             RowBox[{"Position", "[", 
              RowBox[{"d2", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{"x", "<", " ", "0"}]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Or", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "V01i"}], " ", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Length", "@", "V02i"}], "\[Equal]", "0"}]}], "]"}], 
             ",", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<++\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "\:0432\:0441\:043f\:043e\:043c\:043e\:0433\:0430\:0442\:0435\
\:043b\:044c\:043d\:0430\:044f", " ", 
              "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c", " ", 
              "3", " ", "\:0441\:0442\:0440\:043e\:0438\:0442\:0441\:044f", 
              " ", "\:043f\:043e", " ", "\:0434\:0432\:0443\:043c", " ", 
              "\:0442\:043e\:0447\:043a\:0430\:043c", " ", "\:0441", " ", 
              "\:043c\:0430\:043a\:0441", " ", "\:0438", " ", 
              "\:043c\:0438\:043d", " ", 
              "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:0438\:044f\
\:043c\:0438", " ", "\:0434\:043e", " ", 
              "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438", " ", 
              "2", " ", "\[IndentingNewLine]", "\t\t", "\:0438", " ", 
              "\:0435\:0449\:0435", " ", "\:043e\:0434\:043d\:043e\:0439"}], 
             ",", " ", 
             RowBox[{
             "\:043d\:0435", " ", 
              "\:043b\:0435\:0436\:0430\:0449\:0435\:0439", " ", 
              "\:043d\:0430", " ", "\:043f\:0440\:044f\:043c\:043e\:0439"}], 
             ",", " ", 
             RowBox[{
             "\:043f\:0440\:043e\:0445\:043e\:0434\:044f\:0449\:0435\:0439", 
              " ", "\:0447\:0435\:0440\:0435\:0437", " ", "\:0442\:0435"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V0min", "=", 
            RowBox[{"V0", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"d2", ",", 
                 RowBox[{"Min", "[", "d2", "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
           " ", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"V0max", "=", 
            RowBox[{"V0", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"d2", ",", 
                 RowBox[{"Max", "[", "d2", "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"A3", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "#1", ",", "#2"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "&"}], "@", 
             RowBox[{"{", 
              RowBox[{"V0min", ",", "V0max", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"B3", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "1", ",", "#2"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "&"}], "@", 
             RowBox[{"{", 
              RowBox[{"V0min", ",", "V0max", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"C3", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#2", ",", "1"}], "}"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}], "&"}], "@", 
             RowBox[{"{", 
              RowBox[{"V0min", ",", "V0max", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"D3", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Det", "@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}]}], "&"}], "@", 
             RowBox[{"{", 
              RowBox[{"V0min", ",", "V0max", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"temp3", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"#", ".", "#"}], "]"}], "]"}], "&"}], "@", 
             RowBox[{"{", 
              RowBox[{"A3", ",", "B3", ",", "C3"}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"d3", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"A3", ",", "B3", ",", "C3"}], "}"}], ".", "#"}], 
                  "+", "D3"}], ")"}], "/", "temp3"}], ")"}], "&"}], "/@", 
             "V0"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Vtl", ",", "Vtr"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"V0", "[", 
               RowBox[{"[", 
                RowBox[{"V01i", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"d3", "[", 
                    RowBox[{"[", "V01i", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                "]"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"d3", "[", 
                 RowBox[{"[", "V01i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"d3", "[", 
                 RowBox[{"[", "V01i", "]"}], "]"}], "]"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Vbl", ",", "Vbr"}], "}"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"V0", "[", 
               RowBox[{"[", 
                RowBox[{"V02i", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"d3", "[", 
                    RowBox[{"[", "V02i", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                "]"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"d3", "[", 
                 RowBox[{"[", "V02i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{"d3", "[", 
                 RowBox[{"[", "V02i", "]"}], "]"}], "]"}]}], "}"}]}]}], ";", 
           " ", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"{", 
            RowBox[{
            "V0", ",", "V01i", ",", "V02i", ",", "d2", ",", "V0min", ",", 
             "V0max", ",", "d3", ",", "Vtl", ",", "Vtr", ",", "Vbl", ",", 
             "Vbr"}], "}"}]}]}], "\[IndentingNewLine]", "\t", "]"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ProjectileSphereCollide3DConvPolyhedron", "[", 
         RowBox[{"p0prev_List", ",", "p0cur_List", ",", 
          RowBox[{"r_", "?", "Positive"}], ",", "P_", ",", 
          RowBox[{"chopaccuracy_:", 
           RowBox[{"10", "^", 
            RowBox[{"-", "6"}]}]}]}], "]"}]}], ":=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{
               RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"P", "[", "\"\<faces\>\"", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
             ",", "d", ",", "mask", ",", "res", ",", "dir", ",", "M", ",", 
             "b1", ",", "b2", ",", "ind1", ",", "ind2", ",", "p1", ",", "p2", 
             ",", "p3", ",", "pnew", ",", "p0prev1", ",", "x0", ",", "x1", 
             ",", "y0", ",", "y1", ",", "\[IndentingNewLine]", "Mx", ",", 
             "IMx", ",", "My", ",", "IMy", ",", "\[Alpha]x", ",", "\[Alpha]y",
              ",", "dir1", ",", "v0", ",", "vv", ",", "vvshifted", ",", 
             "mask1", ",", "mask2", ",", "mask3", ",", "mask4", ",", "mask5", 
             ",", "checkit1", ",", "checkit2", ",", "T", ",", "shift"}], 
            "}"}], ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:043c", " ", 
             "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\
\:0430\:043d\:043d\:044b\:0435", " ", 
             "\:0440\:0430\:0441\:0441\:0442\:043e\:044f\:043d\:043d\:0438\
\:044f", " ", "\:043e\:0442", " ", "\:0446\:0435\:043d\:0442\:0440\:0430", 
             " ", "\:0441\:0444\:0435\:0440\:044b", " ", "\:0434\:043e", " ", 
             "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}],
             " ", "*)"}], "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{"d", "=", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", ".", "p0cur"}], "&"}], ",", 
                RowBox[{"P", "[", "\"\<norm\>\"", "]"}]}], "]"}], "-", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Dot", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"P", "[", "\"\<norm\>\"", "]"}], ",", "v"}], 
                 "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"dir", "=", 
             RowBox[{"p0cur", "-", "p0prev"}]}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "\:043f\:043e\:0438\:0441\:043a", " ", 
               "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}\
], ",", " ", 
              RowBox[{
               RowBox[{
               "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", 
                "\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:044e\:0442\
", " ", "\:043e\:0442\:0440\:0435\:0437\:043e\:043a", " ", "p0prev"}], "-", 
               "p0cur"}], ",", " ", 
              RowBox[{
              "\:0430", " ", "\:0442\:0430\:043a\:0436\:0435", " ", 
               "\:0441\:0430\:043c\:0438\:0445", " ", 
               "\:0442\:043e\:0447\:0435\:043a", " ", "\[IndentingNewLine]", 
               "\t", "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\
\:0438\:044f"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"M", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dir", "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#1", "-", "p0prev"}], ")"}], ".", "#2"}], ")"}], 
                  "/", 
                  RowBox[{"(", 
                   RowBox[{"dir", ".", "#2"}], ")"}]}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"v", ",", 
                 RowBox[{"P", "[", "\"\<norm\>\"", "]"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"b1", "=", 
             RowBox[{"Positive", "[", 
              RowBox[{"M", ".", "dir"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"b2", "=", 
             RowBox[{"Positive", "[", 
              RowBox[{
               RowBox[{"dir", ".", "dir"}], "-", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Dot", ",", 
                 RowBox[{"{", 
                  RowBox[{"M", ",", "M"}], "}"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "\:043d\:043e\:043c\:0435\:0440\:0430", " ", 
               "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0435\:0439"}\
], ",", " ", 
              RowBox[{
               RowBox[{
               "\:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:044e\:0449\
\:0438\:0445", " ", "p0prev"}], "-", 
               RowBox[{
               "p0cur", " ", "\:0438\:043b\:0438", " ", "\:0434\:043b\:044f", 
                " ", "\:043a\:043e\:0442\:043e\:0440\:044b\:0445", " ", 
                RowBox[{
                "\:043e\:0440\:0438\:0435\:043d\:0442", ".", " ", 
                 "\:0440\:0430\:0441\:0441\:0442", ".", " ", "\:0434\:043e"}],
                 " ", "p0cur", " ", 
                "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\:044c\
\:043d\:043e"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"ind1", "=", 
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"MapThread", "[", 
                    RowBox[{"And", ",", 
                    RowBox[{"{", 
                    RowBox[{"b1", ",", "b2"}], "}"}]}], "]"}], ",", "True"}], 
                  "]"}], ",", 
                 RowBox[{"Position", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"_", "?", "Positive"}]}], "]"}]}], "]"}]}]}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "\:0442\:043e\:0447\:043a\:0438", " ", 
              "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", 
              " ", "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", 
              "\:0441\:0444\:0435\:0440\:044b", " ", "\:0438", " ", 
              "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\:0442\:0438\:043f", " ", "1"}], ":", " ", 
                RowBox[{
                "\:0441\:0444\:0435\:0440\:0430", "-", 
                 "\:0433\:0440\:0430\:043d\:044c"}]}], ")"}]}], "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"p1", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"p0prev", "+", 
                 RowBox[{"dir", "*", 
                  FractionBox[
                   RowBox[{"r", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#1", "-", "p0prev"}], ")"}], ".", "#2"}]}], 
                   RowBox[{"dir", ".", "#2"}]]}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v", "[", 
                  RowBox[{"[", "ind1", "]"}], "]"}], ",", 
                 RowBox[{"P", "[", 
                  RowBox[{"\"\<norm\>\"", ",", "ind1"}], "]"}]}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "\:043e\:0442\:0431\:0440\:043e\:0441\:0438\:043c", " ", 
               "\:0442\:043e\:0447\:043a\:0438"}], ",", " ", 
              RowBox[{
               RowBox[{
               "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", 
                "\:043d\:0435", " ", 
                "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0442\:0441\:044f\
", " ", "\:0432", " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0435", " ", 
                "p0prev"}], "-", "p0cur"}], ",", " ", 
              RowBox[{
              "\:0435\:0441\:043b\:0438", " ", 
               "\:0442\:0430\:043a\:0438\:0435", " ", 
               "\:0435\:0441\:0442\:044c"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "p1"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{"mask1", "=", 
                RowBox[{"Boole", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"And", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NonNegative", "[", 
                    RowBox[{
                    RowBox[{"p1", ".", "dir"}], "-", 
                    RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
                    RowBox[{"NonNegative", "[", 
                    RowBox[{
                    RowBox[{"dir", ".", "dir"}], "-", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}]}], "&"}], ",", "p1"}],
                     "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"p1", "=", 
                RowBox[{"Pick", "[", 
                 RowBox[{"p1", ",", "mask1", ",", "1"}], "]"}]}], ";", 
               RowBox[{"ind2", "=", 
                RowBox[{"Pick", "[", 
                 RowBox[{"ind1", ",", "mask1", ",", "1"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"checkit1", "=", 
             RowBox[{"Chop", "[", 
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#2", "-", 
                   RowBox[{"r", "*", 
                    RowBox[{"P", "[", 
                    RowBox[{"\"\<norm\>\"", ",", "#1"}], "]"}]}]}], "&"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"ind2", ",", "p1"}], "}"}]}], "]"}], ",", 
               "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "\:0432\:044b\:0431\:043e\:0440", " ", "\:0442\:0435\:0445", 
               " ", "\:0442\:043e\:0447\:0435\:043a", " ", "p1"}], ",", " ", 
              RowBox[{
              "\:043f\:0435\:0440\:043f\:0435\:043d\:0434\:0438\:043a\:0443\
\:043b\:044f\:0440", " ", 
               "\:043e\:043f\:0443\:0449\:0435\:043d\:043d\:044b\:0439", " ", 
               "\:043d\:0430", " ", 
               RowBox[{
               "\:0441\:043e\:043e\:0442\:0432", ".", " ", 
                "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c"}], 
               " ", "\:043e\:0431\:0440\:0430\:0437\:0443\:0435\:0442", " ", 
               "\:0442\:043e\:0447\:043a\:0443", " ", 
               "\:043b\:0435\:0436\:0430\:0449\:0443\:044e", " ", 
               "\:043d\:0430", " ", "\:0433\:0440\:0430\:043d\:0438", " ", 
               "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"mask2", "=", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"Boole", "@", 
                RowBox[{"Positive", "[", 
                 RowBox[{"Chop", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", "\"\<norm\>\"", "]"}], ".", "#"}], "-", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Dot", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"P", "[", "\"\<norm\>\"", "]"}], ",", "v"}], 
                    "}"}]}], "]"}]}], ")"}], "&"}], "/@", "checkit1"}], ",", 
                   "chopaccuracy"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
             "\t", 
            RowBox[{"p1", "=", 
             RowBox[{"Pick", "[", 
              RowBox[{"p1", ",", "mask2", ",", "0"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "\:043f\:043e\:0438\:0441\:043a", " ", 
              "\:0442\:043e\:0447\:0435\:043a", " ", 
              "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", 
              " ", "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", 
              "\:0441", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d\:0430\:043c\:0438"}], " ",
              "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"checkit2", "=", " ", 
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"P", "[", 
                RowBox[{"\"\<faces\>\"", ",", "ind2"}], "]"}]}]}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"T", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"dir", ".", "dir"}]], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", "dir"}], "-", 
                    " ", 
                    RowBox[{"N", "@", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", "dir"}], ")"}], 
                    "2"], "-", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dir", ".", "dir"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}]}], "-", 
                    SuperscriptBox["r", "2"]}], ")"}]}]}]]}]}], ")"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"dir", ".", "dir"}]], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", "dir"}], "+", 
                    " ", 
                    RowBox[{"N", "@", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", "dir"}], ")"}], 
                    "2"], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dir", ".", "dir"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "#"}], ")"}]}], "-", 
                    SuperscriptBox["r", "2"]}], ")"}]}]}]]}]}], ")"}]}]}], 
                "}"}], "&"}], "/@", 
              RowBox[{"P", "[", 
               RowBox[{"\"\<coord\>\"", ",", "checkit2"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"mask3", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Boole", "@", 
                RowBox[{"Internal`RealValuedNumericQ", "[", 
                 RowBox[{"First", "@", "#"}], "]"}]}], "&"}], "/@", "T"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"T", "=", 
             RowBox[{"Pick", "[", 
              RowBox[{"T", ",", "mask3", ",", "1"}], "]"}]}], ";", " ", 
            RowBox[{"T", " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{"Min", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "\:0442\:043e\:0447\:043a\:0438", " ", 
              "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", 
              " ", "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", 
              "\:0441\:0444\:0435\:0440\:044b", " ", "\:0438", " ", 
              "\:043f\:043e\:043b\:0438\:044d\:0434\:0440\:0430", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\:0442\:0438\:043f", " ", "2"}], ":", " ", 
                RowBox[{
                "\:0441\:0444\:0435\:0440\:0430", "-", 
                 "\:0432\:0435\:0440\:0448\:0438\:043d\:0430"}]}], ")"}]}], 
             "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"p2", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"p0prev", "+", 
                RowBox[{"#", "*", "dir"}]}], "&"}], "/@", "T"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "\:043e\:0442\:0431\:0440\:043e\:0441\:0438\:043c", " ", 
               "\:0442\:043e\:0447\:043a\:0438"}], ",", " ", 
              RowBox[{
               RowBox[{
               "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", 
                "\:043d\:0435", " ", 
                "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0442\:0441\:044f\
", " ", "\:0432", " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0435", " ", 
                "p0prev"}], "-", "p0cur"}], ",", " ", 
              RowBox[{
              "\:0435\:0441\:043b\:0438", " ", 
               "\:0442\:0430\:043a\:0438\:0435", " ", 
               "\:0435\:0441\:0442\:044c"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "p2"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{"mask4", "=", 
                RowBox[{"Boole", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"And", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NonNegative", "[", 
                    RowBox[{
                    RowBox[{"p2", ".", "dir"}], "-", 
                    RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
                    RowBox[{"NonNegative", "[", 
                    RowBox[{
                    RowBox[{"dir", ".", "dir"}], "-", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}]}], "&"}], ",", "p2"}],
                     "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"p2", "=", 
                RowBox[{"Pick", "[", 
                 RowBox[{"p2", ",", "mask4", ",", "1"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "\:043f\:043e\:0438\:0441\:043a", " ", 
              "\:0442\:043e\:0447\:0435\:043a", " ", "p3", " ", 
              "\:0432\:043e\:0437\:043c\:043e\:0436\:043d\:043e\:0433\:043e", 
              " ", "\:043a\:0430\:0441\:0430\:043d\:0438\:044f", " ", 
              "\:0441", " ", 
              RowBox[{
              "\:0440\:0435\:0431\:0440\:0430\:043c\:0438", ".", " ", 
               "\:0424\:043e\:0440\:043c\:0438\:0440\:043e\:0432\:0430\:043d\
\:0438\:0435"}], " ", "\:0440\:0435\:0431\:0435\:0440", " ", "\:0438", " ", 
              "\:043f\:0435\:0440\:0435\:043d\:043e\:0441", " ", "\:043a", 
              " ", "\:043d\:0430\:0447\:0430\:043b\:0443", " ", 
              "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442"}], " ",
              "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"vv", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{"List", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Most", "@", 
                    RowBox[{"P", "[", 
                    RowBox[{"\"\<coord\>\"", ",", "#"}], "]"}]}], ",", 
                   RowBox[{"Rest", "@", 
                    RowBox[{"P", "[", 
                    RowBox[{"\"\<coord\>\"", ",", "#"}], "]"}]}]}], "}"}]}], 
                "]"}], "&"}], "/@", 
              RowBox[{"P", "[", 
               RowBox[{"\"\<faces\>\"", ",", "ind1"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"shift", ",", "vvshifted"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{"First", ",", "#"}], "]"}], "&"}], "/@", "vv"}], 
                 ",", "1"}], "]"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{"Last", ",", "#"}], "]"}], "&"}], "/@", "vv"}], 
                 ",", "1"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"vvshifted", "=", 
             RowBox[{"vvshifted", "-", "shift"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"p3", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "\:043a\:0430\:0436\:0434\:043e\:0435", " ", 
                "\:0440\:0435\:0431\:0440\:043e", " ", 
                "\:043f\:043e\:0432\:043e\:0440\:0430\:0447\:0438\:0432\:0430\
\:0435\:043c", " ", "\:0442\:0430\:043a"}], ",", " ", 
               RowBox[{
               "\:0447\:0442\:043e\:0431\:044b", " ", "\:043e\:043d\:043e", 
                " ", "\:043b\:0435\:0436\:0430\:043b\:043e", " ", 
                "\:043d\:0430", " ", "\:043e\:0441\:0438", " ", "z"}], ",", 
               " ", 
               RowBox[{
                RowBox[{
                "\:043d\:0430", " ", "\:0442\:0435", " ", "\:0436\:0435", " ",
                  "\:0443\:0433\:043b\:044b", " ", 
                 "\:043f\:043e\:0432\:043e\:0440\:0430\:0447\:0438\:0432\:0430\
\:0435\:043c", " ", "\:0438", "\[IndentingNewLine]", "\t\t", 
                 "\:0442\:043e\:0447\:043a\:0443", " ", "p0prev", " ", 
                 "\:0438", " ", 
                 RowBox[{
                 "\:043d\:0430\:043f\:0440\:0430\:0432\:043b", ".", " ", 
                  "\:0432\:0435\:043a\:0442\:043e\:0440"}], " ", "p0cur"}], 
                "-", "p0prev"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"p0prev1", "=", 
                RowBox[{"p0prev", "-", 
                 RowBox[{"shift", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vvshifted", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[NotEqual]", " ",
                   "0"}], ",", 
                 RowBox[{"\[Alpha]x", "=", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], "+", 
                    RowBox[{"ArcTan", "[", 
                    RowBox[{
                    RowBox[{"vvshifted", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "/", 
                    RowBox[{"vvshifted", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}]}],
                  ",", " ", 
                 RowBox[{"\[Alpha]x", "=", "0"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Mx", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Cos", "[", "\[Alpha]x", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Alpha]x", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Sin", "[", "\[Alpha]x", "]"}], ",", 
                    RowBox[{"Cos", "[", "\[Alpha]x", "]"}]}], "}"}]}], 
                 "}"}]}], ";", "\t", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"v0", "=", 
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"vvshifted", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ".", "Mx"}], ",", 
                  "chopaccuracy"}], "]"}]}], ";", " ", 
               RowBox[{"dir1", "=", " ", 
                RowBox[{"Chop", "[", 
                 RowBox[{"dir", ".", "Mx"}], "]"}]}], ";", " ", 
               RowBox[{"p0prev1", "=", 
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"p0prev1", ".", "Mx"}], ",", "chopaccuracy"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v0", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
                 ",", 
                 RowBox[{"\[Alpha]y", "=", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Pi", "/", "2"}], "-", 
                    RowBox[{"ArcTan", "[", 
                    RowBox[{
                    RowBox[{"v0", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/", 
                    RowBox[{"v0", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
                 " ", 
                 RowBox[{"\[Alpha]y", "=", "0"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"My", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Cos", "[", "\[Alpha]y", "]"}], ",", "0", ",", 
                    RowBox[{"Sin", "[", "\[Alpha]y", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "\[Alpha]y", "]"}]}], ",", "0", ",", 
                    RowBox[{"Cos", "[", "\[Alpha]y", "]"}]}], "}"}]}], 
                 "}"}]}], ";", "\t", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"v0", "=", 
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"v0", ".", "My"}], ",", "chopaccuracy"}], "]"}]}], 
               ";", 
               RowBox[{"dir1", "=", 
                RowBox[{"Chop", "[", 
                 RowBox[{"dir1", ".", "My"}], "]"}]}], ";", " ", 
               RowBox[{"p0prev1", "=", 
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"p0prev1", ".", "My"}], ",", "chopaccuracy"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\:0432\
\:0430\:0435\:043c", " ", "\:0440\:0435\:0431\:0440\:043e", " ", 
                  "\:043a\:0430\:043a", " ", 
                  "\:0431\:0435\:0441\:043a\:043e\:043d\:0435\:0447\:043d\
\:044b\:0439", " ", "\:0446\:0438\:043b\:0438\:043d\:0434\:0440", " ", 
                  "\:0440\:0430\:0434\:0438\:0443\:0441\:0430", " ", "r"}], 
                 ",", " ", 
                 RowBox[{
                  RowBox[{
                  "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
                   "\:0442\:043e\:0447\:043a\:0443", " ", "pnew", " ", 
                   "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\
\:0438\:044f", "\[IndentingNewLine]", "\t\t", 
                   "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\
\:0432\:0430\:043d\:043d\:043e\:0433\:043e", " ", 
                   "\:043f\:043e\:0432\:043e\:0440\:043e\:0442\:0430\:043c\
\:0438", " ", "\:0438", " ", 
                   "\:043f\:0435\:0440\:0435\:043d\:043e\:0441\:0430\:043c\
\:0438", " ", "\:043b\:0443\:0447\:0430", " ", "\:0438\:0437", " ", 
                   "p0prev"}], " ", "+", " ", 
                  RowBox[{"t", "*", "dir", " ", "\:0438", " ", 
                   RowBox[{
                   "\:0446\:0438\:043b\:0438\:043d\:0434\:0440\:0430", ".", 
                    " ", "\:0415\:0441\:043b\:0438"}], " ", 
                   "\:043e\:043d\:0438", " ", "\:043d\:0435", 
                   "\[IndentingNewLine]", "\t\t", 
                   "\:043a\:0430\:044e\:0442\:0441\:044f"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{
                  "\:0442\:043e", " ", 
                   "\:043f\:0430\:0440\:0430\:043c\:0435\:0442\:0440", " ", 
                   "t"}], " ", "-", " ", 
                  RowBox[{
                  "\:043a\:043e\:043c\:043f\:043b\:0435\:043a\:0441\:043d\
\:044b\:0439", " ", "\:0438", " ", "\:043d\:0435", " ", 
                   RowBox[{
                   "\:0440\:0430\:0441\:0441\:043c\:0430\:0442\:0440\:0438\
\:0432\:0430\:0435\:0442\:0441\:044f", ".", " ", "\:0415\:0441\:043b\:0438"}],
                    " ", "\:0442\:043e\:0447\:043a\:0430", " ", 
                   "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\
\:0438\:044f", " ", "\:043e\:0434\:043d\:0430"}], " ", "-", " ", 
                  RowBox[{
                  "\:0442\:043e", "\[IndentingNewLine]", "\t\t", 
                   "\:043e\:0431\:0430", " ", 
                   "\:043a\:043e\:0440\:043d\:044f", " ", "t1"}]}], ",", 
                 RowBox[{
                 "t2", " ", 
                  "\:0441\:043e\:0432\:043f\:0430\:0434\:0430\:044e\:0442"}], 
                 ",", " ", 
                 RowBox[{
                 "\:0435\:0441\:043b\:0438", " ", 
                  "\:0442\:043e\:0447\:043a\:0438", " ", 
                  "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\
\:0438\:044f", " ", "\:0434\:0432\:0435"}], ",", " ", 
                 RowBox[{
                 "\:0442\:043e", " ", 
                  "\:0432\:044b\:0431\:0438\:0440\:0430\:0435\:043c", " ", 
                  
                  "\:043d\:0430\:0438\:043c\:0435\:043d\:044c\:0448\:0438\
\:0439", " ", 
                  "\:043f\:043e\:043b\:043e\:0436\:0438\:0442\:0435\:043b\
\:044c\:043d\:044b\:0439", "\[IndentingNewLine]", "\t\t ", 
                  RowBox[{
                  "\:043a\:043e\:0440\:0435\:043d\:044c", ".", " ", 
                   "\:0422\:0430\:043a\:0436\:0435"}], " ", 
                  "\:0443\:0431\:0438\:0440\:0430\:0435\:043c", " ", 
                  "\:0438\:0437", " ", 
                  "\:0440\:0430\:0441\:0441\:043c\:043e\:0442\:0440\:0435\
\:043d\:0438\:044f", " ", "\:0442\:0435", " ", 
                  "\:0442\:043e\:0447\:043a\:0438", " ", 
                  "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\
\:0438\:044f"}], ",", " ", 
                 RowBox[{
                 "\:0447\:0442\:043e", " ", "\:043b\:0435\:0436\:0430\:0442", 
                  " ", "\:043d\:0430", " ", 
                  "\:043f\:0440\:043e\:0434\:043e\:043b\:0436\:0435\:043d\
\:0438\:0438", " ", "\:0446\:0438\:043b\:0438\:043d\:0434\:0440\:0430"}]}], 
                "   ", "*)"}], "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x0", ",", "y0"}], "}"}], "=", 
                RowBox[{"Most", "@", "p0prev1"}]}], ";", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", "y1"}], "}"}], "=", 
                RowBox[{"Most", "@", "dir1"}]}], ";", " ", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"T", "=", 
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"x0", " ", "x1"}], "+", 
                    RowBox[{"y0", " ", "y1"}], "+", 
                    RowBox[{"N", "@", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x1", " ", "y0"}], "-", 
                    RowBox[{"x0", " ", "y1"}]}], ")"}], "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x1", "2"], "+", 
                    SuperscriptBox["y1", "2"]}], ")"}]}]}]]}]}], 
                    RowBox[{
                    SuperscriptBox["x1", "2"], "+", 
                    SuperscriptBox["y1", "2"]}]]}], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "x0"}], " ", "x1"}], "-", 
                    RowBox[{"y0", " ", "y1"}], "+", 
                    RowBox[{"N", "@", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x1", " ", "y0"}], "-", 
                    RowBox[{"x0", " ", "y1"}]}], ")"}], "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["x1", "2"], "+", 
                    SuperscriptBox["y1", "2"]}], ")"}]}]}]]}]}], 
                    RowBox[{
                    SuperscriptBox["x1", "2"], "+", 
                    SuperscriptBox["y1", "2"]}]]}], "}"}], ",", 
                  "chopaccuracy"}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"And", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Internal`RealValuedNumericQ", "[", "#", "]"}], 
                    "&"}], "/@", "T"}], ")"}]}], ",", "\[IndentingNewLine]", 
                 "\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Min", "[", "T", "]"}], "\[GreaterEqual]", " ", 
                    "0"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"pnew", " ", "=", " ", 
                    RowBox[{"p0prev1", "+", 
                    RowBox[{
                    RowBox[{"Min", "[", "T", "]"}], "*", "dir1"}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Between", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "pnew"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Last", "@", "v0"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"IMx", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}], "}"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{"IMy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}], ",", "0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], ",", "0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"p3", ",", 
                    RowBox[{
                    RowBox[{"pnew", ".", "IMy", ".", "IMx"}], "+", 
                    RowBox[{"shift", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "\t\t\t\t\t", "]"}], ";"}], 
                    "\[IndentingNewLine]", "\t\t\t\t", ",", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Max", "[", "T", "]"}], "\[GreaterEqual]", " ", 
                    "0"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"pnew", " ", "=", " ", 
                    RowBox[{"p0prev1", "+", 
                    RowBox[{
                    RowBox[{"Max", "[", "T", "]"}], "*", "dir1"}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Between", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "pnew"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Last", "@", "v0"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"IMx", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}], ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]x"}], "]"}]}], "}"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{"IMy", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}], ",", "0", ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], ",", "0", ",", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"-", "\[Alpha]y"}], "]"}]}], "}"}]}], "}"}]}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"p3", ",", 
                    RowBox[{
                    RowBox[{"pnew", ".", "IMy", ".", "IMx"}], "+", 
                    RowBox[{"shift", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "\t\t\t\t\t", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "\t\t\t\t", "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}]}], "\t\t\t", 
                "\[IndentingNewLine]", "\t\t", "]"}], ";"}], 
              "\[IndentingNewLine]", "\t", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "@", "vvshifted"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "\:043e\:0442\:0431\:0440\:043e\:0441\:0438\:043c", " ", 
               "\:0442\:043e\:0447\:043a\:0438"}], ",", " ", 
              RowBox[{
               RowBox[{
               "\:043a\:043e\:0442\:043e\:0440\:044b\:0435", " ", 
                "\:043d\:0435", " ", 
                "\:0441\:043e\:0434\:0435\:0440\:0436\:0430\:0442\:0441\:044f\
", " ", "\:0432", " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0435", " ", 
                "p0prev"}], "-", "p0cur"}], ",", " ", 
              RowBox[{
              "\:0435\:0441\:043b\:0438", " ", 
               "\:0442\:0430\:043a\:0438\:0435", " ", 
               "\:0435\:0441\:0442\:044c"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "p3"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{"mask5", "=", 
                RowBox[{"Boole", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"And", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NonNegative", "[", 
                    RowBox[{
                    RowBox[{"p3", ".", "dir"}], "-", 
                    RowBox[{"p0prev", ".", "dir"}]}], "]"}], ",", 
                    RowBox[{"NonNegative", "[", 
                    RowBox[{
                    RowBox[{"dir", ".", "dir"}], "-", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p0prev"}], ")"}]}], "&"}], ",", "p3"}],
                     "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"p3", "=", 
                RowBox[{"Pick", "[", 
                 RowBox[{"p3", ",", "mask5", ",", "1"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"res", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"p1", ",", "p2", ",", "p3"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "res"}], "\[Equal]", "0"}], ",", 
              RowBox[{"res", "=", "p0cur"}], ",", 
              RowBox[{"res", "=", 
               RowBox[{"First", "@", 
                RowBox[{"Nearest", "[", 
                 RowBox[{"res", ",", "p0prev"}], "]"}]}]}]}], "]"}], ";", 
            "\t\t", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "res", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "tt"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{"dir", ".", "dir"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p", "-", "p0prev"}], ")"}], ".", "dir"}], "-", " ", 
               RowBox[{"N", "@", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "p"}], ")"}], ".", "dir"}], ")"}], 
                   "2"], "-", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dir", ".", "dir"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "p"}], ")"}]}], "-", 
                    SuperscriptBox["R", "2"]}], ")"}]}]}]]}]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"dir", ".", "dir"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p", "-", "p0prev"}], ")"}], ".", "dir"}], "+", " ", 
               RowBox[{"N", "@", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "p"}], ")"}], ".", "dir"}], ")"}], 
                   "2"], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dir", ".", "dir"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p0prev", "-", "p"}], ")"}]}], "-", 
                    SuperscriptBox["R", "2"]}], ")"}]}]}]]}]}], ")"}]}]}], 
           "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"NextVertexAndSubsimplex", "[", 
           RowBox[{"Y_", ",", 
            RowBox[{"chopaccuracy_:", 
             RowBox[{"10", "^", 
              RowBox[{"-", "6"}]}]}]}], "]"}]}], ":=", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "res", ",", "u", ",", "v", ",", "x0", ",", "a", ",", "b", ",", 
               "c", ",", "p", ",", "A1", ",", "B1", ",", "C1", ",", "s", ",", 
               "n", ",", "d", ",", "n1", ",", "n2", ",", "n3", ",", 
               "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "l"}], "}"}],
              ",", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "1"}], 
               ":", " ", 
               RowBox[{
               "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
                "\:0435\:0441\:0442\:044c", " ", 
                "\:043f\:0443\:0441\:0442\:043e\:0435", " ", 
                "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:043e"}]}], 
              " ", "*)"}], "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "Y"}], "\[Equal]", "0"}], ",", 
                RowBox[{"res", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "}"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "2"}], 
                ":", " ", 
                RowBox[{
                "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
                 "\:0435\:0441\:0442\:044c", " ", 
                 "\:0442\:043e\:0447\:043a\:0430"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "Y"}], "\[Equal]", "1"}], ",", 
                RowBox[{"res", "=", 
                 RowBox[{"{", 
                  RowBox[{"Y", ",", "Y"}], "}"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "3"}], 
                ":", " ", 
                RowBox[{
                "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
                 "\:0435\:0441\:0442\:044c", " ", 
                 "\:043e\:0442\:0440\:0435\:0437\:043e\:043a"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", "\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "Y"}], "\[Equal]", "2"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"(*", " ", 
                 RowBox[{"x0", " ", "=", " ", 
                  RowBox[{
                  "u", " ", "\:043c\:0438\:043d\:0443\:0441", " ", 
                   "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044f", " ", 
                   "\:0432\:0435\:043a\:0442\:043e\:0440\:0430", " ", "u", 
                   " ", "\:043d\:0430", " ", 
                   "\:0432\:0435\:043a\:0442\:043e\:0440", " ", "v"}]}], " ", 
                 "*)"}], "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{"u", "=", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
                 RowBox[{"v", "=", 
                  RowBox[{
                   RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"x0", "=", 
                  RowBox[{"u", "-", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"u", ".", "v"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"v", ".", "v"}], ")"}]}], "*", "v"}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "\:0432\:0435\:043a\:0442\:043e\:0440", " ", "\:0441", " ", 
                   "\:043c\:0435\:043d\:044c\:0448\:0438\:043c", " ", 
                   "\:043c\:043e\:0434\:0443\:043b\:0435\:043c", " ", 
                   "\:0438\:0437", " ", "Y", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "\:043d\:0443", " ", "\:0438\:043b\:0438", " ", 
                    "\:0442\:043e\:0447\:043a\:0430"}], ",", " ", 
                    RowBox[{
                    "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0430\:044f", 
                    " ", "\:043a", " ", "\:0442\:043e\:0447\:043a\:0435", " ",
                     "\:043e\:0442\:0441\:0447\:0435\:0442\:0430"}]}], ")"}], 
                   " ", "\[IndentingNewLine]", "\t\t", 
                   "\:0431\:0443\:0434\:0435\:0442", " ", 
                   "\:043e\:0434\:043d\:043e\:0432\:0440\:0435\:043c\:0435\
\:043d\:043d\:043e", " ", "\:0438", " ", 
                   "\:0431\:043b\:0438\:0436\:0430\:0439\:0448\:0435\:0439", 
                   " ", "\:0442\:043e\:0447\:043a\:043e\:0439", " ", "\:0438",
                    " ", 
                   RowBox[{
                   "\:043c\:0438\:043d", ".", " ", 
                    "\:043f\:043e\:0434\:0441\:0438\:043c\:043f\:043b\:0435\
\:043a\:0441\:043e\:043c"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"x0", "-", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "<", " ", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "Y"}], "}"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
                    RowBox[{"Min", "[", "Y", "]"}]}]}], ";"}]}], "]"}], ";"}],
                   "*)"}], "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"x0", "-", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "<", " ", 
                    "0"}], ",", 
                   RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "Y"}], "}"}]}], ";"}], ",", 
                   "\[IndentingNewLine]", "\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ".", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "<", 
                    RowBox[{
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ".", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]",
               "\t", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"\:0441\:043b\:0443\:0447\:0430\:0439", " ", "4"}], 
                ":", " ", 
                RowBox[{
                "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441", " ", 
                 "\:0435\:0441\:0442\:044c", " ", 
                 "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\:0438\
\:043a"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", "Y"}], "\[Equal]", "3"}], ",", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", "Y"}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "\:0441\:0442\:0440\:043e\:0438\:043c", " ", 
                    "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:044c"}]\
, ",", " ", 
                   RowBox[{
                   "\:0432", " ", 
                    "\:043a\:043e\:0442\:043e\:0440\:043e\:0439", " ", 
                    "\:043b\:0435\:0436\:0438\:0442", " ", 
                    "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\
\:0438\:043a", " ", "abc", " ", "\:0438", " ", 
                    "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
                    "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044e", " ", 
                    "\:043d\:0430", " ", "\:043d\:0435\:0435", " ", 
                    "\[IndentingNewLine]", "\t\t", 
                    "\:0442\:043e\:0447\:043a\:0438", " ", 
                    "\:043d\:0430\:0447\:0430\:043b\:0430", " ", 
                    "\:043e\:0442\:0441\:0447\:0435\:0442\:0430"}]}], " ", 
                  "*)"}], "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"A1", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Det", "@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "#1", ",", "#2"}], "}"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "&"}], "@", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"B1", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Det", "@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "1", ",", "#2"}], "}"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "&"}], "@", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"C1", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Det", "@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", "#2", ",", "1"}], "}"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "&"}], "@", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"n", "=", 
                  RowBox[{"{", 
                   RowBox[{"A1", ",", "B1", ",", "C1"}], "}"}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"n", "=", 
                  RowBox[{"n", "/", 
                   RowBox[{"Norm", "@", "n"}]}]}], ";", "\[IndentingNewLine]",
                  "\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "\:0434\:043b\:044f", " ", 
                    "\:043d\:0430\:0433\:043b\:044f\:0434\:043d\:043e\:0441\
\:0442\:0438"}], " ", "-", " ", 
                   RowBox[{
                   "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\
\:0435", " ", 
                    "\:043f\:0435\:0440\:043f\:0435\:043d\:0434\:0438\:043a\
\:0443\:043b\:044f\:0440\:0430"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                 "\t\t", 
                 RowBox[{"d", "=", 
                  RowBox[{
                   RowBox[{"n", ".", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "-", 
                   RowBox[{"n", ".", "a"}]}]}], ";", "\[IndentingNewLine]", 
                 "\t\t", 
                 RowBox[{"p", "=", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], "-", 
                   RowBox[{"d", "*", "n"}]}]}], ";", "\[IndentingNewLine]", 
                 "\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "\:0431\:0430\:0440\:0438\:0446\:0435\:043d\:0442\:0440\
\:0438\:0447\:0435\:0441\:043a\:0438\:0435", " ", 
                    "\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\
\:044b", " ", "\:0434\:043b\:044f", " ", 
                    "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\
\:0438\:044f"}], ",", " ", 
                   RowBox[{
                    RowBox[{
                    "\:043d\:0430\:0445\:043e\:0434", ".", " ", 
                    "\:043b\:0438"}], " ", 
                    "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044f", " ", 
                    "p", " ", "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
                    "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\
\:0438\:043a\:0430"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"s", "=", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], "*", 
                   RowBox[{"Norm", "@", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{"b", "-", "a"}], ",", 
                    RowBox[{"c", "-", "a"}]}], "]"}]}]}]}], ";", 
                 "\[IndentingNewLine]", "\t\t", 
                 RowBox[{"\[Alpha]", "=", 
                  RowBox[{
                   RowBox[{"Norm", "@", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{"b", "-", "p"}], ",", 
                    RowBox[{"c", "-", "p"}]}], "]"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "s"}], ")"}]}]}], ";", "\[IndentingNewLine]",
                  "\t\t", 
                 RowBox[{"\[Beta]", "=", 
                  RowBox[{
                   RowBox[{"Norm", "@", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{"c", "-", "p"}], ",", 
                    RowBox[{"a", "-", "p"}]}], "]"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "s"}], ")"}]}]}], ";", "\[IndentingNewLine]",
                  "\t\t", 
                 RowBox[{"\[Gamma]", "=", 
                  RowBox[{
                   RowBox[{"Norm", "@", 
                    RowBox[{"Cross", "[", 
                    RowBox[{
                    RowBox[{"a", "-", "p"}], ",", 
                    RowBox[{"b", "-", "p"}]}], "]"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "s"}], ")"}]}]}], ";", "\[IndentingNewLine]",
                  "\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Between", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
                    "}"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    "1", "-", "\[Alpha]", "-", "\[Beta]", "-", "\[Gamma]"}], 
                    ",", "chopaccuracy"}], "]"}], "\[Equal]", "0"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", "\t\t\t", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "\:0435\:0441\:043b\:0438", " ", 
                    "\:0432\:043d\:0443\:0442\:0440\:0438", " ", 
                    "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\
\:0438\:043a\:0430", " ", "\:0438", " ", "\:043d\:0435", " ", "\:043d\:0430", 
                    " ", "\:0433\:0440\:0430\:043d\:0438\:0446\:0435"}], ",", 
                    " ", 
                    RowBox[{"\:0442\:043e", " ", 
                    RowBox[{
                    "\:043c\:0438\:043d", ".", " ", 
                    "\:043f\:043e\:0434\:0441\:0438\:043c\:043f\:043b\:0435\
\:043a\:0441"}], " ", "\:0435\:0441\:0442\:044c", " ", 
                    "\:0432\:0435\:0441\:044c", " ", 
                    "\:0441\:0438\:043c\:043f\:043b\:0435\:043a\:0441"}]}], 
                    " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
                   RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "Y"}], "}"}], ",", "chopaccuracy"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "\:0435\:0441\:043b\:0438", " ", "\:043d\:0430", " ", 
                    "\:0433\:0440\:0430\:043d\:0438\:0446\:0435"}], ",", " ", 
                    "\:0442\:043e"}], " ", "*)"}], "\[IndentingNewLine]", 
                    "\t\t\t", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Alpha]", "\[Equal]", "0"}], "&&", 
                    RowBox[{"\[Beta]", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "c"}], "}"}], ",", "chopaccuracy"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "\[Equal]", "0"}], "&&", 
                    RowBox[{"\[Gamma]", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "b"}], "}"}], ",", "chopaccuracy"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\[Beta]", "\[Equal]", "0"}], "&&", 
                    RowBox[{"\[Gamma]", "\[Equal]", "0"}]}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "a"}], "}"}], ",", "chopaccuracy"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t\t\t", 
                    RowBox[{"\[Alpha]", "\[Equal]", "0"}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "c"}], "}"}]}], "}"}], ",", 
                    "chopaccuracy"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "\t\t\t\t\t", 
                    RowBox[{"\[Beta]", "\[Equal]", "0"}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
                    "chopaccuracy"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "\t\t\t\t\t", 
                    RowBox[{"\[Gamma]", "\[Equal]", "0"}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", 
                    "chopaccuracy"}], "]"}]}]}], "\[IndentingNewLine]", 
                    "\t\t\t\t", "]"}], ";"}], "\[IndentingNewLine]", "\t\t\t",
                    ",", "\[IndentingNewLine]", "\t\t\t", 
                   RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    "\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"b", "-", "a"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"c", "-", "b"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"a", "-", "c"}], "]"}]}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "\:0435\:0441\:043b\:0438", " ", 
                    "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:044f", " ", 
                    "\:043b\:0435\:0436\:0438\:0442", " ", "\:0432", " ", 
                    RowBox[{
                    "\:043e\:043f\:0440", ".", " ", 
                    "\:043e\:0431\:043b\:0430\:0441\:0442\:0438"}]}], ",", 
                    " ", 
                    RowBox[{
                    "\:043d\:0430\:0445\:043e\:0434\:0438\:043c", " ", 
                    "\:043f\:0440\:043e\:0435\:043a\:0446\:0438\:0438", " ", 
                    "\:043d\:0430", " ", 
                    RowBox[{
                    "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0442\
\:0432", ".", " ", "\:0441\:0442\:043e\:0440\:043e\:043d\:044b"}], " ", 
                    "\:0442\:0440\:0435\:0443\:0433\:043e\:043b\:044c\:043d\
\:0438\:043a\:0430"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"n1", ".", "p"}], "-", 
                    RowBox[{"n1", ".", "a"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"n1", ".", "p"}]}], "+", 
                    RowBox[{"n1", ".", "b"}]}], ")"}]}], ">", "0"}], ",", " ",
                     "\[IndentingNewLine]", "\t\t\t\t ", 
                    RowBox[{
                    RowBox[{"x0", "=", 
                    RowBox[{"a", "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}]}], ")"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "a"}], ")"}]}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}]}], ",", "x0", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}], "}"}]}], "]"}], ";"}]}],
                     "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
                    "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"n2", ".", "p"}], "-", 
                    RowBox[{"n2", ".", "b"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"n2", ".", "p"}]}], "+", 
                    RowBox[{"n2", ".", "c"}]}], ")"}]}], ">", "0"}], ",", " ",
                     "\[IndentingNewLine]", "\t\t\t\t ", 
                    RowBox[{
                    RowBox[{"x0", "=", 
                    RowBox[{"b", "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}]}], ")"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "b"}], ")"}]}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}]}], ",", "x0", ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "]"}], ";"}]}],
                     "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
                    "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"n3", ".", "p"}], "-", 
                    RowBox[{"n3", ".", "a"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"n3", ".", "p"}]}], "+", 
                    RowBox[{"n3", ".", "c"}]}], ")"}]}], ">", "0"}], ",", " ",
                     "\[IndentingNewLine]", "\t\t\t\t ", 
                    RowBox[{
                    RowBox[{"x0", "=", 
                    RowBox[{"c", "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}]}], ")"}]}], "*", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "c"}], ")"}]}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"x0", "-", "p"}], ")"}]}], ",", "x0", ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "a"}], "}"}]}], "}"}]}], "]"}], ";"}]}],
                     "\[IndentingNewLine]", "\t\t\t", "]"}], ";", 
                    "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430", ",", 
                    " ", 
                    RowBox[{
                    RowBox[{
                    "\:0435\:0441\:043b\:0438", " ", 
                    "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", 
                    "\:043d\:0430\:0445\:043e\:0434\:044f\:0442\:0441\:044f", 
                    " ", "\:0432\:0441\:0435"}], "-", 
                    RowBox[{
                    "\:0442\:0430\:043a\:0438", " ", 
                    "\:0431\:043b\:0438\:0436\:0435"}]}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", "\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "res"}], ">", "0"}], ",", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"Rest", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"res", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}]}], ",",
                     " ", "chopaccuracy"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"l", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"#", "-", "p"}], ")"}]}], "&"}], "@", 
                    RowBox[{"First", "@", "res"}]}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}]}], "<", "l"}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "a"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}]}], "<", "l"}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "b"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}]}], "<", "l"}], ",", 
                    RowBox[{"res", "=", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "c"}], "}"}]}]}], "]"}], ";"}], 
                    "\[IndentingNewLine]", "\t\t\t\t", ",", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"res", "=", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"Rest", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"a", "-", "p"}], ")"}]}], ",", "a", ",", "a"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"b", "-", "p"}], ")"}]}], ",", "b", ",", "b"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"c", "-", "p"}], ")"}]}], ",", "c", ",", "c"}], 
                    "}"}]}], "}"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}]}], ",",
                     "chopaccuracy"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}]}], "\t", 
                  "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]",
               "\t", 
              RowBox[{"Return", "[", "res", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "V2"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "4.5"}], ",", "6.4", ",", "9.94"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "8.7"}], ",", 
              RowBox[{"-", "7.7"}], ",", "9.87"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"7.08", ",", 
              RowBox[{"-", "13.494"}], ",", "8.917"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"9.9", ",", 
              RowBox[{"-", "7.12"}], ",", "8.9"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4.8", ",", "6.69", ",", "9.455"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"12", ",", "5.75", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"13.5", ",", 
              RowBox[{"-", "6.75"}], ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"14.04", ",", "0.898", ",", "1.24"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"8.394", ",", 
              RowBox[{"-", "15.1842"}], ",", "5.3821"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2.70672"}], ",", 
              RowBox[{"-", "13.668704"}], ",", 
              RowBox[{"-", "1.273248"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "13.5"}], ",", 
              RowBox[{"-", "3.0"}], ",", 
              RowBox[{"-", "1.25"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "7.5"}], ",", 
              RowBox[{"-", "10.75"}], ",", 
              RowBox[{"-", "1.25"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "3.25"}], ",", "13.0", ",", 
              RowBox[{"-", "1.25"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4.84", ",", "10.892", ",", 
              RowBox[{"-", "4.0185"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"9.75", ",", 
              RowBox[{"-", "9.75"}], ",", 
              RowBox[{"-", "4.25"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "4.25"}], ",", "2.5", ",", 
              RowBox[{"-", "11.75"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"10.023", ",", 
              RowBox[{"-", "0.8724"}], ",", 
              RowBox[{"-", "7.087"}]}], "}"}]}], "}"}]}]}]}]}]}]}]}], ";", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"G2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "1"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "5", ",", "4", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7", ",", "8", ",", "6", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "3", ",", "9", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "9", ",", "10", ",", "2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "11", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "10", ",", "12", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "12", ",", "11", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "13", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11", ",", "13", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "6", ",", "14", ",", "13", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "8", ",", "14", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "15", ",", "7", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "10", ",", "15", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13", ",", "16", ",", "11", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "7", ",", "15", ",", "17", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"14", ",", "13", ",", "16", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "14", ",", "17", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"17", ",", "14", ",", "16", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "17", ",", "15", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "11", ",", "12", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "10", ",", "12", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "10", ",", "15", ",", "16"}], "}"}]}], "}"}]}], ";",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "\[Rule]", " ", "0.025"}], ",", "Brown", ",", 
         RowBox[{"Point", "@", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", "Black", ",", 
         RowBox[{"Tooltip", "/@", 
          RowBox[{"Point", "/@", "VV"}]}], ",", "Red", ",", 
         RowBox[{"Point", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "@", 
             RowBox[{"VV", "[", 
              RowBox[{"[", 
               RowBox[{"GG", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "GG"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"VV", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "VV"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Purple", ",", 
         RowBox[{"Point", "@", 
          RowBox[{"eee", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "20"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}]}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "0.2"}], "}"}], ",", 
       RowBox[{"-", "25"}], ",", "25", ",", "0.25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{"-", "0.2"}]}], "}"}], ",", 
       RowBox[{"-", "25"}], ",", "25", ",", "0.25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", "0.2"}], "}"}], ",", 
       RowBox[{"-", "25"}], ",", "25", ",", "0.25"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8308471536978436`*^9, 3.830847155512955*^9}, 
   3.830847809221193*^9, {3.8309162093689594`*^9, 3.8309162157844477`*^9}, {
   3.830916272841214*^9, 3.8309162863251247`*^9}, {3.8309221755219407`*^9, 
   3.8309221847624187`*^9}, 3.8309223094528303`*^9, {3.830941590649928*^9, 
   3.830941594026005*^9}, {3.831013284061345*^9, 3.8310132844561787`*^9}, {
   3.8310517368498926`*^9, 3.831051739009946*^9}, 3.8310654831289997`*^9, {
   3.8313201548307943`*^9, 3.831320155324478*^9}, {3.8313993064065485`*^9, 
   3.8313993084990997`*^9}, {3.8315450197194233`*^9, 3.831545021197445*^9}, {
   3.8315451887576184`*^9, 
   3.8315451915052757`*^9}},ExpressionUUID->"b7694fad-9137-406c-9785-\
aaac10b36b60"]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 472, 7, 52, "Text",ExpressionUUID->"74d78389-241b-496f-9f67-034c4c7005fe"],
Cell[1033, 29, 889, 15, 119, "Text",ExpressionUUID->"dab625d7-2239-4247-a19c-d686f6ac1e87"],
Cell[1925, 46, 835, 15, 86, "Text",ExpressionUUID->"2422ae22-34c7-4bb8-8a6d-c95d01343304"],
Cell[2763, 63, 2951, 43, 220, "Text",ExpressionUUID->"a088e911-5b7f-4740-b723-3198574edf3a"],
Cell[5717, 108, 1667, 25, 186, "Text",ExpressionUUID->"2369643b-cb5e-4638-9312-1756432c097f"],
Cell[7387, 135, 589, 11, 186, "Text",ExpressionUUID->"1064136e-b50e-4ad8-b762-45f8bb4ea268"],
Cell[7979, 148, 136281, 3070, 8209, "Input",ExpressionUUID->"b7694fad-9137-406c-9785-aaac10b36b60"]
}
]
*)

